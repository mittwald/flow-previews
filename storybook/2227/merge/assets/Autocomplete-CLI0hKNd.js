import{r as l,R as De,j as p}from"./iframe-XJIuIQsX.js";import{f as Te,P as Ve,R as Be}from"./flowComponent-BaQJj-Fe.js";import{u as Ne}from"./useOverlayController-Bcgt-d4I.js";import{a as je}from"./Option-Bdn2cEKD.js";import{T as Ke}from"./Text-CrMkSLGe.js";import{u as Oe}from"./useFieldComponent-HT5XfbIG.js";import{b as U,c as Ue,g as He,d as Me}from"./utils-OSbsBMtV.js";import{$ as H}from"./useLocalizedStringFormatter-CdJGeOAf.js";import{$ as ze}from"./useFilter-DjO988IK.js";import{b as We}from"./useFocusRing-CeYeFZfu.js";import{i as qe}from"./OverlayArrow-Coj8W95X.js";import{b as Ge,a as Je}from"./RSPContexts-CKZ7RQV4.js";import{b as Ze,c as C,a as Qe,$ as M}from"./index-BFrTfb9P.js";import{h as Xe,b as Ye,B as _e,j as B,a as et}from"./useFocus-CATpB0h3.js";import{$ as tt}from"./useLabel-B1JuXYfT.js";import{$ as rt}from"./useEvent-c3AV6770.js";import{j as N,k as ot,l as at,m as j,n as K,o as lt,p as nt}from"./SelectionManager-BTpprE_r.js";import{$ as ct}from"./useControlledState-B6b60Ty3.js";var z={};z={collectionLabel:"مقترحات"};var W={};W={collectionLabel:"Предложения"};var q={};q={collectionLabel:"Návrhy"};var G={};G={collectionLabel:"Forslag"};var J={};J={collectionLabel:"Empfehlungen"};var Z={};Z={collectionLabel:"Προτάσεις"};var Q={};Q={collectionLabel:"Suggestions"};var X={};X={collectionLabel:"Sugerencias"};var Y={};Y={collectionLabel:"Soovitused"};var _={};_={collectionLabel:"Ehdotukset"};var ee={};ee={collectionLabel:"Suggestions"};var te={};te={collectionLabel:"הצעות"};var re={};re={collectionLabel:"Prijedlozi"};var oe={};oe={collectionLabel:"Javaslatok"};var ae={};ae={collectionLabel:"Suggerimenti"};var le={};le={collectionLabel:"候補"};var ne={};ne={collectionLabel:"제안"};var ce={};ce={collectionLabel:"Pasiūlymai"};var ue={};ue={collectionLabel:"Ieteikumi"};var se={};se={collectionLabel:"Forslag"};var ie={};ie={collectionLabel:"Suggesties"};var fe={};fe={collectionLabel:"Sugestie"};var de={};de={collectionLabel:"Sugestões"};var pe={};pe={collectionLabel:"Sugestões"};var be={};be={collectionLabel:"Sugestii"};var $e={};$e={collectionLabel:"Предложения"};var ve={};ve={collectionLabel:"Návrhy"};var me={};me={collectionLabel:"Predlogi"};var xe={};xe={collectionLabel:"Predlozi"};var ge={};ge={collectionLabel:"Förslag"};var Ee={};Ee={collectionLabel:"Öneriler"};var he={};he={collectionLabel:"Пропозиції"};var Fe={};Fe={collectionLabel:"建议"};var ye={};ye={collectionLabel:"建議"};var Le={};Le={"ar-AE":z,"bg-BG":W,"cs-CZ":q,"da-DK":G,"de-DE":J,"el-GR":Z,"en-US":Q,"es-ES":X,"et-EE":Y,"fi-FI":_,"fr-FR":ee,"he-IL":te,"hr-HR":re,"hu-HU":oe,"it-IT":ae,"ja-JP":le,"ko-KR":ne,"lt-LT":ce,"lv-LV":ue,"nb-NO":se,"nl-NL":ie,"pl-PL":fe,"pt-BR":de,"pt-PT":pe,"ro-RO":be,"ru-RU":$e,"sk-SK":ve,"sl-SI":me,"sr-SP":xe,"sv-SE":ge,"tr-TR":Ee,"uk-UA":he,"zh-CN":Fe,"zh-TW":ye};function ut(r){return r&&r.__esModule?r.default:r}function st(r,o){let{inputRef:c,collectionRef:a,filter:s,disableAutoFocusFirst:$=!1,disableVirtualFocus:m=!1}=r,b=Ze(),u=l.useRef(void 0),f=l.useRef(!1),n=l.useRef(null),F=l.useRef(null),I=Xe()==="virtual"&&(Ye()||_e()),[x,P]=l.useState(!I&&!m),[R,y]=l.useState(!1);l.useEffect(()=>()=>clearTimeout(u.current),[]);let E=C(e=>{!e.isTrusted&&x&&c.current&&B(et(c.current))!==c.current&&c.current.focus();let t=e.target;e.isTrusted||!t||n.current===t.id||(clearTimeout(u.current),t!==a.current?f.current?(n.current=t.id,u.current=setTimeout(()=>{o.setFocusedNodeId(t.id)},500)):(n.current=t.id,o.setFocusedNodeId(t.id)):n.current&&!document.getElementById(n.current)&&(n.current=null,o.setFocusedNodeId(null)),f.current=!1)}),L=l.useCallback(e=>{if(e!=null){var t;(t=F.current)===null||t===void 0||t.removeEventListener("focusin",E),F.current=e,e.addEventListener("focusin",E),e.getAttribute("tabindex")!=null&&P(!1),y(!0)}else{var i;(i=F.current)===null||i===void 0||i.removeEventListener("focusin",E),y(!1)}},[E]),v=U(l.useMemo(()=>Qe(a,L),[a,L])),A=C(()=>{var e;f.current=!0,(e=a.current)===null||e===void 0||e.dispatchEvent(new CustomEvent(N,{cancelable:!0,bubbles:!0,detail:{focusStrategy:"first"}}))}),T=C(e=>{var t;ot(B()),n.current=null,o.setFocusedNodeId(null);let i=new CustomEvent(at,{cancelable:!0,bubbles:!0,detail:{clearFocusKey:e}});clearTimeout(u.current),f.current=!1,(t=a.current)===null||t===void 0||t.dispatchEvent(i)}),h=l.useRef("");rt(c,"input",e=>{let{inputType:t}=e;h.current=t});let Ce=e=>{h.current==="insertText"&&!$?A():h.current&&(h.current.includes("insert")||h.current.includes("delete")||h.current.includes("history"))&&(T(!0),nt(document)===c.current&&K(c.current,null)),o.setInputValue(e)},V=l.useRef(null),Ie=e=>{if(V.current=e.target,e.nativeEvent.isComposing)return;let t=n.current;switch(e.key){case"a":if(lt(e))return;break;case"Escape":if(e.isDefaultPrevented())return;break;case" ":return;case"Tab":"continuePropagation"in e&&e.continuePropagation();return;case"Home":case"End":case"PageDown":case"PageUp":case"ArrowUp":case"ArrowDown":{var i;if((e.key==="Home"||e.key==="End")&&t==null&&e.shiftKey)return;e.preventDefault();let d=new CustomEvent(N,{cancelable:!0,bubbles:!0});(i=a.current)===null||i===void 0||i.dispatchEvent(d);break}}e.isPropagationStopped()||e.stopPropagation();let g=!0;if(a.current!==null){var D;if(t==null)g=((D=a.current)===null||D===void 0?void 0:D.dispatchEvent(new KeyboardEvent(e.nativeEvent.type,e.nativeEvent)))||!1;else{let d=document.getElementById(t);d&&(g=d?.dispatchEvent(new KeyboardEvent(e.nativeEvent.type,e.nativeEvent))||!1)}}if(g)switch(e.key){case"ArrowLeft":case"ArrowRight":T();break;case"Enter":if(t!=null){let d=document.getElementById(t);d?.click()}break}else e.preventDefault()},S=C(e=>{if(e.target===V.current){var t;e.stopImmediatePropagation();let i=n.current;if(i==null)(t=a.current)===null||t===void 0||t.dispatchEvent(new KeyboardEvent(e.type,e));else{let g=document.getElementById(i);g?.dispatchEvent(new KeyboardEvent(e.type,e))}}});l.useEffect(()=>(document.addEventListener("keyup",S,!0),()=>{document.removeEventListener("keyup",S,!0)}),[S]);let Pe=H(ut(Le),"@react-aria/autocomplete"),Re=tt({id:b,"aria-label":Pe.format("collectionLabel")}),Ae=l.useCallback((e,t)=>s?s(e,o.inputValue,t):!0,[o.inputValue,s]),Se=e=>{if(!e.isTrusted)return;let t=n.current?document.getElementById(n.current):null;t&&j(t,e.relatedTarget)},we=e=>{if(!e.isTrusted)return;if(n.current?document.getElementById(n.current):null){let i=e.target;queueMicrotask(()=>{j(i,a.current),K(a.current,i)})}},w={value:o.inputValue,onChange:Ce};var k;let ke={onKeyDown:Ie,"aria-activedescendant":(k=o.focusedNodeId)!==null&&k!==void 0?k:void 0,onBlur:Se,onFocus:we};return R&&(w={...w,...x&&ke,enterKeyHint:"go","aria-controls":b,"aria-autocomplete":"list",autoCorrect:"off",spellCheck:"false",autoComplete:"off"}),{inputProps:w,collectionProps:M(Re,{shouldUseVirtualFocus:x,disallowTypeAhead:x}),collectionRef:v,filter:s!=null?Ae:void 0}}function it(r){let{onInputChange:o,inputValue:c,defaultInputValue:a=""}=r,s=f=>{o&&o(f)},[$,m]=l.useState(null),[b,u]=ct(c,a,s);return{inputValue:b,setInputValue:u,focusedNodeId:$,setFocusedNodeId:m}}const ft=l.createContext(null),dt=l.createContext(null);function pt(r){let o=Ue(ft,r.slot);r=M(o,r);let{filter:c,disableAutoFocusFirst:a}=r,s=it(r),$=l.useRef(null),m=l.useRef(null),{inputProps:b,collectionProps:u,collectionRef:f,filter:n}=st({...He(r),filter:c,disableAutoFocusFirst:a,inputRef:$,collectionRef:m},s);return De.createElement(Me,{values:[[dt,s],[Ge,{...b,ref:$}],[Je,{...u,filter:n,ref:f}]]},r.children)}const bt={"de-DE":{"autocomplete.empty":"Keine passenden Einträge"},"en-US":{"autocomplete.empty":"No matching entries"}},$t="flow--autocomplete--popover",vt="flow--autocomplete--empty",O={popover:$t,empty:vt},mt=r=>r?.getAttribute("data-focused")==="true",xt=(r,o)=>{const c=new Event("change",{bubbles:!0});try{Object.getOwnPropertyDescriptor(Object.getPrototypeOf(r),"value")?.set?.call(r,o),r.dispatchEvent(c)}catch{if("value"in r)r.value=o,r.dispatchEvent(c);else throw Error("could not emit value update for element")}},gt=Te("Autocomplete",r=>{const{children:o,ref:c,...a}=r,s=U(c),{contains:$}=ze({sensitivity:"base"}),m=H(bt),b=l.useRef(null),u=Ne("Popover",{reuseControllerFromContext:!1}),f=We({onBlurWithin:u.close}),n=()=>p.jsx(Ke,{className:O.empty,children:m.format("autocomplete.empty")}),F=v=>{v===""?u.close():mt(s.current)&&u.open()},I=v=>{const A=String(v);s.current&&xt(s.current,A),u.close()},x={onKeyDown:v=>{v.key==="Enter"&&u.isOpen&&v.preventDefault()},ref:s,onChange:F},{FieldErrorView:P,FieldErrorCaptureContext:R,fieldPropsContext:y,fieldProps:E}=Oe(r),L={SearchField:x,TextField:x,Option:{tunnelId:"options"},Popover:{className:O.popover},...y};return p.jsxs("div",{...E,children:[p.jsx(R,{children:p.jsx(Ve,{props:L,dependencies:[u],children:p.jsx("div",{...f.focusWithinProps,ref:b,children:p.jsx(qe,{getContainer:()=>b.current,children:p.jsxs(pt,{filter:$,disableAutoFocusFirst:!0,...a,children:[o,p.jsx(je,{onAction:I,triggerRef:s,controller:u,renderEmptyState:n,isNonModal:!0,placement:"bottom start",children:p.jsx(Be,{id:"options"})})]})})})})}),p.jsx(P,{})]})});gt.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Autocomplete"};export{gt as A};
