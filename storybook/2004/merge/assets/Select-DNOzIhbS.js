import{r as f,R as p,j as x}from"./iframe-D1JKOwdq.js";import{f as _,P as G,k as J,A as Q}from"./PropsContextProvider-CKqNcsdJ.js";import{f as F}from"./FormField.module-CqWyJNQI.js";import{F as Y}from"./FieldError-DJpBvO0q.js";import{c as Z}from"./clsx-B-dksMZM.js";import{c as ee}from"./IconWarning-DZISCuC-.js";import{$ as le,a as te,b as ae}from"./Option-eoTDoMnj.js";import{n as oe,k as ie,o as re,u as se}from"./DialogTriggerView-BgJsodt7.js";import{$ as z,a as ne}from"./Button-DG6zvYi3.js";import{$ as H,c as W,a as A,g as de,d as ce,e as fe}from"./utils-BVsEXjGQ.js";import{$ as ue}from"./FieldError-BZfRYFbv.js";import{b as be,c as $e,a as me,$ as pe}from"./Form-CftHRla7.js";import{$ as ve}from"./intlStrings-ZMTSFH_M.js";import{a as L}from"./Label-CseS0v8E.js";import{a as q}from"./Text-BIeeVT6X.js";import{b as ge}from"./CollectionBuilder-B5sifEeq.js";import{$ as M,f as ye,e as xe}from"./mergeRefs-CYbnUoq6.js";import{$ as j}from"./filterDOMProps-CghfNOdR.js";import{d as he,h as Pe}from"./ClearPropsContextView-Be28GGXB.js";import{$ as Se}from"./useLocalizedStringFormatter-CIU1pqtk.js";import{$ as Ce}from"./useSingleSelectListState-BuUuo_IF.js";import{a as Re}from"./useFocusRing-8cxgDEwk.js";import{$ as De,o as Fe}from"./SelectionManager-DFpd0p6B.js";import{D as Ie}from"./useFocus-CYEgIwnz.js";import{a as Ke}from"./useCollator-sKXsPUo5.js";import{$ as Ee}from"./useFormReset-CG85pNSA.js";import{a as Be}from"./VisuallyHidden-DUuSn0Sw.js";const V=new WeakMap;function Oe(e,l,n){let{keyboardDelegate:i,isDisabled:o,isRequired:d,name:u,form:a,validationBehavior:r="aria"}=e,$=Ke({usage:"search",sensitivity:"base"}),t=f.useMemo(()=>i||new De(l.collection,l.disabledKeys,n,$),[i,l.collection,l.disabledKeys,$,n]),{menuTriggerProps:m,menuProps:b}=oe({isDisabled:o,type:"listbox"},l,n),s=c=>{switch(c.key){case"ArrowLeft":{var P,S;c.preventDefault();let D=l.selectedKey!=null?(P=t.getKeyAbove)===null||P===void 0?void 0:P.call(t,l.selectedKey):(S=t.getFirstKey)===null||S===void 0?void 0:S.call(t);D&&l.setSelectedKey(D);break}case"ArrowRight":{var w,k;c.preventDefault();let D=l.selectedKey!=null?(w=t.getKeyBelow)===null||w===void 0?void 0:w.call(t,l.selectedKey):(k=t.getFirstKey)===null||k===void 0?void 0:k.call(t);D&&l.setSelectedKey(D);break}}},{typeSelectProps:v}=Fe({keyboardDelegate:t,selectionManager:l.selectionManager,onTypeSelect(c){l.setSelectedKey(c)}}),{isInvalid:g,validationErrors:C,validationDetails:K}=l.displayValidation,{labelProps:E,fieldProps:R,descriptionProps:h,errorMessageProps:B}=be({...e,labelElementType:"span",isInvalid:g,errorMessage:e.errorMessage||C});v.onKeyDown=v.onKeyDownCapture,delete v.onKeyDownCapture;let O=j(e,{labelable:!0}),y=M(v,m,R),I=ye();return V.set(l,{isDisabled:o,isRequired:d,name:u,form:a,validationBehavior:r}),{labelProps:{...E,onClick:()=>{if(!e.isDisabled){var c;(c=n.current)===null||c===void 0||c.focus(),Ie("keyboard")}}},triggerProps:M(O,{...y,isDisabled:o,onKeyDown:xe(y.onKeyDown,s,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[I,y["aria-labelledby"],y["aria-label"]&&!y["aria-labelledby"]?y.id:null].filter(Boolean).join(" "),onFocus(c){l.isFocused||(e.onFocus&&e.onFocus(c),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(c){l.isOpen||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:I},menuProps:{...b,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:c=>{c.currentTarget.contains(c.relatedTarget)||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[R["aria-labelledby"],y["aria-label"]&&!R["aria-labelledby"]?y.id:null].filter(Boolean).join(" ")},descriptionProps:h,errorMessageProps:B,isInvalid:g,validationErrors:C,validationDetails:K,hiddenSelectProps:{isDisabled:o,name:u,label:e.label,state:l,triggerRef:n,form:a}}}function we(e,l,n){let i=V.get(l)||{},{autoComplete:o,name:d=i.name,form:u=i.form,isDisabled:a=i.isDisabled}=e,{validationBehavior:r,isRequired:$}=i,{visuallyHiddenProps:t}=Be({style:{position:"fixed",top:0,left:0}});Ee(e.selectRef,l.defaultSelectedKey,l.setSelectedKey),$e({validationBehavior:r,focus:()=>{var s;return(s=n.current)===null||s===void 0?void 0:s.focus()}},l,e.selectRef);let m=f.useCallback(s=>l.setSelectedKey(s.currentTarget.value),[l.setSelectedKey]);var b;return{containerProps:{...t,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:a,required:r==="native"&&$,name:d,form:u,value:(b=l.selectedKey)!==null&&b!==void 0?b:"",onChange:m,onInput:m}}}function ke(e){let{state:l,triggerRef:n,label:i,name:o,form:d,isDisabled:u}=e,a=f.useRef(null),r=f.useRef(null),{containerProps:$,selectProps:t}=we({...e,selectRef:l.collection.size<=300?a:r},l,n);if(l.collection.size<=300)return p.createElement("div",{...$,"data-testid":"hidden-select-container"},p.createElement("label",null,i,p.createElement("select",{...t,ref:a},p.createElement("option",null),[...l.collection.getKeys()].map(b=>{let s=l.collection.getItem(b);if(s&&s.type==="item")return p.createElement("option",{key:s.key,value:s.key},s.textValue)}))));if(o){let b=V.get(l)||{},{validationBehavior:s}=b;var m;let v={type:"hidden",autoComplete:t.autoComplete,name:o,form:d,disabled:u,value:(m=l.selectedKey)!==null&&m!==void 0?m:""};return s==="native"?p.createElement("input",{...v,ref:r,style:{display:"none"},type:"text",required:t.required,onChange:()=>{}}):p.createElement("input",{...v,ref:r})}return null}function Me(e){let l=he(e),[n,i]=f.useState(null),o=Ce({...e,onSelectionChange:t=>{e.onSelectionChange!=null&&e.onSelectionChange(t),l.close(),d.commitValidation()}}),d=me({...e,value:o.selectedKey}),[u,a]=f.useState(!1),[r]=f.useState(o.selectedKey);var $;return{...d,...o,...l,defaultSelectedKey:($=e.defaultSelectedKey)!==null&&$!==void 0?$:r,focusStrategy:n,open(t=null){o.collection.size!==0&&(i(t),l.open())},toggle(t=null){o.collection.size!==0&&(i(t),l.toggle())},isFocused:u,setFocused:a}}function qe(e){return e&&e.__esModule?e.default:e}const N=f.createContext(null),U=f.createContext(null),je=f.forwardRef(function(l,n){[l,n]=H(l,n,N);let{children:i,isDisabled:o=!1,isInvalid:d=!1,isRequired:u=!1}=l,a=f.useMemo(()=>typeof i=="function"?i({isOpen:!1,isDisabled:o,isInvalid:d,isRequired:u,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):i,[i,o,d,u]);return p.createElement(ge,{content:a},r=>p.createElement(Ne,{props:l,collection:r,selectRef:n}))}),Ve=[L,z,q];function Ne({props:e,selectRef:l,collection:n}){let{validationBehavior:i}=W(pe)||{};var o,d;let u=(d=(o=e.validationBehavior)!==null&&o!==void 0?o:i)!==null&&d!==void 0?d:"native",a=Me({...e,collection:n,children:void 0,validationBehavior:u}),{isFocusVisible:r,focusProps:$}=Re({within:!0}),t=f.useRef(null),[m,b]=de(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:s,triggerProps:v,valueProps:g,menuProps:C,descriptionProps:K,errorMessageProps:E,hiddenSelectProps:R,...h}=Oe({...ce(e),label:b,validationBehavior:u},a,t),[B,O]=f.useState(null),y=f.useCallback(()=>{t.current&&O(t.current.offsetWidth+"px")},[t]);Pe({ref:t,onResize:y});let I=f.useMemo(()=>({isOpen:a.isOpen,isFocused:a.isFocused,isFocusVisible:r,isDisabled:e.isDisabled||!1,isInvalid:h.isInvalid||!1,isRequired:e.isRequired||!1}),[a.isOpen,a.isFocused,r,e.isDisabled,h.isInvalid,e.isRequired]),c=A({...e,values:I,defaultClassName:"react-aria-Select"}),P=j(e,{global:!0});delete P.id;let S=f.useRef(null);return p.createElement(fe,{values:[[N,e],[U,a],[X,g],[L,{...s,ref:m,elementType:"span"}],[z,{...v,ref:t,isPressed:a.isOpen,autoFocus:e.autoFocus}],[ie,a],[re,{trigger:"Select",triggerRef:t,scrollRef:S,placement:"bottom start",style:{"--trigger-width":B},"aria-labelledby":C["aria-labelledby"],clearContexts:Ve}],[le,{...C,ref:S}],[te,a],[q,{slots:{description:K,errorMessage:E}}],[ue,h]]},p.createElement("div",{...M(P,c,$),ref:l,slot:e.slot||void 0,"data-focused":a.isFocused||void 0,"data-focus-visible":r||void 0,"data-open":a.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":h.isInvalid||void 0,"data-required":e.isRequired||void 0},c.children,p.createElement(ke,{...R,autoComplete:e.autoComplete})))}const X=f.createContext(null),Te=f.forwardRef(function(l,n){var i,o;[l,n]=H(l,n,X);let d=f.useContext(U),{placeholder:u}=W(N),a=d.selectedKey!=null?d.collection.getItem(d.selectedKey):null,r=a==null?void 0:a.props.children;typeof r=="function"&&(r=r({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"}));let $=Se(qe(ve),"react-aria-components");var t,m,b;let s=A({...l,defaultChildren:(t=r??u)!==null&&t!==void 0?t:$.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(m=(i=d.selectedItem)===null||i===void 0?void 0:i.value)!==null&&m!==void 0?m:null,selectedText:(b=(o=d.selectedItem)===null||o===void 0?void 0:o.textValue)!==null&&b!==void 0?b:null,isPlaceholder:!a}}),v=j(l,{global:!0});return p.createElement("span",{ref:n,...v,...s,"data-placeholder":!a||void 0},p.createElement(q.Provider,{value:void 0},s.children))}),ze="flow--select",He="flow--select--toggle",T={select:ze,toggle:He},We=_("Select",e=>{const{children:l,className:n,onChange:i=()=>{},onSelectionChange:o=()=>{},controller:d,ref:u,isReadOnly:a,...r}=e,$=Z(T.select,F.formField,n),t={Label:{className:F.label,optional:!e.isRequired},FieldDescription:{className:F.fieldDescription},FieldError:{className:F.customFieldError},Option:{tunnelId:"options"}},m=g=>{i(String(g)),o(g)},b=se("Select",{reuseControllerFromContext:!0}),s=d??b,v=s.useIsOpen();return x.jsx(je,{...r,className:$,ref:u,onSelectionChange:a?void 0:m,onOpenChange:g=>!a&&s.setOpen(g),isOpen:v,"data-readonly":a,children:x.jsx(G,{props:t,children:x.jsxs(J,{children:[x.jsxs(ne,{"data-readonly":a,className:T.toggle,children:[x.jsx(Te,{}),x.jsx(ee,{})]}),l,x.jsx(ae,{controller:s,children:x.jsx(Q,{id:"options"})}),x.jsx(Y,{className:F.fieldError})]})})})});We.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Select"};export{We as S};
