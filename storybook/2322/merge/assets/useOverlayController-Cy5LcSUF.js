import{r as l}from"./iframe-jPI25t47.js";import{m as d,b as i,o as u}from"./flowComponent-NWkTmrxz.js";import{u as O,a as f}from"./useStatic-Be080qZz.js";const h=o=>H("Modal",o),C=o=>{const e=o.useShowConfirmationModal(),n=h({reuseControllerFromContext:!1,onClose:()=>{e&&o.cancelConfirmation()}});if(l.useEffect(()=>{e&&n.open()},[n,e]),o.confirmClose)return{controller:n,cancel:()=>o.cancelConfirmation(),confirm:()=>{o.confirmClose(),o.close()}}};class c{isOpen=!1;showConfirmationModal=!1;confirmOnCloseEnabled;onOpenHandlers=new Set;onCloseHandlers=new Set;onOpenChangeHandlers=new Set;constructor(e={}){d(this,{isOpen:u,showConfirmationModal:u,open:i.bound,close:i.bound,toggle:i.bound,setOpen:i.bound,confirmClose:i.bound}),this.isOpen=e?.isDefaultOpen??!1,this.confirmOnCloseEnabled=e?.confirmOnClose===!0}useUpdateOptions(e={}){const{onOpen:n,onClose:r,onOpenChange:s,confirmOnClose:a}=e;this.useOnHandler(n,t=>this.addOpenStateHandler(t,this.onOpenHandlers)),this.useOnHandler(r,t=>this.addOpenStateHandler(t,this.onCloseHandlers)),this.useOnHandler(s,t=>this.addOpenStateHandler(t,this.onOpenChangeHandlers)),l.useEffect(()=>{a&&(this.confirmOnCloseEnabled=!0)},[a,this])}static useNew(e={}){const n=O(()=>new c(e));return n.useUpdateOptions(e),n}addOpenStateHandler(e,n){return n.add(e),()=>{n.delete(e)}}useOnHandler(e,n){l.useEffect(()=>e?n(e):void 0,[e,this])}executeHandlers(e,n){return Array.from(n).map(s=>s(e)).some(s=>s===!1)}executeOnClose(){return this.executeHandlers(!1,this.onCloseHandlers)}executeOnOpen(){return this.executeHandlers(!0,this.onOpenHandlers)}executeOnOpenChange(e){return this.executeHandlers(e,this.onOpenChangeHandlers)}open(){this.setOpen(!0)}close(e){this.setOpen(!1,e)}toggle(){this.setOpen(!this.isOpen)}setOpen(e,n={}){if(this.isOpen===e)return;const{bypassConfirmation:r=!1}=n;if(this.confirmOnCloseEnabled&&e===!1&&r===!1){this.showConfirmationModal=!0;return}let s=!1;e?s=this.executeOnOpen():s=this.executeOnClose(),s||(s=this.executeOnOpenChange(e)),s||(this.isOpen=e)}useIsOpen(){return f(()=>this.isOpen)}useShowConfirmationModal(){return f(()=>this.showConfirmationModal)}useConfirmationController(){return C(this)}confirmClose(){this.showConfirmationModal=!1,this.confirmOnCloseEnabled=!1}cancelConfirmation(){this.showConfirmationModal=!1}}const m=l.createContext({}),p=()=>l.useContext(m),H=(o,e={})=>{const{reuseControllerFromContext:n=!0,...r}=e,s=c.useNew(r),a=p()[o],t=n&&a?a:s;return t===a&&t.useUpdateOptions(r),t};export{c as O,p as a,h as b,m as o,H as u};
