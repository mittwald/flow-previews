import{m as f,b as o,o as l}from"./flowComponent-BuliJvUF.js";import{u as h,a as O}from"./useStatic-Bcu2QKMg.js";import{r}from"./iframe-BECefjM4.js";class u{isOpen=!1;showConfirmOnClose=!1;confirmOnClose;onOpenHandlers=new Set;onCloseHandlers=new Set;onOpenChangeHandlers=new Set;constructor(e={}){f(this,{isOpen:l,showConfirmOnClose:l,open:o.bound,close:o.bound,toggle:o.bound,setOpen:o.bound,confirmClose:o.bound}),this.isOpen=e?.isDefaultOpen??!1,this.confirmOnClose=e?.confirmOnClose===!0}useUpdateOptions(e={}){const{onOpen:s,onClose:i,onOpenChange:n,confirmOnClose:a}=e;this.useOnHandler(s,t=>this.addOpenStateHandler(t,this.onOpenHandlers)),this.useOnHandler(i,t=>this.addOpenStateHandler(t,this.onCloseHandlers)),this.useOnHandler(n,t=>this.addOpenStateHandler(t,this.onOpenChangeHandlers)),r.useEffect(()=>{a&&(this.confirmOnClose=!0)},[a,this])}static useNew(e={}){const s=h(()=>new u(e));return s.useUpdateOptions(e),s}addOpenStateHandler(e,s){return s.add(e),()=>{s.delete(e)}}useOnHandler(e,s){r.useEffect(()=>e?s(e):void 0,[e,this])}executeHandlers(e,s){return Array.from(s).map(n=>n(e)).some(n=>n===!1)}executeOnClose(){return this.executeHandlers(!1,this.onCloseHandlers)}executeOnOpen(){return this.executeHandlers(!0,this.onOpenHandlers)}executeOnOpenChange(e){return this.executeHandlers(e,this.onOpenChangeHandlers)}open(){this.setOpen(!0)}close(e){this.setOpen(!1,e)}toggle(){this.setOpen(!this.isOpen)}setOpen(e,s={}){if(this.isOpen===e)return;const{bypassConfirmation:i=!1}=s;if(this.confirmOnClose&&e===!1&&i===!1){this.showConfirmOnClose=!0;return}let n=!1;e?n=this.executeOnOpen():n=this.executeOnClose(),n||(n=this.executeOnOpenChange(e)),n||(this.isOpen=e)}useIsOpen(){return O(()=>this.isOpen)}useShowConfirmation(){return O(()=>this.showConfirmOnClose)}confirmClose(){this.confirmOnClose=!1,this.showConfirmOnClose=!1}cancelConfirmation(){this.showConfirmOnClose=!1}useConfirmOnClose(e){r.useEffect(()=>{this.confirmOnClose=e},[e,this])}}const c=r.createContext({}),m=()=>r.useContext(c);export{u as O,c as o,m as u};
