import{r as u,R as v,j as x}from"./iframe-BAzLYubM.js";import{f as _,P as G,k as J,A as Q}from"./PropsContextProvider-EavNE9If.js";import{f as R}from"./FormField.module-CqWyJNQI.js";import{F as Y}from"./FieldError-Cejs8W8V.js";import{c as Z}from"./clsx-B-dksMZM.js";import{c as ee}from"./IconWarning-C8vW1cGr.js";import{$ as le,a as te,b as ae}from"./Option-D7eb7gkh.js";import{u as oe}from"./DialogTriggerView-MnquLDuj.js";import{$ as z,a as ie}from"./Button-DEcgbODe.js";import{$ as H,c as W,a as A,g as re,d as se,e as ne}from"./utils-b3dZQxDg.js";import{$ as de}from"./FieldError-CY1AiRgy.js";import{b as ce,c as fe,a as ue,$ as be}from"./Form-VFHeLX6B.js";import{$ as $e}from"./intlStrings-ZMTSFH_M.js";import{$ as L}from"./Label-uX-YTZhO.js";import{l as me,h as pe,m as ve}from"./Dialog-CNBL61sA.js";import{a as q}from"./Text-BrSTDiHS.js";import{b as ge}from"./CollectionBuilder-B31VuGbq.js";import{$ as M,d as xe,e as ye}from"./mergeRefs-AgJlHGVQ.js";import{$ as j}from"./filterDOMProps-CghfNOdR.js";import{c as he,g as Pe}from"./OverlayArrow-DVbPN0at.js";import{$ as Se}from"./useLocalizedStringFormatter-1HcLORhi.js";import{$ as Ce}from"./useSingleSelectListState-OcMKsH9L.js";import{a as De}from"./useFocusRing-BpLfAbDy.js";import{$ as Fe,o as Re}from"./SelectionManager-CYYX1vob.js";import{D as Ie}from"./useFocus-DNlriqLN.js";import{a as Ke}from"./useCollator-BFbm-Er3.js";import{$ as Ee}from"./useFormReset-BLDHXQeI.js";import{a as Be}from"./VisuallyHidden-sQyJVZKI.js";const V=new WeakMap;function we(e,l,s){let{keyboardDelegate:i,isDisabled:o,isRequired:n,name:b,form:a,validationBehavior:r="aria"}=e,$=Ke({usage:"search",sensitivity:"base"}),t=u.useMemo(()=>i||new Fe(l.collection,l.disabledKeys,s,$),[i,l.collection,l.disabledKeys,$,s]),{menuTriggerProps:m,menuProps:f}=me({isDisabled:o,type:"listbox"},l,s),d=c=>{switch(c.key){case"ArrowLeft":{var h,P;c.preventDefault();let F=l.selectedKey!=null?(h=t.getKeyAbove)===null||h===void 0?void 0:h.call(t,l.selectedKey):(P=t.getFirstKey)===null||P===void 0?void 0:P.call(t);F&&l.setSelectedKey(F);break}case"ArrowRight":{var O,k;c.preventDefault();let F=l.selectedKey!=null?(O=t.getKeyBelow)===null||O===void 0?void 0:O.call(t,l.selectedKey):(k=t.getFirstKey)===null||k===void 0?void 0:k.call(t);F&&l.setSelectedKey(F);break}}},{typeSelectProps:p}=Re({keyboardDelegate:t,selectionManager:l.selectionManager,onTypeSelect(c){l.setSelectedKey(c)}}),{isInvalid:S,validationErrors:C,validationDetails:K}=l.displayValidation,{labelProps:E,fieldProps:D,descriptionProps:y,errorMessageProps:B}=ce({...e,labelElementType:"span",isInvalid:S,errorMessage:e.errorMessage||C});p.onKeyDown=p.onKeyDownCapture,delete p.onKeyDownCapture;let w=j(e,{labelable:!0}),g=M(p,m,D),I=xe();return V.set(l,{isDisabled:o,isRequired:n,name:b,form:a,validationBehavior:r}),{labelProps:{...E,onClick:()=>{if(!e.isDisabled){var c;(c=s.current)===null||c===void 0||c.focus(),Ie("keyboard")}}},triggerProps:M(w,{...g,isDisabled:o,onKeyDown:ye(g.onKeyDown,d,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[I,g["aria-labelledby"],g["aria-label"]&&!g["aria-labelledby"]?g.id:null].filter(Boolean).join(" "),onFocus(c){l.isFocused||(e.onFocus&&e.onFocus(c),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(c){l.isOpen||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:I},menuProps:{...f,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:c=>{c.currentTarget.contains(c.relatedTarget)||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[D["aria-labelledby"],g["aria-label"]&&!D["aria-labelledby"]?g.id:null].filter(Boolean).join(" ")},descriptionProps:y,errorMessageProps:B,isInvalid:S,validationErrors:C,validationDetails:K,hiddenSelectProps:{isDisabled:o,name:b,label:e.label,state:l,triggerRef:s,form:a}}}function Oe(e,l,s){let i=V.get(l)||{},{autoComplete:o,name:n=i.name,form:b=i.form,isDisabled:a=i.isDisabled}=e,{validationBehavior:r,isRequired:$}=i,{visuallyHiddenProps:t}=Be({style:{position:"fixed",top:0,left:0}});Ee(e.selectRef,l.defaultSelectedKey,l.setSelectedKey),fe({validationBehavior:r,focus:()=>{var d;return(d=s.current)===null||d===void 0?void 0:d.focus()}},l,e.selectRef);let m=u.useCallback(d=>l.setSelectedKey(d.currentTarget.value),[l.setSelectedKey]);var f;return{containerProps:{...t,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:a,required:r==="native"&&$,name:n,form:b,value:(f=l.selectedKey)!==null&&f!==void 0?f:"",onChange:m,onInput:m}}}function ke(e){let{state:l,triggerRef:s,label:i,name:o,form:n,isDisabled:b}=e,a=u.useRef(null),r=u.useRef(null),{containerProps:$,selectProps:t}=Oe({...e,selectRef:l.collection.size<=300?a:r},l,s);if(l.collection.size<=300)return v.createElement("div",{...$,"data-testid":"hidden-select-container"},v.createElement("label",null,i,v.createElement("select",{...t,ref:a},v.createElement("option",null),[...l.collection.getKeys()].map(f=>{let d=l.collection.getItem(f);if(d&&d.type==="item")return v.createElement("option",{key:d.key,value:d.key},d.textValue)}))));if(o){let f=V.get(l)||{},{validationBehavior:d}=f;var m;let p={type:"hidden",autoComplete:t.autoComplete,name:o,form:n,disabled:b,value:(m=l.selectedKey)!==null&&m!==void 0?m:""};return d==="native"?v.createElement("input",{...p,ref:r,style:{display:"none"},type:"text",required:t.required,onChange:()=>{}}):v.createElement("input",{...p,ref:r})}return null}function Me(e){let l=he(e),[s,i]=u.useState(null),o=Ce({...e,onSelectionChange:t=>{e.onSelectionChange!=null&&e.onSelectionChange(t),l.close(),n.commitValidation()}}),n=ue({...e,value:o.selectedKey}),[b,a]=u.useState(!1),[r]=u.useState(o.selectedKey);var $;return{...n,...o,...l,defaultSelectedKey:($=e.defaultSelectedKey)!==null&&$!==void 0?$:r,focusStrategy:s,open(t=null){o.collection.size!==0&&(i(t),l.open())},toggle(t=null){o.collection.size!==0&&(i(t),l.toggle())},isFocused:b,setFocused:a}}function qe(e){return e&&e.__esModule?e.default:e}const N=u.createContext(null),U=u.createContext(null),je=u.forwardRef(function(l,s){[l,s]=H(l,s,N);let{children:i,isDisabled:o=!1,isInvalid:n=!1,isRequired:b=!1}=l,a=u.useMemo(()=>typeof i=="function"?i({isOpen:!1,isDisabled:o,isInvalid:n,isRequired:b,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):i,[i,o,n,b]);return v.createElement(ge,{content:a},r=>v.createElement(Ne,{props:l,collection:r,selectRef:s}))}),Ve=[L,z,q];function Ne({props:e,selectRef:l,collection:s}){let{validationBehavior:i}=W(be)||{};var o,n;let b=(n=(o=e.validationBehavior)!==null&&o!==void 0?o:i)!==null&&n!==void 0?n:"native",a=Me({...e,collection:s,children:void 0,validationBehavior:b}),{isFocusVisible:r,focusProps:$}=De({within:!0}),t=u.useRef(null),[m,f]=re(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:d,triggerProps:p,valueProps:S,menuProps:C,descriptionProps:K,errorMessageProps:E,hiddenSelectProps:D,...y}=we({...se(e),label:f,validationBehavior:b},a,t),[B,w]=u.useState(null),g=u.useCallback(()=>{t.current&&w(t.current.offsetWidth+"px")},[t]);Pe({ref:t,onResize:g});let I=u.useMemo(()=>({isOpen:a.isOpen,isFocused:a.isFocused,isFocusVisible:r,isDisabled:e.isDisabled||!1,isInvalid:y.isInvalid||!1,isRequired:e.isRequired||!1}),[a.isOpen,a.isFocused,r,e.isDisabled,y.isInvalid,e.isRequired]),c=A({...e,values:I,defaultClassName:"react-aria-Select"}),h=j(e,{global:!0});delete h.id;let P=u.useRef(null);return v.createElement(ne,{values:[[N,e],[U,a],[X,S],[L,{...d,ref:m,elementType:"span"}],[z,{...p,ref:t,isPressed:a.isOpen,autoFocus:e.autoFocus}],[pe,a],[ve,{trigger:"Select",triggerRef:t,scrollRef:P,placement:"bottom start",style:{"--trigger-width":B},"aria-labelledby":C["aria-labelledby"],clearContexts:Ve}],[le,{...C,ref:P}],[te,a],[q,{slots:{description:K,errorMessage:E}}],[de,y]]},v.createElement("div",{...M(h,c,$),ref:l,slot:e.slot||void 0,"data-focused":a.isFocused||void 0,"data-focus-visible":r||void 0,"data-open":a.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":y.isInvalid||void 0,"data-required":e.isRequired||void 0},c.children,v.createElement(ke,{...D,autoComplete:e.autoComplete})))}const X=u.createContext(null),Te=u.forwardRef(function(l,s){var i,o;[l,s]=H(l,s,X);let n=u.useContext(U),{placeholder:b}=W(N),a=n.selectedKey!=null?n.collection.getItem(n.selectedKey):null,r=a==null?void 0:a.props.children;typeof r=="function"&&(r=r({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"}));let $=Se(qe($e),"react-aria-components");var t,m,f;let d=A({...l,defaultChildren:(t=r??b)!==null&&t!==void 0?t:$.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(m=(i=n.selectedItem)===null||i===void 0?void 0:i.value)!==null&&m!==void 0?m:null,selectedText:(f=(o=n.selectedItem)===null||o===void 0?void 0:o.textValue)!==null&&f!==void 0?f:null,isPlaceholder:!a}}),p=j(l,{global:!0});return v.createElement("span",{ref:s,...p,...d,"data-placeholder":!a||void 0},v.createElement(q.Provider,{value:void 0},d.children))}),ze="flow--select",He="flow--select--toggle",T={select:ze,toggle:He},We=_("Select",e=>{const{children:l,className:s,onChange:i=()=>{},onSelectionChange:o=()=>{},controller:n,ref:b,...a}=e,r=Z(T.select,R.formField,s),$={Label:{className:R.label,optional:!e.isRequired},FieldDescription:{className:R.fieldDescription},FieldError:{className:R.customFieldError},Option:{tunnelId:"options"}},t=p=>{i(String(p)),o(p)},m=oe("Select",{reuseControllerFromContext:!0}),f=n??m,d=f.useIsOpen();return x.jsx(je,{...a,className:r,ref:b,onSelectionChange:t,onOpenChange:p=>f.setOpen(p),isOpen:d,children:x.jsx(G,{props:$,children:x.jsxs(J,{children:[x.jsxs(ie,{className:T.toggle,children:[x.jsx(Te,{}),x.jsx(ee,{})]}),l,x.jsx(ae,{controller:f,children:x.jsx(Q,{id:"options"})}),x.jsx(Y,{className:R.fieldError})]})})})});We.__docgenInfo={description:`@flr-generate all
@flr-clear-props-context`,methods:[],displayName:"Select"};export{We as S};
