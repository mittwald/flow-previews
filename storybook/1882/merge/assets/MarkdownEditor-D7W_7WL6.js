import{j as i,r as E}from"./iframe-Djw2qN4N.js";import{M as B}from"./Markdown-B3NMk6Mh.js";import{T as D}from"./TextArea-BcqdZHAt.js";import{O as k,K as T,P as O,Q as C,R as F}from"./IconWarning-CGeyKArL.js";import{B as S}from"./Button-DbUzlGPh.js";import{$ as I}from"./useLocalizedStringFormatter-A4R3Jnzo.js";import{c as H}from"./clsx-B-dksMZM.js";import{f as z}from"./PropsContextProvider-CTcixsmb.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],U=k("outline","bold","Bold",P);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],Q=k("outline","italic","Italic",K);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],V=k("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],G=k("outline","strikethrough","Strikethrough",Z);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],X=k("filled","quote-filled","QuoteFilled",J),Y="flow--markdown-editor",ee="flow--markdown-editor--toolbar",te="flow--markdown-editor--toolbar-buttons",ne="flow--markdown-editor--mode-button",se="flow--markdown-editor--markdown",w={markdownEditor:Y,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:ee,toolbarButtons:te,modeButton:ne,markdown:se},oe={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},q=(e,p)=>{const c=e.lastIndexOf(`
`,p-1);return c===-1?0:c+1},$=(e,p)=>{const c=e.indexOf(`
`,p);return c===-1?e.length:c},re=(e,p,c,o,u)=>{const h=c.current;if(!h)return;const{before:a,after:b="",toggleable:x=!1}=oe[o],t=h.selectionStart,m=h.selectionEnd,r=e.substring(t,m),y=r.split(`
`);let l=e,n=t,d=m;if(o==="code"&&r.includes(`
`))l=e.substring(0,t)+"```\n"+r+"\n```\n"+e.substring(m),n=t+4,d=n+r.length;else if(o==="orderedList")if(r){const s=y.map((g,f)=>`${f+1}. ${g}`).join(`
`);l=e.substring(0,t)+s+e.substring(m),n=t,d=t+s.length}else{const s=q(e,t),g=$(e,t),f=`- ${e.substring(s,g)}`;l=e.substring(0,s)+a+e.substring(s),n=s+f.length,d=n}else if(o==="unorderedList")if(r){const s=y.map(g=>`${a}${g}`).join(`
`);l=e.substring(0,t)+s+e.substring(m),n=t,d=t+s.length}else{const s=q(e,t),g=$(e,t),f=`- ${e.substring(s,g)}`;l=e.substring(0,s)+a+e.substring(s),n=s+f.length,d=n}else if(o==="quote")if(r){const s=y.map(g=>`${a}${g}`).join(`
`);l=e.substring(0,t)+s+e.substring(m),n=t,d=t+s.length}else{const s=`
${a} `;l=e.substring(0,t)+s+e.substring(m),n=t+s.length,d=n}else if(x){const s=e.substring(t-a.length,t),g=e.substring(m,m+b.length),f=s===a&&g===b,M=r.startsWith(a)&&r.endsWith(b);if(f)l=e.substring(0,t-a.length)+r+e.substring(m+b.length),n=t-a.length,d=n+r.length;else if(M){const j=r.slice(a.length,r.length-b.length);l=e.substring(0,t)+j+e.substring(m),n=t,d=t+j.length}else l=e.substring(0,t)+a+r+b+e.substring(m),r.length===0?(n=t+a.length,d=n):(n=t+a.length,d=n+r.length)}else if(o==="link"){let s="",g="",f="",M=0;r?(R=>{try{return new URL(R),!0}catch{return!1}})(r)?(g=r,f=`[](${g})`,M=t+1):(s=r,f=`[${s}]()`,M=t+f.indexOf("](")+2):(f="[](https://)",M=t+1),l=e.substring(0,t)+f+e.substring(m),n=d=M}else l=e.substring(0,t)+a+r+b+e.substring(m),r.length===0?(n=t+a.length,d=n):(n=t+a.length,d=n+r.length);p(l),u&&u(l),requestAnimationFrame(()=>{h.setSelectionRange(n,d),h.focus()})},N={"de-DE":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},v=e=>{const{markdown:p,setMarkdown:c,textAreaRef:o,children:u,isDisabled:h,type:a,onChange:b}=e,x=I(N);return i.jsx(S,{isDisabled:h,"aria-label":x.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>re(p,c,o,a,b),children:u})};v.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!0,tsType:{name:"InsertType"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}},composes:["PropsWithChildren"]};const _=e=>{const{setMode:p,mode:c,isDisabled:o}=e,u=I(N),h=c==="editor"?"preview":"editor";return i.jsx(S,{isDisabled:o,className:w.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>p(h),children:u.format(`mode.${h}`)})};_.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}};const A=e=>{const{setMode:p,mode:c,...o}=e;return i.jsxs("header",{className:w.toolbar,role:"toolbar",children:[c==="editor"&&i.jsxs("div",{className:w.toolbarButtons,children:[i.jsx(v,{...o,type:"bold",children:i.jsx(T,{children:i.jsx(U,{})})}),i.jsx(v,{...o,type:"italic",children:i.jsx(T,{children:i.jsx(Q,{})})}),i.jsx(v,{...o,type:"strikeThrough",children:i.jsx(T,{children:i.jsx(G,{})})}),i.jsx(v,{...o,type:"quote",children:i.jsx(T,{children:i.jsx(X,{})})}),i.jsx(v,{...o,type:"code",children:i.jsx(O,{})}),i.jsx(v,{...o,type:"link",children:i.jsx(C,{})}),i.jsx(v,{...o,type:"unorderedList",children:i.jsx(T,{children:i.jsx(F,{})})}),i.jsx(v,{...o,type:"orderedList",children:i.jsx(T,{children:i.jsx(V,{})})})]}),i.jsx(_,{setMode:p,mode:c,isDisabled:e.isDisabled})]})};A.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}}};const L=e=>{const{selectionStart:p}=e,c=parseInt(getComputedStyle(e).lineHeight||"20",10),o=e.value.slice(0,p).split(`
`).length;e.scrollTop=(o-1)*c},ie=(e,p,c,o)=>{if(e.key!=="Enter")return;const u=p.current;if(!u)return;const h=u.selectionStart,a=u.selectionEnd,b=u.value,x=b.slice(0,h),t=b.slice(a),m=x.lastIndexOf(`
`)+1,r=x.slice(m),y=r.match(/^(\s*)(\d+)\.\s+/),l=r.match(/^(\s*)([-*+])\s+/);if((y||l)&&r.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const n=b.slice(0,m)+`
`+t;c(n),o&&o(n),requestAnimationFrame(()=>{u.selectionStart=u.selectionEnd=m+1,L(u)});return}if(y){e.preventDefault();const n=y[1],d=parseInt(y[2]??"",10)+1,s=`
${n}${d}. `,g=x+s+t;c(g),o&&o(g),requestAnimationFrame(()=>{u.selectionStart=u.selectionEnd=h+s.length,L(u)})}else if(l){e.preventDefault();const n=l[1],d=l[2],s=`
${n}${d} `,g=x+s+t;c(g),o&&o(g),requestAnimationFrame(()=>{u.selectionStart=u.selectionEnd=h+s.length,L(u)})}},ae=z("MarkdownEditor",e=>{const{isDisabled:p,children:c,className:o,value:u,onChange:h,rows:a,autoResizeMaxRows:b,...x}=e,[t,m]=E.useState(u??""),[r,y]=E.useState("editor"),l=E.useRef(null),n=H(w.markdownEditor,o,w[`mode-${r}`]);return i.jsxs(D,{...x,isDisabled:p,className:n,ref:l,value:t,rows:a,autoResizeMaxRows:b,onChange:d=>m(d),onKeyDown:d=>ie(d,l,m,h),children:[i.jsx(A,{markdown:t,setMarkdown:m,textAreaRef:l,setMode:y,mode:r,isDisabled:p,onChange:h}),i.jsx(B,{className:w.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${b??a} + (var(--form-control--padding-y) * 2))`},children:t}),c]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
