import{j as o,r as E}from"./iframe-TjmQ4-hc.js";import{M as S}from"./Markdown-DjPhABNr.js";import{T as A}from"./TextArea-BKVozr8b.js";import{O as T,K as w,P as R,Q as B,R as D}from"./IconWarning-1inC7auC.js";import{B as L}from"./Button-CjK60Gy6.js";import{$ as q}from"./useLocalizedStringFormatter-CDqIJOhp.js";import{c as F}from"./clsx-B-dksMZM.js";import{f as O}from"./PropsContextProvider-mrDLBKOi.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],H=T("outline","bold","Bold",C);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],P=T("outline","italic","Italic",z);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],K=T("outline","list-numbers","ListNumbers",U);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],W=T("outline","strikethrough","Strikethrough",Q);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Z=T("filled","quote-filled","QuoteFilled",V),G="flow--markdown-editor",J="flow--markdown-editor--toolbar",X="flow--markdown-editor--toolbar-buttons",Y="flow--markdown-editor--mode-button",ee="flow--markdown-editor--markdown",M={markdownEditor:G,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:J,toolbarButtons:X,modeButton:Y,markdown:ee},te={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},oe=(t,f,h,r,c)=>{const m=h.current;if(!m)return;const{before:a,after:g="",toggleable:b=!1}=te[r],e=m.selectionStart,i=m.selectionEnd,n=t.substring(e,i),x=n.split(`
`);let d=t,s=e,l=i;if(r==="code"&&n.includes(`
`))d=t.substring(0,e)+"```\n"+n+"\n```\n"+t.substring(i),s=e+4,l=s+n.length;else if(r==="orderedList"){const u=x.map((p,y)=>`${y+1}. ${p}`).join(`
`);d=t.substring(0,e)+u+t.substring(i),s=e,l=e+u.length}else if(r==="unorderedList"){const u=x.map(p=>`- ${p}`).join(`
`);d=t.substring(0,e)+u+t.substring(i),s=e,l=e+u.length}else if(r==="quote"){const u=x.map(p=>`> ${p}`).join(`
`);d=t.substring(0,e)+u+t.substring(i),s=e,l=e+u.length}else if(b){const u=t.substring(e-a.length,e),p=t.substring(i,i+g.length),y=u===a&&p===g,k=n.startsWith(a)&&n.endsWith(g);if(y)d=t.substring(0,e-a.length)+n+t.substring(i+g.length),s=e-a.length,l=s+n.length;else if(k){const j=n.slice(a.length,n.length-g.length);d=t.substring(0,e)+j+t.substring(i),s=e,l=e+j.length}else d=t.substring(0,e)+a+n+g+t.substring(i),n.length===0?(s=e+a.length,l=s):(s=e+a.length,l=s+n.length)}else if(r==="link"){let u="",p="",y="",k=0;n?(N=>{try{return new URL(N),!0}catch{return!1}})(n)?(p=n,y=`[](${p})`,k=e+1):(u=n,y=`[${u}]()`,k=e+y.indexOf("](")+2):(y="[](https://)",k=e+1),d=t.substring(0,e)+y+t.substring(i),s=l=k}else d=t.substring(0,e)+a+n+g+t.substring(i),n.length===0?(s=e+a.length,l=s):(s=e+a.length,l=s+n.length);f(d),c&&c(d),requestAnimationFrame(()=>{m.setSelectionRange(s,l),m.focus()})},$={"de-DE":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},v=t=>{const{markdown:f,setMarkdown:h,textAreaRef:r,children:c,isDisabled:m,type:a,onChange:g}=t,b=q($);return o.jsx(L,{isDisabled:m,"aria-label":b.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>oe(f,h,r,a,g),children:c})};v.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!0,tsType:{name:"InsertType"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}},composes:["PropsWithChildren"]};const I=t=>{const{setMode:f,mode:h,isDisabled:r}=t,c=q($),m=h==="editor"?"preview":"editor";return o.jsx(L,{isDisabled:r,className:M.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>f(m),children:c.format(`mode.${m}`)})};I.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}};const _=t=>{const{setMode:f,mode:h,...r}=t;return o.jsxs("header",{className:M.toolbar,children:[h==="editor"&&o.jsxs("div",{className:M.toolbarButtons,children:[o.jsx(v,{...r,type:"bold",children:o.jsx(w,{children:o.jsx(H,{})})}),o.jsx(v,{...r,type:"italic",children:o.jsx(w,{children:o.jsx(P,{})})}),o.jsx(v,{...r,type:"strikeThrough",children:o.jsx(w,{children:o.jsx(W,{})})}),o.jsx(v,{...r,type:"quote",children:o.jsx(w,{children:o.jsx(Z,{})})}),o.jsx(v,{...r,type:"code",children:o.jsx(R,{})}),o.jsx(v,{...r,type:"link",children:o.jsx(B,{})}),o.jsx(v,{...r,type:"unorderedList",children:o.jsx(w,{children:o.jsx(D,{})})}),o.jsx(v,{...r,type:"orderedList",children:o.jsx(w,{children:o.jsx(K,{})})})]}),o.jsx(I,{setMode:f,mode:h,isDisabled:t.isDisabled})]})};_.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}}};const re=(t,f,h,r)=>{if(t.key!=="Enter")return;const c=f.current;if(!c)return;const m=c.selectionStart,a=c.selectionEnd,g=c.value,b=g.slice(0,m),e=g.slice(a),i=b.lastIndexOf(`
`)+1,n=b.slice(i),x=n.match(/^(\s*)(\d+)\.\s+/),d=n.match(/^(\s*)([-*+])\s+/);if((x||d)&&n.trim().match(/^([-*+]|\d+\.)$/)){t.preventDefault();const s=g.slice(0,i)+`
`+e;h(s),r&&r(s),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=i+1});return}if(x){t.preventDefault();const s=x[1],l=parseInt(x[2]??"",10)+1,u=`
${s}${l}. `,p=b+u+e;h(p),r&&r(p),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=m+u.length})}else if(d){t.preventDefault();const s=d[1],l=d[2],u=`
${s}${l} `,p=b+u+e;h(p),r&&r(p),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=m+u.length})}},ne=O("MarkdownEditor",t=>{const{isDisabled:f,children:h,className:r,value:c,onChange:m,rows:a,autoResizeMaxRows:g,...b}=t,[e,i]=E.useState(c??""),[n,x]=E.useState("editor"),d=E.useRef(null),s=F(M.markdownEditor,r,M[`mode-${n}`]);return o.jsxs(A,{...b,isDisabled:f,className:s,ref:d,value:e,rows:a,autoResizeMaxRows:g,onChange:l=>i(l),onKeyDown:l=>re(l,d,i,m),children:[o.jsx(_,{markdown:e,setMarkdown:i,textAreaRef:d,setMode:x,mode:n,isDisabled:f,onChange:m}),o.jsx(S,{className:M.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${g??a} + (var(--form-control--padding-y) * 2))`},children:e}),h]})});ne.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ne as M};
