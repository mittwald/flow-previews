import{j as n,r as E}from"./iframe-CqOqoVaP.js";import{M as S}from"./Markdown-BtxNWJ5U.js";import{T as A}from"./TextArea-HHUHvvWO.js";import{O as T,K as w,P as R,Q as B,R as D}from"./IconWarning-Bl-oEACJ.js";import{B as L}from"./Button-CLlHTQEG.js";import{$ as q}from"./useLocalizedStringFormatter-Cmj_M29U.js";import{c as F}from"./clsx-B-dksMZM.js";import{f as O}from"./PropsContextProvider-1TKyLHhH.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],H=T("outline","bold","Bold",C);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],P=T("outline","italic","Italic",z);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],K=T("outline","list-numbers","ListNumbers",U);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],W=T("outline","strikethrough","Strikethrough",Q);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Z=T("filled","quote-filled","QuoteFilled",V),G="flow--markdown-editor",J="flow--markdown-editor--toolbar",X="flow--markdown-editor--toolbar-buttons",Y="flow--markdown-editor--mode-button",ee="flow--markdown-editor--markdown",M={markdownEditor:G,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:J,toolbarButtons:X,modeButton:Y,markdown:ee},te={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`"},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},ne=(t,f,h,o,c)=>{const m=h.current;if(!m)return;const{before:a,after:p="",toggleable:b=!1}=te[o],e=m.selectionStart,i=m.selectionEnd,r=t.substring(e,i),x=r.split(`
`);let d=t,s=e,l=i;if(o==="code"&&r.includes(`
`))d=t.substring(0,e)+"```\n"+r+"\n```\n"+t.substring(i),s=e+4,l=s+r.length;else if(o==="orderedList"){const u=x.map((g,y)=>`${y+1}. ${g}`).join(`
`);d=t.substring(0,e)+u+t.substring(i),s=e,l=e+u.length}else if(o==="unorderedList"){const u=x.map(g=>`- ${g}`).join(`
`);d=t.substring(0,e)+u+t.substring(i),s=e,l=e+u.length}else if(o==="quote"){const u=x.map(g=>`> ${g}`).join(`
`);d=t.substring(0,e)+u+t.substring(i),s=e,l=e+u.length}else if(b){const u=t.substring(e-a.length,e),g=t.substring(i,i+p.length),y=u===a&&g===p,k=r.startsWith(a)&&r.endsWith(p);if(y)d=t.substring(0,e-a.length)+r+t.substring(i+p.length),s=e-a.length,l=s+r.length;else if(k){const j=r.slice(a.length,r.length-p.length);d=t.substring(0,e)+j+t.substring(i),s=e,l=e+j.length}else d=t.substring(0,e)+a+r+p+t.substring(i),r.length===0?(s=e+a.length,l=s):(s=e+a.length,l=s+r.length)}else if(o==="link"){let u="",g="",y="",k=0;r?(N=>{try{return new URL(N),!0}catch{return!1}})(r)?(g=r,y=`[](${g})`,k=e+1):(u=r,y=`[${u}]()`,k=e+y.indexOf("](")+2):(y="[](https://)",k=e+1),d=t.substring(0,e)+y+t.substring(i),s=l=k}else d=t.substring(0,e)+a+r+p+t.substring(i),r.length===0?(s=e+a.length,l=s):(s=e+a.length,l=s+r.length);f(d),c&&c(d),requestAnimationFrame(()=>{m.setSelectionRange(s,l),m.focus()})},$={"de-DE":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},v=t=>{const{markdown:f,setMarkdown:h,textAreaRef:o,children:c,isDisabled:m,type:a,onChange:p}=t,b=q($);return n.jsx(L,{isDisabled:m,"aria-label":b.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>ne(f,h,o,a,p),children:c})};v.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!0,tsType:{name:"InsertType"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}},composes:["PropsWithChildren"]};const I=t=>{const{setMode:f,mode:h,isDisabled:o}=t,c=q($),m=h==="editor"?"preview":"editor";return n.jsx(L,{isDisabled:o,className:M.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>f(m),children:c.format(`mode.${m}`)})};I.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}};const _=t=>{const{setMode:f,mode:h,...o}=t;return n.jsxs("header",{className:M.toolbar,children:[h==="editor"&&n.jsxs("div",{className:M.toolbarButtons,children:[n.jsx(v,{...o,type:"bold",children:n.jsx(w,{children:n.jsx(H,{})})}),n.jsx(v,{...o,type:"italic",children:n.jsx(w,{children:n.jsx(P,{})})}),n.jsx(v,{...o,type:"strikeThrough",children:n.jsx(w,{children:n.jsx(W,{})})}),n.jsx(v,{...o,type:"quote",children:n.jsx(w,{children:n.jsx(Z,{})})}),n.jsx(v,{...o,type:"code",children:n.jsx(R,{})}),n.jsx(v,{...o,type:"link",children:n.jsx(B,{})}),n.jsx(v,{...o,type:"unorderedList",children:n.jsx(w,{children:n.jsx(D,{})})}),n.jsx(v,{...o,type:"orderedList",children:n.jsx(w,{children:n.jsx(K,{})})})]}),n.jsx(I,{setMode:f,mode:h,isDisabled:t.isDisabled})]})};_.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}}};const oe=(t,f,h,o)=>{if(t.key!=="Enter")return;const c=f.current;if(!c)return;const m=c.selectionStart,a=c.selectionEnd,p=c.value,b=p.slice(0,m),e=p.slice(a),i=b.lastIndexOf(`
`)+1,r=b.slice(i),x=r.match(/^(\s*)(\d+)\.\s+/),d=r.match(/^(\s*)([-*+])\s+/);if((x||d)&&r.trim().match(/^([-*+]|\d+\.)$/)){t.preventDefault();const s=p.slice(0,i)+`
`+e;h(s),o&&o(s),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=i+1});return}if(x){t.preventDefault();const s=x[1],l=parseInt(x[2]??"",10)+1,u=`
${s}${l}. `,g=b+u+e;h(g),o&&o(g),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=m+u.length})}else if(d){t.preventDefault();const s=d[1],l=d[2],u=`
${s}${l} `,g=b+u+e;h(g),o&&o(g),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=m+u.length})}},re=O("MarkdownEditor",t=>{const{isDisabled:f,children:h,className:o,value:c,onChange:m,rows:a,autoResizeMaxRows:p,...b}=t,[e,i]=E.useState(c??""),[r,x]=E.useState("editor"),d=E.useRef(null),s=F(M.markdownEditor,o,M[`mode-${r}`]);return n.jsxs(A,{...b,isDisabled:f,className:s,ref:d,value:e,rows:a,autoResizeMaxRows:p,onChange:l=>i(l),onKeyDown:l=>oe(l,d,i,m),children:[n.jsx(_,{markdown:e,setMarkdown:i,textAreaRef:d,setMode:x,mode:r,isDisabled:f,onChange:m}),n.jsx(S,{className:M.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${p??a} + (var(--form-control--padding-y) * 2))`},children:e}),h]})});re.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{re as M};
