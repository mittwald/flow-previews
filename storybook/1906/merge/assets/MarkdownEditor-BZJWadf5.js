import{j as r,r as E}from"./iframe-CB_IvR8I.js";import{M as R}from"./Markdown-4aiR1q_v.js";import{T as B}from"./TextArea-DUii50sV.js";import{O as k,K as T,P as O,Q as C,R as F}from"./IconWarning-DHvxn9zQ.js";import{B as S}from"./Button-B6pH5E7T.js";import{$ as I}from"./useLocalizedStringFormatter-BKMvXLmW.js";import{c as H}from"./clsx-B-dksMZM.js";import{f as z}from"./PropsContextProvider-CQ73sAu4.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],U=k("outline","bold","Bold",P);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],Q=k("outline","italic","Italic",K);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],V=k("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],G=k("outline","strikethrough","Strikethrough",Z);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],X=k("filled","quote-filled","QuoteFilled",J),Y="flow--markdown-editor",ee="flow--markdown-editor--toolbar",te="flow--markdown-editor--toolbar-buttons",ne="flow--markdown-editor--mode-button",se="flow--markdown-editor--markdown",w={markdownEditor:Y,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:ee,toolbarButtons:te,modeButton:ne,markdown:se},oe={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},q=(e,h)=>{const i=e.lastIndexOf(`
`,h-1);return i===-1?0:i+1},$=(e,h)=>{const i=e.indexOf(`
`,h);return i===-1?e.length:i},re=(e,h,i,c,l)=>{const p=i.current;if(!p)return;const{before:a,after:f="",toggleable:y=!1}=oe[c],t=p.selectionStart,d=p.selectionEnd,o=e.substring(t,d),x=o.split(`
`);let u=e,s=t,m=d;if(c==="code"&&o.includes(`
`))u=e.substring(0,t)+"```\n"+o+"\n```\n"+e.substring(d),s=t+4,m=s+o.length;else if(c==="orderedList")if(o){const n=x.map((g,b)=>`${b+1}. ${g}`).join(`
`);u=e.substring(0,t)+n+e.substring(d),s=t,m=t+n.length}else{const n=q(e,t),g=$(e,t),b=`1. ${e.substring(n,g)}`;u=e.substring(0,n)+a+e.substring(n),s=n+b.length,m=s}else if(c==="unorderedList")if(o){const n=x.map(g=>`${a}${g}`).join(`
`);u=e.substring(0,t)+n+e.substring(d),s=t,m=t+n.length}else{const n=q(e,t),g=$(e,t),b=`- ${e.substring(n,g)}`;u=e.substring(0,n)+a+e.substring(n),s=n+b.length,m=s}else if(c==="quote")if(o){const n=x.map(g=>`${a}${g}`).join(`
`);u=e.substring(0,t)+n+e.substring(d),s=t,m=t+n.length}else{const n=`
${a} `;u=e.substring(0,t)+n+e.substring(d),s=t+n.length,m=s}else if(y){const n=e.substring(t-a.length,t),g=e.substring(d,d+f.length),b=n===a&&g===f,M=o.startsWith(a)&&o.endsWith(f);if(b)u=e.substring(0,t-a.length)+o+e.substring(d+f.length),s=t-a.length,m=s+o.length;else if(M){const j=o.slice(a.length,o.length-f.length);u=e.substring(0,t)+j+e.substring(d),s=t,m=t+j.length}else u=e.substring(0,t)+a+o+f+e.substring(d),o.length===0?(s=t+a.length,m=s):(s=t+a.length,m=s+o.length)}else if(c==="link"){let n="",g="",b="",M=0;o?(A=>{try{return new URL(A),!0}catch{return!1}})(o)?(g=o,b=`[](${g})`,M=t+1):(n=o,b=`[${n}]()`,M=t+b.indexOf("](")+2):(b="[](https://)",M=t+1),u=e.substring(0,t)+b+e.substring(d),s=m=M}else u=e.substring(0,t)+a+o+f+e.substring(d),o.length===0?(s=t+a.length,m=s):(s=t+a.length,m=s+o.length);h(u),l&&l(u),requestAnimationFrame(()=>{p.setSelectionRange(s,m),p.focus()})},N={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},v=e=>{const{markdown:h,setMarkdown:i,textAreaRef:c,children:l,isDisabled:p,type:a,onChange:f,mode:y}=e,t=I(N);return r.jsx(S,{isDisabled:p||y==="preview","aria-label":t.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>re(h,i,c,a,f),children:l})};v.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!0,tsType:{name:"InsertType"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""}},composes:["PropsWithChildren"]};const _=e=>{const{setMode:h,mode:i,isDisabled:c}=e,l=I(N),p=i==="editor"?"preview":"editor";return r.jsx(S,{isDisabled:c,className:w.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>h(p),children:l.format(`mode.${p}`)})};_.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}};const D=e=>{const{setMode:h,...i}=e;return r.jsxs("header",{className:w.toolbar,role:"toolbar",children:[r.jsxs("div",{className:w.toolbarButtons,children:[r.jsx(v,{...i,type:"bold",children:r.jsx(T,{children:r.jsx(U,{})})}),r.jsx(v,{...i,type:"italic",children:r.jsx(T,{children:r.jsx(Q,{})})}),r.jsx(v,{...i,type:"strikeThrough",children:r.jsx(T,{children:r.jsx(G,{})})}),r.jsx(v,{...i,type:"quote",children:r.jsx(T,{children:r.jsx(X,{})})}),r.jsx(v,{...i,type:"code",children:r.jsx(O,{})}),r.jsx(v,{...i,type:"link",children:r.jsx(C,{})}),r.jsx(v,{...i,type:"unorderedList",children:r.jsx(T,{children:r.jsx(F,{})})}),r.jsx(v,{...i,type:"orderedList",children:r.jsx(T,{children:r.jsx(V,{})})})]}),r.jsx(_,{setMode:h,mode:e.mode,isDisabled:e.isDisabled})]})};D.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}}};const L=e=>{const{selectionStart:h}=e,i=parseInt(getComputedStyle(e).lineHeight||"20",10),c=e.value.slice(0,h).split(`
`).length;e.scrollTop=(c-1)*i},ie=(e,h,i,c)=>{if(e.key!=="Enter")return;const l=h.current;if(!l)return;const p=l.selectionStart,a=l.selectionEnd,f=l.value,y=f.slice(0,p),t=f.slice(a),d=y.lastIndexOf(`
`)+1,o=y.slice(d),x=o.match(/^(\s*)(\d+)\.\s+/),u=o.match(/^(\s*)([-*+])\s+/);if((x||u)&&o.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const s=f.slice(0,d)+`
`+t;i(s),c&&c(s),requestAnimationFrame(()=>{l.selectionStart=l.selectionEnd=d+1,L(l)});return}if(x){e.preventDefault();const s=x[1],m=parseInt(x[2]??"",10)+1,n=`
${s}${m}. `,g=y+n+t;i(g),c&&c(g),requestAnimationFrame(()=>{l.selectionStart=l.selectionEnd=p+n.length,L(l)})}else if(u){e.preventDefault();const s=u[1],m=u[2],n=`
${s}${m} `,g=y+n+t;i(g),c&&c(g),requestAnimationFrame(()=>{l.selectionStart=l.selectionEnd=p+n.length,L(l)})}},ae=z("MarkdownEditor",e=>{const{isDisabled:h,children:i,className:c,value:l,onChange:p,rows:a,autoResizeMaxRows:f,headingOffset:y,...t}=e,[d,o]=E.useState(l??""),[x,u]=E.useState("editor"),s=E.useRef(null),m=H(w.markdownEditor,c,w[`mode-${x}`]);return r.jsxs(B,{...t,isDisabled:h||x==="preview",className:m,ref:s,value:l!==void 0?l:d,rows:a,autoResizeMaxRows:f,onChange:n=>{p&&p(n),o(n)},onKeyDown:n=>ie(n,s,o,p),children:[r.jsx(D,{markdown:d,setMarkdown:o,textAreaRef:s,setMode:u,mode:x,isDisabled:h,onChange:p}),r.jsx(R,{headingOffset:y,className:w.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${f??a} + (var(--form-control--padding-y) * 2))`},children:d}),i]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
