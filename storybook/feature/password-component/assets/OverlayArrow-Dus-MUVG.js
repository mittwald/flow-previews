import{j as ae}from"./useFocusRing-CTDVvBmm.js";import{c as G}from"./ProgressBar-BOrlGNM-.js";import{r as T,R as se}from"./index-B-o1Wr-g.js";import{c as q}from"./index-ynQ6n1pc.js";import{a as ce}from"./useLocalizedStringFormatter-BQr1rA-c.js";import{$ as fe}from"./useControlledState-BgxdDqm0.js";import{$ as de,a as pe}from"./utils-DQkeZTYT.js";function ue(){return typeof window.ResizeObserver<"u"}function K(t){const{ref:e,box:o,onResize:r}=t;T.useEffect(()=>{let l=e==null?void 0:e.current;if(l)if(ue()){const n=new window.ResizeObserver(s=>{s.length&&r()});return n.observe(l,{box:o}),()=>{l&&n.unobserve(l)}}else return window.addEventListener("resize",r,!1),()=>{window.removeEventListener("resize",r,!1)}},[r,e,o])}const A={top:"top",bottom:"top",left:"left",right:"left"},X={top:"bottom",bottom:"top",left:"right",right:"left"},me={top:"left",left:"top"},J={top:"height",left:"width"},le={width:"totalWidth",height:"totalHeight"},Y={};let C=typeof document<"u"?window.visualViewport:null;function Q(t){let e=0,o=0,r=0,l=0,n=0,s=0,i={};var $;let f=(($=C==null?void 0:C.scale)!==null&&$!==void 0?$:1)>1;if(t.tagName==="BODY"){let d=document.documentElement;r=d.clientWidth,l=d.clientHeight;var p;e=(p=C==null?void 0:C.width)!==null&&p!==void 0?p:r;var g;o=(g=C==null?void 0:C.height)!==null&&g!==void 0?g:l,i.top=d.scrollTop||t.scrollTop,i.left=d.scrollLeft||t.scrollLeft,C&&(n=C.offsetTop,s=C.offsetLeft)}else({width:e,height:o,top:n,left:s}=B(t)),i.top=t.scrollTop,i.left=t.scrollLeft,r=e,l=o;if(ae()&&(t.tagName==="BODY"||t.tagName==="HTML")&&f){i.top=0,i.left=0;var u;n=(u=C==null?void 0:C.pageTop)!==null&&u!==void 0?u:0;var a;s=(a=C==null?void 0:C.pageLeft)!==null&&a!==void 0?a:0}return{width:e,height:o,totalWidth:r,totalHeight:l,scroll:i,top:n,left:s}}function ve(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function W(t,e,o,r,l,n,s){var i;let $=(i=l.scroll[t])!==null&&i!==void 0?i:0,f=r[J[t]],p=r.scroll[A[t]]+n,g=f+r.scroll[A[t]]-n,u=e-$+s[t]-r[A[t]],a=e-$+o+s[t]-r[A[t]];return u<p?p-u:a>g?Math.max(g-a,p-u):0}function ge(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function V(t){if(Y[t])return Y[t];let[e,o]=t.split(" "),r=A[e]||"right",l=me[r];A[o]||(o="center");let n=J[r],s=J[l];return Y[t]={placement:e,crossPlacement:o,axis:r,crossAxis:l,size:n,crossSize:s},Y[t]}function U(t,e,o,r,l,n,s,i,$,f){let{placement:p,crossPlacement:g,axis:u,crossAxis:a,size:d,crossSize:h}=r,c={};var m;c[a]=(m=t[a])!==null&&m!==void 0?m:0;var v,E,z,P;g==="center"?c[a]+=(((v=t[h])!==null&&v!==void 0?v:0)-((E=o[h])!==null&&E!==void 0?E:0))/2:g!==a&&(c[a]+=((z=t[h])!==null&&z!==void 0?z:0)-((P=o[h])!==null&&P!==void 0?P:0)),c[a]+=n;const b=t[a]-o[h]+$+f,y=t[a]+t[h]-$-f;if(c[a]=G(c[a],b,y),p===u){const I=i?s[d]:e[le[d]];c[X[u]]=Math.floor(I-t[u]+l)}else c[u]=Math.floor(t[u]+t[d]+l);return c}function $e(t,e,o,r,l,n,s,i){const $=r?o.height:e[le.height];var f;let p=t.top!=null?o.top+t.top:o.top+($-((f=t.bottom)!==null&&f!==void 0?f:0)-s);var g,u,a,d,h,c;let m=i!=="top"?Math.max(0,e.height+e.top+((g=e.scroll.top)!==null&&g!==void 0?g:0)-p-(((u=l.top)!==null&&u!==void 0?u:0)+((a=l.bottom)!==null&&a!==void 0?a:0)+n)):Math.max(0,p+s-(e.top+((d=e.scroll.top)!==null&&d!==void 0?d:0))-(((h=l.top)!==null&&h!==void 0?h:0)+((c=l.bottom)!==null&&c!==void 0?c:0)+n));return Math.min(e.height-n*2,m)}function D(t,e,o,r,l,n){let{placement:s,axis:i,size:$}=n;var f,p;if(s===i)return Math.max(0,o[i]-t[i]-((f=t.scroll[i])!==null&&f!==void 0?f:0)+e[i]-((p=r[i])!==null&&p!==void 0?p:0)-r[X[i]]-l);var g;return Math.max(0,t[$]+t[i]+t.scroll[i]-e[i]-o[i]-o[$]-((g=r[i])!==null&&g!==void 0?g:0)-r[X[i]]-l)}function he(t,e,o,r,l,n,s,i,$,f,p,g,u,a,d,h){let c=V(t),{size:m,crossAxis:v,crossSize:E,placement:z,crossPlacement:P}=c,b=U(e,i,o,c,p,g,f,u,d,h),y=p,I=D(i,f,e,l,n+p,c);if(s&&r[m]>I){let Z=V(`${X[z]} ${P}`),ie=U(e,i,o,Z,p,g,f,u,d,h);D(i,f,e,l,n+p,Z)>I&&(c=Z,b=ie,y=p)}let S="bottom";c.axis==="top"?c.placement==="top"?S="top":c.placement==="bottom"&&(S="bottom"):c.crossAxis==="top"&&(c.crossPlacement==="top"?S="bottom":c.crossPlacement==="bottom"&&(S="top"));let w=W(v,b[v],o[E],i,$,n,f);b[v]+=w;let R=$e(b,i,f,u,l,n,o.height,S);a&&a<R&&(R=a),o.height=Math.min(o.height,R),b=U(e,i,o,c,y,g,f,u,d,h),w=W(v,b[v],o[E],i,$,n,f),b[v]+=w;let H={},O=e[v]+.5*e[E]-b[v]-l[A[v]];const _=d/2+h;var k,N,M,L;const F=A[v]==="left"?((k=l.left)!==null&&k!==void 0?k:0)+((N=l.right)!==null&&N!==void 0?N:0):((M=l.top)!==null&&M!==void 0?M:0)+((L=l.bottom)!==null&&L!==void 0?L:0),j=o[E]-F-d/2-h,oe=e[v]+d/2-(b[v]+l[A[v]]),re=e[v]+e[E]-d/2-(b[v]+l[A[v]]),ne=G(O,oe,re);return H[v]=G(ne,_,j),{position:b,maxHeight:R,arrowOffsetLeft:H.left,arrowOffsetTop:H.top,placement:c.placement}}function be(t){let{placement:e,targetNode:o,overlayNode:r,scrollNode:l,padding:n,shouldFlip:s,boundaryElement:i,offset:$,crossOffset:f,maxHeight:p,arrowSize:g=0,arrowBoundaryOffset:u=0}=t,a=r instanceof HTMLElement?xe(r):document.documentElement,d=a===document.documentElement;const h=window.getComputedStyle(a).position;let c=!!h&&h!=="static",m=d?B(o):ee(o,a);if(!d){let{marginTop:H,marginLeft:O}=window.getComputedStyle(o);m.top+=parseInt(H,10)||0,m.left+=parseInt(O,10)||0}let v=B(r),E=ge(r);var z,P;v.width+=((z=E.left)!==null&&z!==void 0?z:0)+((P=E.right)!==null&&P!==void 0?P:0);var b,y;v.height+=((b=E.top)!==null&&b!==void 0?b:0)+((y=E.bottom)!==null&&y!==void 0?y:0);let I=ve(l),S=Q(i),w=Q(a),R=i.tagName==="BODY"?B(a):ee(a,i);return a.tagName==="HTML"&&i.tagName==="BODY"&&(w.scroll.top=0,w.scroll.left=0),he(e,m,v,I,E,n,s,S,w,R,$,f,c,p,g,u)}function B(t){let{top:e,left:o,width:r,height:l}=t.getBoundingClientRect(),{scrollTop:n,scrollLeft:s,clientTop:i,clientLeft:$}=document.documentElement;return{top:e+n-i,left:o+s-$,width:r,height:l}}function ee(t,e){let o=window.getComputedStyle(t),r;if(o.position==="fixed"){let{top:l,left:n,width:s,height:i}=t.getBoundingClientRect();r={top:l,left:n,width:s,height:i}}else{r=B(t);let l=B(e),n=window.getComputedStyle(e);l.top+=(parseInt(n.borderTopWidth,10)||0)-e.scrollTop,l.left+=(parseInt(n.borderLeftWidth,10)||0)-e.scrollLeft,r.top-=l.top,r.left-=l.left}return r.top-=parseInt(o.marginTop,10)||0,r.left-=parseInt(o.marginLeft,10)||0,r}function xe(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!te(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!te(e);)e=e.parentElement;return e||document.documentElement}function te(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const we=new WeakMap;function Ee(t){let{triggerRef:e,isOpen:o,onClose:r}=t;T.useEffect(()=>{if(!o||r===null)return;let l=n=>{let s=n.target;if(!e.current||s instanceof Node&&!s.contains(e.current)||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement)return;let i=r||we.get(e.current);i&&i()};return window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("scroll",l,!0)}},[o,r,e])}let x=typeof document<"u"?window.visualViewport:null;function Ae(t){let{direction:e}=ce(),{arrowSize:o=0,targetRef:r,overlayRef:l,scrollRef:n=l,placement:s="bottom",containerPadding:i=12,shouldFlip:$=!0,boundaryElement:f=typeof document<"u"?document.body:null,offset:p=0,crossOffset:g=0,shouldUpdatePosition:u=!0,isOpen:a=!0,onClose:d,maxHeight:h,arrowBoundaryOffset:c=0}=t,[m,v]=T.useState(null),E=[u,s,l.current,r.current,n.current,i,$,f,p,g,a,e,h,c,o],z=T.useRef(x==null?void 0:x.scale);T.useEffect(()=>{a&&(z.current=x==null?void 0:x.scale)},[a]);let P=T.useCallback(()=>{if(u===!1||!a||!l.current||!r.current||!f||(x==null?void 0:x.scale)!==z.current)return;let w=null;if(n.current&&n.current.contains(document.activeElement)){var R;let L=(R=document.activeElement)===null||R===void 0?void 0:R.getBoundingClientRect(),F=n.current.getBoundingClientRect();var H;if(w={type:"top",offset:((H=L==null?void 0:L.top)!==null&&H!==void 0?H:0)-F.top},w.offset>F.height/2){w.type="bottom";var O;w.offset=((O=L==null?void 0:L.bottom)!==null&&O!==void 0?O:0)-F.bottom}}let _=l.current;if(!h&&l.current){var k;_.style.top="0px",_.style.bottom="";var N;_.style.maxHeight=((N=(k=window.visualViewport)===null||k===void 0?void 0:k.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let M=be({placement:Pe(s,e),overlayNode:l.current,targetNode:r.current,scrollNode:n.current||l.current,padding:i,shouldFlip:$,boundaryElement:f,offset:p,crossOffset:g,maxHeight:h,arrowSize:o,arrowBoundaryOffset:c});if(M.position){if(_.style.top="",_.style.bottom="",_.style.left="",_.style.right="",Object.keys(M.position).forEach(L=>_.style[L]=M.position[L]+"px"),_.style.maxHeight=M.maxHeight!=null?M.maxHeight+"px":"",w&&document.activeElement&&n.current){let L=document.activeElement.getBoundingClientRect(),F=n.current.getBoundingClientRect(),j=L[w.type]-F[w.type];n.current.scrollTop+=j-w.offset}v(M)}},E);q(P,E),Ce(P),K({ref:l,onResize:P}),K({ref:r,onResize:P});let b=T.useRef(!1);q(()=>{let w,R=()=>{b.current=!0,clearTimeout(w),w=setTimeout(()=>{b.current=!1},500),P()},H=()=>{b.current&&R()};return x==null||x.addEventListener("resize",R),x==null||x.addEventListener("scroll",H),()=>{x==null||x.removeEventListener("resize",R),x==null||x.removeEventListener("scroll",H)}},[P]);let y=T.useCallback(()=>{b.current||d==null||d()},[d,b]);Ee({triggerRef:r,isOpen:a,onClose:d&&y});var I,S;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...m==null?void 0:m.position,maxHeight:(I=m==null?void 0:m.maxHeight)!==null&&I!==void 0?I:"100vh"}},placement:(S=m==null?void 0:m.placement)!==null&&S!==void 0?S:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:m==null?void 0:m.arrowOffsetLeft,top:m==null?void 0:m.arrowOffsetTop}},updatePosition:P}}function Ce(t){q(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function Pe(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function Oe(t){let[e,o]=fe(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const r=T.useCallback(()=>{o(!0)},[o]),l=T.useCallback(()=>{o(!1)},[o]),n=T.useCallback(()=>{o(!e)},[o,e]);return{isOpen:e,setOpen:o,open:r,close:l,toggle:n}}const Le=T.createContext({placement:"bottom"});function Re(t,e){[t,e]=de(t,e,Le);let o=t.placement,r={position:"absolute",transform:o==="top"||o==="bottom"?"translateX(-50%)":"translateY(-50%)"};o!=null&&(r[o]="100%");let l=pe({...t,defaultClassName:"react-aria-OverlayArrow",values:{placement:o}});return l.style&&Object.keys(l.style).forEach(n=>l.style[n]===void 0&&delete l.style[n]),se.createElement("div",{...t,...l,style:{...r,...l.style},ref:e,"data-placement":o})}const ke=T.forwardRef(Re);export{ke as $,Oe as a,Ae as b,Le as c,K as d,we as e};
