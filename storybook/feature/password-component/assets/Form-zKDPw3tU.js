import{h as p}from"./useFocusRing-CqFdZJbR.js";import{r as $,R as c}from"./index-Cs7sjTYM.js";import{c as g,b as f,e as m,a as h}from"./index-j_f0pOtZ.js";import{$ as E}from"./useLabel-BA8WH6BO.js";import{$ as x}from"./utils-BFFU14Eb.js";import{b as M}from"./FieldError-esCwSIkI.js";function C(i,e,a){let{validationBehavior:n,focus:l}=i;g(()=>{if(n==="native"&&(a!=null&&a.current)){let t=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(t),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(y(a.current))}});let d=f(()=>{e.resetValidation()}),o=f(t=>{var r;e.displayValidation.isInvalid||e.commitValidation();let u=a==null||(r=a.current)===null||r===void 0?void 0:r.form;if(!t.defaultPrevented&&a&&u&&P(u)===a.current){var v;l?l():(v=a.current)===null||v===void 0||v.focus(),p("keyboard")}t.preventDefault()}),s=f(()=>{e.commitValidation()});$.useEffect(()=>{let t=a==null?void 0:a.current;if(!t)return;let r=t.form;return t.addEventListener("invalid",o),t.addEventListener("change",s),r==null||r.addEventListener("reset",d),()=>{t.removeEventListener("invalid",o),t.removeEventListener("change",s),r==null||r.removeEventListener("reset",d)}},[a,o,s,d,n])}function I(i){let e=i.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function y(i){return{isInvalid:!i.validity.valid,validationDetails:I(i),validationErrors:i.validationMessage?[i.validationMessage]:[]}}function P(i){for(let e=0;e<i.elements.length;e++){let a=i.elements[e];if(!a.validity.valid)return a}return null}function F(i){let{description:e,errorMessage:a,isInvalid:n,validationState:l}=i,{labelProps:d,fieldProps:o}=E(i),s=m([!!e,!!a,n,l]),t=m([!!e,!!a,n,l]);return o=h(o,{"aria-describedby":[s,t,i["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:d,fieldProps:o,descriptionProps:{id:s},errorMessageProps:{id:t}}}const b=$.createContext(null);function V(i,e){[i,e]=x(i,e,b);let{validationErrors:a,validationBehavior:n="native",children:l,className:d,...o}=i;return c.createElement("form",{noValidate:n!=="native",...o,ref:e,className:d||"react-aria-Form"},c.createElement(b.Provider,{value:{...i,validationBehavior:n}},c.createElement(M.Provider,{value:a??{}},l)))}const j=$.forwardRef(V);export{F as $,C as a,j as b,b as c};
