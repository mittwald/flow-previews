import{r as f,R as v,j as h}from"./iframe-4Q3VdU3W.js";import{f as _,P as G,k as J,A as Q}from"./flowComponent-CWhymxNW.js";import{f as I}from"./FormField.module-CqWyJNQI.js";import{F as Y}from"./FieldError-BQ2VN50e.js";import{c as Z}from"./clsx-B-dksMZM.js";import{c as ee}from"./IconWarning-C7969b2c.js";import{$ as le,a as te,b as ae}from"./Option-eCkGPB02.js";import{u as oe}from"./useOverlayController-CkYiJEJ3.js";import{$ as z,c as H,a as W,f as ie,g as re,d as se,b as ne}from"./utils-BDqSegOF.js";import{u as de}from"./useMakeFocusable-yVzA5tdL.js";import{$ as A,a as ce}from"./Button-CVw6sY0j.js";import{a as fe}from"./FieldError-Bmwt53NP.js";import{a as ue,$ as be}from"./Form-CQ3IrCNT.js";import{$ as $e}from"./intlStrings-ZMTSFH_M.js";import{b as L}from"./Label-BPYRgbkp.js";import{l as me,h as pe,m as ve}from"./Dialog-eTJli1DK.js";import{a as q}from"./Text-CbQs5VbJ.js";import{e as ge}from"./CollectionBuilder-Djb2_WqG.js";import{$ as M,f as ye,e as xe}from"./index-D-slKUrQ.js";import{$ as j}from"./filterDOMProps-CghfNOdR.js";import{c as he,g as Pe}from"./OverlayArrow-C0bCojbN.js";import{$ as Se}from"./useLocalizedStringFormatter-BfINV5Nx.js";import{b as Ce,$ as Re}from"./useFormValidation-QKBec53c.js";import{$ as Fe}from"./useSingleSelectListState-DhrifJN8.js";import{a as De}from"./useFocusRing-JPznIV6A.js";import{$ as Ie,h as Ee}from"./SelectionManager-DSIHg9Rl.js";import{E as Ke}from"./useFocus-B23mYmqe.js";import{a as Be}from"./useCollator-DKF-AEK0.js";import{$ as Oe}from"./useFormReset-DJaP_Vl0.js";import{a as we}from"./VisuallyHidden-Bs3ruDlE.js";const V=new WeakMap;function ke(e,l,s){let{keyboardDelegate:i,isDisabled:o,isRequired:n,name:u,form:a,validationBehavior:r="aria"}=e,$=Be({usage:"search",sensitivity:"base"}),t=f.useMemo(()=>i||new Ie(l.collection,l.disabledKeys,s,$),[i,l.collection,l.disabledKeys,$,s]),{menuTriggerProps:m,menuProps:b}=me({isDisabled:o,type:"listbox"},l,s),d=c=>{switch(c.key){case"ArrowLeft":{var C,R;c.preventDefault();let D=l.selectedKey!=null?(C=t.getKeyAbove)===null||C===void 0?void 0:C.call(t,l.selectedKey):(R=t.getFirstKey)===null||R===void 0?void 0:R.call(t);D&&l.setSelectedKey(D);break}case"ArrowRight":{var w,k;c.preventDefault();let D=l.selectedKey!=null?(w=t.getKeyBelow)===null||w===void 0?void 0:w.call(t,l.selectedKey):(k=t.getFirstKey)===null||k===void 0?void 0:k.call(t);D&&l.setSelectedKey(D);break}}},{typeSelectProps:p}=Ee({keyboardDelegate:t,selectionManager:l.selectionManager,onTypeSelect(c){l.setSelectedKey(c)}}),{isInvalid:x,validationErrors:P,validationDetails:g}=l.displayValidation,{labelProps:K,fieldProps:F,descriptionProps:S,errorMessageProps:B}=ue({...e,labelElementType:"span",isInvalid:x,errorMessage:e.errorMessage||P});p.onKeyDown=p.onKeyDownCapture,delete p.onKeyDownCapture;let O=j(e,{labelable:!0}),y=M(p,m,F),E=ye();return V.set(l,{isDisabled:o,isRequired:n,name:u,form:a,validationBehavior:r}),{labelProps:{...K,onClick:()=>{if(!e.isDisabled){var c;(c=s.current)===null||c===void 0||c.focus(),Ke("keyboard")}}},triggerProps:M(O,{...y,isDisabled:o,onKeyDown:xe(y.onKeyDown,d,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[E,y["aria-labelledby"],y["aria-label"]&&!y["aria-labelledby"]?y.id:null].filter(Boolean).join(" "),onFocus(c){l.isFocused||(e.onFocus&&e.onFocus(c),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(c){l.isOpen||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:E},menuProps:{...b,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:c=>{c.currentTarget.contains(c.relatedTarget)||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[F["aria-labelledby"],y["aria-label"]&&!F["aria-labelledby"]?y.id:null].filter(Boolean).join(" ")},descriptionProps:S,errorMessageProps:B,isInvalid:x,validationErrors:P,validationDetails:g,hiddenSelectProps:{isDisabled:o,name:u,label:e.label,state:l,triggerRef:s,form:a}}}function Me(e,l,s){let i=V.get(l)||{},{autoComplete:o,name:n=i.name,form:u=i.form,isDisabled:a=i.isDisabled}=e,{validationBehavior:r,isRequired:$}=i,{visuallyHiddenProps:t}=we({style:{position:"fixed",top:0,left:0}});Oe(e.selectRef,l.defaultSelectedKey,l.setSelectedKey),Ce({validationBehavior:r,focus:()=>{var d;return(d=s.current)===null||d===void 0?void 0:d.focus()}},l,e.selectRef);let m=f.useCallback(d=>l.setSelectedKey(d.currentTarget.value),[l.setSelectedKey]);var b;return{containerProps:{...t,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:a,required:r==="native"&&$,name:n,form:u,value:(b=l.selectedKey)!==null&&b!==void 0?b:"",onChange:m,onInput:m}}}function qe(e){let{state:l,triggerRef:s,label:i,name:o,form:n,isDisabled:u}=e,a=f.useRef(null),r=f.useRef(null),{containerProps:$,selectProps:t}=Me({...e,selectRef:l.collection.size<=300?a:r},l,s);if(l.collection.size<=300)return v.createElement("div",{...$,"data-testid":"hidden-select-container"},v.createElement("label",null,i,v.createElement("select",{...t,ref:a},v.createElement("option",null),[...l.collection.getKeys()].map(b=>{let d=l.collection.getItem(b);if(d&&d.type==="item")return v.createElement("option",{key:d.key,value:d.key},d.textValue)}))));if(o){let b=V.get(l)||{},{validationBehavior:d}=b;var m;let p={type:"hidden",autoComplete:t.autoComplete,name:o,form:n,disabled:u,value:(m=l.selectedKey)!==null&&m!==void 0?m:""};return d==="native"?v.createElement("input",{...p,ref:r,style:{display:"none"},type:"text",required:t.required,onChange:()=>{}}):v.createElement("input",{...p,ref:r})}return null}function je(e){let l=he(e),[s,i]=f.useState(null),o=Fe({...e,onSelectionChange:t=>{e.onSelectionChange!=null&&e.onSelectionChange(t),l.close(),n.commitValidation()}}),n=Re({...e,value:o.selectedKey}),[u,a]=f.useState(!1),[r]=f.useState(o.selectedKey);var $;return{...n,...o,...l,defaultSelectedKey:($=e.defaultSelectedKey)!==null&&$!==void 0?$:r,focusStrategy:s,open(t=null){o.collection.size!==0&&(i(t),l.open())},toggle(t=null){o.collection.size!==0&&(i(t),l.toggle())},isFocused:u,setFocused:a}}function Ve(e){return e&&e.__esModule?e.default:e}const N=f.createContext(null),U=f.createContext(null),Ne=f.forwardRef(function(l,s){[l,s]=z(l,s,N);let{children:i,isDisabled:o=!1,isInvalid:n=!1,isRequired:u=!1}=l,a=f.useMemo(()=>typeof i=="function"?i({isOpen:!1,isDisabled:o,isInvalid:n,isRequired:u,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):i,[i,o,n,u]);return v.createElement(ge,{content:a},r=>v.createElement(ze,{props:l,collection:r,selectRef:s}))}),Te=[L,A,q];function ze({props:e,selectRef:l,collection:s}){let{validationBehavior:i}=H(be)||{};var o,n;let u=(n=(o=e.validationBehavior)!==null&&o!==void 0?o:i)!==null&&n!==void 0?n:"native",a=je({...e,collection:s,children:void 0,validationBehavior:u}),{isFocusVisible:r,focusProps:$}=De({within:!0}),t=f.useRef(null),[m,b]=ie(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:d,triggerProps:p,valueProps:x,menuProps:P,descriptionProps:g,errorMessageProps:K,hiddenSelectProps:F,...S}=ke({...re(e),label:b,validationBehavior:u},a,t),[B,O]=f.useState(null),y=f.useCallback(()=>{t.current&&O(t.current.offsetWidth+"px")},[t]);Pe({ref:t,onResize:y});let E=f.useMemo(()=>({isOpen:a.isOpen,isFocused:a.isFocused,isFocusVisible:r,isDisabled:e.isDisabled||!1,isInvalid:S.isInvalid||!1,isRequired:e.isRequired||!1}),[a.isOpen,a.isFocused,r,e.isDisabled,S.isInvalid,e.isRequired]),c=W({...e,values:E,defaultClassName:"react-aria-Select"}),C=j(e,{global:!0});delete C.id;let R=f.useRef(null);return v.createElement(se,{values:[[N,e],[U,a],[X,x],[L,{...d,ref:m,elementType:"span"}],[A,{...p,ref:t,isPressed:a.isOpen,autoFocus:e.autoFocus}],[pe,a],[ve,{trigger:"Select",triggerRef:t,scrollRef:R,placement:"bottom start",style:{"--trigger-width":B},"aria-labelledby":P["aria-labelledby"],clearContexts:Te}],[le,{...P,ref:R}],[te,a],[q,{slots:{description:g,errorMessage:K}}],[fe,S]]},v.createElement("div",{...M(C,c,$),ref:l,slot:e.slot||void 0,"data-focused":a.isFocused||void 0,"data-focus-visible":r||void 0,"data-open":a.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":S.isInvalid||void 0,"data-required":e.isRequired||void 0},c.children,v.createElement(qe,{...F,autoComplete:e.autoComplete})))}const X=f.createContext(null),He=f.forwardRef(function(l,s){var i,o;[l,s]=z(l,s,X);let n=f.useContext(U),{placeholder:u}=H(N),a=n.selectedKey!=null?n.collection.getItem(n.selectedKey):null,r=a==null?void 0:a.props.children;typeof r=="function"&&(r=r({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"}));let $=Se(Ve($e),"react-aria-components");var t,m,b;let d=W({...l,defaultChildren:(t=r??u)!==null&&t!==void 0?t:$.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(m=(i=n.selectedItem)===null||i===void 0?void 0:i.value)!==null&&m!==void 0?m:null,selectedText:(b=(o=n.selectedItem)===null||o===void 0?void 0:o.textValue)!==null&&b!==void 0?b:null,isPlaceholder:!a}}),p=j(l,{global:!0});return v.createElement("span",{ref:s,...p,...d,"data-placeholder":!a||void 0},v.createElement(q.Provider,{value:void 0},d.children))}),We="flow--select",Ae="flow--select--toggle",T={select:We,toggle:Ae},Le=_("Select",e=>{const{children:l,className:s,onChange:i=()=>{},onSelectionChange:o=()=>{},controller:n,ref:u,isReadOnly:a,...r}=e,$=Z(T.select,I.formField,s),t={Label:{className:I.label,optional:!e.isRequired},FieldDescription:{className:I.fieldDescription},FieldError:{className:I.customFieldError},Option:{tunnelId:"options"}},m=g=>{i(String(g)),o(g)},b=oe("Select",{reuseControllerFromContext:!0}),d=ne(u),p=f.useRef(null);de(d,()=>{var g;(g=p.current)==null||g.focus()});const x=n??b,P=x.useIsOpen();return h.jsx(Ne,{...r,className:$,ref:d,onSelectionChange:a?void 0:m,onOpenChange:g=>!a&&x.setOpen(g),isOpen:P,"data-readonly":a,children:h.jsx(G,{props:t,children:h.jsxs(J,{children:[h.jsxs(ce,{ref:p,"data-readonly":a,className:T.toggle,children:[h.jsx(He,{}),h.jsx(ee,{})]}),l,h.jsx(ae,{controller:x,children:h.jsx(Q,{id:"options"})}),h.jsx(Y,{className:I.fieldError})]})})})});Le.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Select"};export{Le as S};
