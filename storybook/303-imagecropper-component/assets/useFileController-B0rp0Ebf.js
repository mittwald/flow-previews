var v=Object.defineProperty;var y=(t,e,r)=>e in t?v(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var p=(t,e,r)=>y(t,typeof e!="symbol"?e+"":e,r);import{r as b,R as l}from"./index-Cs7sjTYM.js";import{$ as F}from"./Input-B2XFbQTW.js";import{$ as g}from"./filterDOMProps-CeZl_uWj.js";import{b as w}from"./utils-Cy-A-nlV.js";import{$ as E}from"./PressResponder-COi_Rbo6.js";import{m as x,o as R,b as d}from"./flowComponent-S4fYrZHa.js";import{u as T}from"./useSelector-CuLBdmz2.js";function C(t,e){let{onSelect:r,acceptedFileTypes:i,allowsMultiple:o,defaultCamera:a,children:f,acceptDirectory:n,...$}=t,c=w(e),h=g($);return l.createElement(l.Fragment,null,l.createElement(E,{onPress:()=>{var s,u;!((s=c.current)===null||s===void 0)&&s.value&&(c.current.value=""),(u=c.current)===null||u===void 0||u.click()}},f),l.createElement(F,{...h,type:"file",ref:c,style:{display:"none"},accept:i==null?void 0:i.toString(),onChange:s=>r==null?void 0:r(s.target.files),capture:a,multiple:o,webkitdirectory:n?"":void 0}))}const S=b.forwardRef(C),_=t=>{const{controller:e,children:r,...i}=t;return l.createElement(l.Fragment,null,l.createElement(S,{...i,onSelect:o=>e.selectFile(o,t.allowsMultiple)},r))};_.__docgenInfo={description:"",methods:[],displayName:"FileTrigger",props:{className:{required:!1,tsType:{name:"string"},description:""},controller:{required:!0,tsType:{name:"FileController"},description:""}}};class m{constructor(){p(this,"files",new Map);p(this,"id",0);x(this,{files:R.shallow,add:d.bound,clear:d.bound,dropFile:d.bound,selectFile:d.bound})}static useNew(){return b.useRef(new m).current}useFiles(){return T(()=>Array.from(this.files.values()))}add(e){const r=this.id++;this.files.set(r,e)}clear(){this.files.clear()}async dropFile(e,r,i){e.items.filter(a=>a.kind==="file").map(async(a,f)=>{const n=await a.getFile();if(r&&!r.includes(n.type))throw new Error("invalid file type");if(!i&&f>0)throw new Error("invalid file count");i||this.clear(),this.add(n)})}selectFile(e,r){(e?Array.from(e):[]).map(o=>{r||this.clear(),this.add(o)})}}const O=()=>m.useNew();export{_ as F,O as u};
