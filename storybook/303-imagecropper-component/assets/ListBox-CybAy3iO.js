import{c as X,d as Y,e as Z,b as ee,f as R}from"./Collection-DR5xXegF.js";import{a as oe,i as te,c as U,g as K,e as re,h as ae,b as W}from"./utils-Cy-A-nlV.js";import{$ as O,a as ie,b as le}from"./useDragAndDrop-v_ykJosS.js";import{$ as de}from"./Header-CXhviMrv.js";import{$ as ne,a as se}from"./Separator-CWkByXs_.js";import{a as ce}from"./Text-Dh5WnJTs.js";import{b as j,a as B,e as z,f as ue}from"./index-Dy0c0dcE.js";import{$ as C}from"./filterDOMProps-CeZl_uWj.js";import{r as u,R as d}from"./index-Cs7sjTYM.js";import{$ as pe}from"./useListState-2SjGmdPJ.js";import{$ as fe}from"./useLocalizedStringFormatter-Ccpl5Mb8.js";import{c as $e,d as be,e as ve}from"./SelectionManager-Dy9tah2i.js";import{a as ge,i as he,j as me,b as q,k as N,c as xe}from"./useFocusable-OFlS-6qe.js";import{$ as Pe}from"./useLabel-B-9ggeSA.js";import{$ as ye,a as De}from"./useMenuTrigger-BlNU1FKo.js";import{c as Se}from"./usePress-CTrgc7uI.js";import{a as ke}from"./FocusScope-67rE8EpU.js";const L=new WeakMap;function we(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function Ee(e,o){let i=L.get(e);if(!i)throw new Error("Unknown list");return`${i.id}-option-${we(o)}`}function Fe(e,o,i){let t=C(e,{labelable:!0}),a=e.selectionBehavior||"toggle",l=e.linkBehavior||(a==="replace"?"action":"override");a==="toggle"&&l==="action"&&(l="override");let{listProps:r}=ye({...e,ref:i,selectionManager:o.selectionManager,collection:o.collection,disabledKeys:o.disabledKeys,linkBehavior:l}),{focusWithinProps:$}=ge({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),n=j(e.id);L.set(o,{id:n,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:l});let{labelProps:f,fieldProps:s}=Pe({...e,id:n,labelElementType:"span"});return{labelProps:f,listBoxProps:B(t,$,o.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...B(s,r)})}}function He(e,o,i){var t,a;let{key:l}=e,r=L.get(o);var $;let n=($=e.isDisabled)!==null&&$!==void 0?$:o.selectionManager.isDisabled(l);var f;let s=(f=e.isSelected)!==null&&f!==void 0?f:o.selectionManager.isSelected(l);var m;let b=(m=e.shouldSelectOnPressUp)!==null&&m!==void 0?m:r==null?void 0:r.shouldSelectOnPressUp;var v;let p=(v=e.shouldFocusOnHover)!==null&&v!==void 0?v:r==null?void 0:r.shouldFocusOnHover;var P;let k=(P=e.shouldUseVirtualFocus)!==null&&P!==void 0?P:r==null?void 0:r.shouldUseVirtualFocus;var y;let S=(y=e.isVirtualized)!==null&&y!==void 0?y:r==null?void 0:r.isVirtualized,D=z(),x=z(),g={role:"option","aria-disabled":n||void 0,"aria-selected":o.selectionManager.selectionMode!=="none"?s:void 0};he()&&me()||(g["aria-label"]=e["aria-label"],g["aria-labelledby"]=D,g["aria-describedby"]=x);let c=o.collection.getItem(l);if(S){let w=Number(c==null?void 0:c.index);g["aria-posinset"]=Number.isNaN(w)?void 0:w+1,g["aria-setsize"]=De(o.collection)}let E=r!=null&&r.onAction?()=>{var w;return r==null||(w=r.onAction)===null||w===void 0?void 0:w.call(r,l)}:void 0,{itemProps:M,isPressed:A,isFocused:F,hasAction:_,allowsSelection:I}=$e({selectionManager:o.selectionManager,key:l,ref:i,shouldSelectOnPressUp:b,allowsDifferentPressOrigin:b&&p,isVirtualized:S,shouldUseVirtualFocus:k,isDisabled:n,onAction:E||!(c==null||(t=c.props)===null||t===void 0)&&t.onAction?ue(c==null||(a=c.props)===null||a===void 0?void 0:a.onAction,E):void 0,linkBehavior:r==null?void 0:r.linkBehavior}),{hoverProps:T}=q({isDisabled:n||!p,onHoverStart(){N()||(o.selectionManager.setFocused(!0),o.selectionManager.setFocusedKey(l))}}),H=C(c==null?void 0:c.props);delete H.id;let h=Se(c==null?void 0:c.props);return{optionProps:{...g,...B(H,M,T,h),id:Ee(o,l)},labelProps:{id:D},descriptionProps:{id:x},isFocused:F,isFocusVisible:F&&N(),isSelected:s,isDisabled:n,isPressed:A,allowsSelection:I,hasAction:_}}function Be(e){let{heading:o,"aria-label":i}=e,t=j();return{itemProps:{role:"presentation"},headingProps:o?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":i,"aria-labelledby":o?t:void 0}}}const G=u.createContext(null),V=u.createContext(null);function Me(e,o){[e,o]=oe(e,o,G);let i=u.useContext(te),t=u.useContext(V);return u.useContext(Y)?d.createElement(Z,e):t?i?null:d.createElement(J,{state:t,props:e,listBoxRef:o}):d.createElement(_e,{props:e,listBoxRef:o})}function _e({props:e,listBoxRef:o}){let{portal:i,collection:t}=ee(e);e={...e,collection:t,children:null,items:null};let a=pe(e);return d.createElement(d.Fragment,null,i,d.createElement(J,{state:a,props:e,listBoxRef:o}))}const to=u.forwardRef(Me);function J({state:e,props:o,listBoxRef:i}){let{dragAndDropHooks:t,layout:a="stack",orientation:l="vertical"}=o,{collection:r,selectionManager:$}=e,n=!!(t!=null&&t.useDraggableCollectionState),f=!!(t!=null&&t.useDroppableCollectionState),{direction:s}=fe(),{disabledBehavior:m,disabledKeys:b}=$,v=be({usage:"search",sensitivity:"base"}),p=u.useMemo(()=>o.keyboardDelegate||new ve({collection:r,collator:v,ref:i,disabledKeys:b,disabledBehavior:m,layout:a,orientation:l,direction:s}),[r,v,i,m,b,l,s,o.keyboardDelegate,a]),{listBoxProps:P}=Fe({...o,shouldSelectOnPressUp:n||o.shouldSelectOnPressUp,keyboardDelegate:p},e,i),k=R({items:r,children:h=>{switch(h.type){case"section":return d.createElement(Ie,{section:h});case"separator":return d.createElement(ne,h.props);case"item":return d.createElement(Q,{item:h});default:throw new Error("Unsupported node type in Menu: "+h.type)}}}),y=u.useRef(n),S=u.useRef(f);u.useEffect(()=>{y.current!==n&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),S.current!==f&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[n,f]);let D,x,g,c=!1,E=null,M=u.useRef(null);if(n&&t){D=t.useDraggableCollectionState({collection:r,selectionManager:$,preview:t.renderDragPreview?M:void 0}),t.useDraggableCollection({},D,i);let h=t.DragPreview;E=t.renderDragPreview?d.createElement(h,{ref:M},t.renderDragPreview):null}if(f&&t){x=t.useDroppableCollectionState({collection:r,selectionManager:$});let h=t.dropTargetDelegate||new t.ListDropTargetDelegate(r,i,{orientation:l,layout:a,direction:s});g=t.useDroppableCollection({keyboardDelegate:p,dropTargetDelegate:h},x,i),c=x.isDropTarget({type:"root"})}let{focusProps:A,isFocused:F,isFocusVisible:_}=xe(),I={isDropTarget:c,isEmpty:e.collection.size===0,isFocused:F,isFocusVisible:_,layout:o.layout||"stack",state:e},T=U({className:o.className,style:o.style,defaultClassName:"react-aria-ListBox",values:I}),H=null;return e.collection.size===0&&o.renderEmptyState&&(H=d.createElement("div",{role:"option",style:{display:"contents"}},o.renderEmptyState(I))),d.createElement(ke,null,d.createElement("div",{...C(o),...B(P,A,g==null?void 0:g.collectionProps),...T,ref:i,slot:o.slot||void 0,onScroll:o.onScroll,"data-drop-target":c||void 0,"data-empty":e.collection.size===0||void 0,"data-focused":F||void 0,"data-focus-visible":_||void 0,"data-layout":o.layout||"stack","data-orientation":o.orientation||"vertical"},d.createElement(K,{values:[[G,o],[V,e],[O,{dragAndDropHooks:t,dragState:D,dropState:x}],[se,{elementType:"div"}],[ie,{render:Ae}]]},k),H,E))}function Ie({section:e,className:o,style:i}){var t,a;let l=u.useContext(V),[r,$]=re();var n;let{headingProps:f,groupProps:s}=Be({heading:$,"aria-label":(n=e.props["aria-label"])!==null&&n!==void 0?n:void 0}),m=R({items:l.collection.getChildren(e.key),children:b=>{switch(b.type){case"header":return d.createElement(Ce,{item:b,headingProps:f,headingRef:r});case"item":return d.createElement(Q,{item:b});default:throw new Error("Unsupported element type in Section: "+b.type)}}});return d.createElement("section",{...C(e.props),...s,className:o||((t=e.props)===null||t===void 0?void 0:t.className)||"react-aria-Section",style:i||((a=e.props)===null||a===void 0?void 0:a.style),ref:e.props.ref},m)}function Ce({item:e,headingProps:o,headingRef:i}){let{ref:t,...a}=e.props;return d.createElement(de,{...o,...a,ref:ae(i,t)},e.rendered)}function Ve(e,o){return X("item",e,o,e.children)}const ro=u.forwardRef(Ve);function Q({item:e}){var o;let i=W(e.props.ref),t=u.useContext(V),{dragAndDropHooks:a,dragState:l,dropState:r}=u.useContext(O),{optionProps:$,labelProps:n,descriptionProps:f,...s}=He({key:e.key,"aria-label":(o=e.props)===null||o===void 0?void 0:o["aria-label"]},t,i),{hoverProps:m,isHovered:b}=q({isDisabled:!s.allowsSelection&&!s.hasAction,onHoverStart:e.props.onHoverStart,onHoverChange:e.props.onHoverChange,onHoverEnd:e.props.onHoverEnd}),v=null;l&&a&&(v=a.useDraggableItem({key:e.key},l));let p=null;r&&a&&(p=a.useDroppableItem({target:{type:"item",key:e.key,dropPosition:"on"}},r,i));let P=e.props,k=l&&l.isDragging(e.key),y=U({...P,id:void 0,children:e.rendered,defaultClassName:"react-aria-ListBoxItem",values:{...s,isHovered:b,selectionMode:t.selectionManager.selectionMode,selectionBehavior:t.selectionManager.selectionBehavior,allowsDragging:!!l,isDragging:k,isDropTarget:p==null?void 0:p.isDropTarget}}),S=(a==null?void 0:a.renderDropIndicator)||(x=>d.createElement(le,{target:x}));u.useEffect(()=>{e.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[e.textValue]);let D=P.href?"a":"div";return d.createElement(d.Fragment,null,(a==null?void 0:a.useDropIndicator)&&S({type:"item",key:e.key,dropPosition:"before"}),d.createElement(D,{...B($,m,v==null?void 0:v.dragProps,p==null?void 0:p.dropProps),...y,ref:i,"data-allows-dragging":!!l||void 0,"data-selected":s.isSelected||void 0,"data-disabled":s.isDisabled||void 0,"data-hovered":b||void 0,"data-focused":s.isFocused||void 0,"data-focus-visible":s.isFocusVisible||void 0,"data-pressed":s.isPressed||void 0,"data-dragging":k||void 0,"data-drop-target":(p==null?void 0:p.isDropTarget)||void 0,"data-selection-mode":t.selectionManager.selectionMode==="none"?void 0:t.selectionManager.selectionMode},d.createElement(K,{values:[[ce,{slots:{label:n,description:f}}]]},y.children)),(a==null?void 0:a.useDropIndicator)&&t.collection.getKeyAfter(e.key)==null&&S({type:"item",key:e.key,dropPosition:"after"}))}function Ae(e,o){o=W(o);let{dragAndDropHooks:i,dropState:t}=u.useContext(O),{dropIndicatorProps:a,isHidden:l,isDropTarget:r}=i.useDropIndicator(e,t,o);return l?null:d.createElement(Ue,{...e,dropIndicatorProps:a,isDropTarget:r,ref:o})}function Te(e,o){let{dropIndicatorProps:i,isDropTarget:t,...a}=e,l=U({...a,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return d.createElement("div",{...i,...l,role:"option",ref:o,"data-drop-target":t||void 0})}const Ue=u.forwardRef(Te);export{G as $,V as a,to as b,ro as c};
