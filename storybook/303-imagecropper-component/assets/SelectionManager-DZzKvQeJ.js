import{r as g,R as O}from"./index-Cs7sjTYM.js";import{r as de}from"./index-Cf-03bMR.js";import{$ as he}from"./FocusScope--STy3lDT.js";import{u as ye,i as ge,f as X,l as _,m as ee}from"./useFocusRing-if03xCoO.js";import{a as J}from"./index-DKTAOSvX.js";import{e as pe,a as ue,b as fe,h as me}from"./usePress-1fQJjpyE.js";import{$ as te}from"./useEvent-DPeShqXn.js";import{a as ve,b as le}from"./useCollator-lO_wuqqx.js";import{a as Ke}from"./useLocalizedStringFormatter-A1OcE67O.js";import{$ as be}from"./useDescription-BalOtq5q.js";import{$ as ie}from"./getScrollParent-CcmJp979.js";import{$ as Se}from"./useControlledState-B7K2eYzO.js";const $e=500;function xe(s){let{isDisabled:e,onLongPressStart:t,onLongPressEnd:l,onLongPress:i,threshold:n=$e,accessibilityDescription:c}=s;const f=g.useRef(void 0);let{addGlobalListener:u,removeGlobalListener:m}=pe(),{pressProps:y}=ue({isDisabled:e,onPressStart(d){if(d.continuePropagation(),(d.pointerType==="mouse"||d.pointerType==="touch")&&(t&&t({...d,type:"longpressstart"}),f.current=setTimeout(()=>{d.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),i&&i({...d,type:"longpress"}),f.current=void 0},n),d.pointerType==="touch")){let h=P=>{P.preventDefault()};u(d.target,"contextmenu",h,{once:!0}),u(window,"pointerup",()=>{setTimeout(()=>{m(d.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(d){f.current&&clearTimeout(f.current),l&&(d.pointerType==="mouse"||d.pointerType==="touch")&&l({...d,type:"longpressend"})}}),K=be(i&&!e?c:void 0);return{longPressProps:J(y,K)}}function Z(s){return ye()?s.altKey:s.ctrlKey}function V(s){return ge()?s.metaKey:s.ctrlKey}const we=1e3;function De(s){let{keyboardDelegate:e,selectionManager:t,onTypeSelect:l}=s,i=g.useRef({search:"",timeout:null}).current,n=c=>{let f=Pe(c.key);if(!f||c.ctrlKey||c.metaKey||!c.currentTarget.contains(c.target))return;f===" "&&i.search.trim().length>0&&(c.preventDefault(),"continuePropagation"in c||c.stopPropagation()),i.search+=f;let u=e.getKeyForSearch(i.search,t.focusedKey);u==null&&(u=e.getKeyForSearch(i.search)),u!=null&&(t.setFocusedKey(u),l&&l(u)),clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},we)};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?n:null}}}function Pe(s){return s.length===1||!/^[A-Z]/i.test(s)?s:""}function Ge(s){let{selectionManager:e,keyboardDelegate:t,ref:l,autoFocus:i=!1,shouldFocusWrap:n=!1,disallowEmptySelection:c=!1,disallowSelectAll:f=!1,selectOnFocus:u=e.selectionBehavior==="replace",disallowTypeAhead:m=!1,shouldUseVirtualFocus:y,allowsTabNavigation:K=!1,isVirtualized:d,scrollRef:h=l,linkBehavior:P="action"}=s,{direction:x}=Ke(),p=fe(),F=r=>{if(r.altKey&&r.key==="Tab"&&r.preventDefault(),!l.current.contains(r.target))return;const v=(a,L)=>{if(a!=null){if(e.isLink(a)&&P==="selection"&&u&&!Z(r)){de.flushSync(()=>{e.setFocusedKey(a,L)});let z=h.current.querySelector(`[data-key="${CSS.escape(a.toString())}"]`),Q=e.getItemProps(a);p.open(z,r,Q.href,Q.routerOptions);return}if(e.setFocusedKey(a,L),e.isLink(a)&&P==="override")return;r.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(a):u&&!Z(r)&&e.replaceSelection(a)}};switch(r.key){case"ArrowDown":if(t.getKeyBelow){var w,$,R;let a=e.focusedKey!=null?(w=t.getKeyBelow)===null||w===void 0?void 0:w.call(t,e.focusedKey):($=t.getFirstKey)===null||$===void 0?void 0:$.call(t);a==null&&n&&(a=(R=t.getFirstKey)===null||R===void 0?void 0:R.call(t,e.focusedKey)),a!=null&&(r.preventDefault(),v(a))}break;case"ArrowUp":if(t.getKeyAbove){var C,U,o;let a=e.focusedKey!=null?(C=t.getKeyAbove)===null||C===void 0?void 0:C.call(t,e.focusedKey):(U=t.getLastKey)===null||U===void 0?void 0:U.call(t);a==null&&n&&(a=(o=t.getLastKey)===null||o===void 0?void 0:o.call(t,e.focusedKey)),a!=null&&(r.preventDefault(),v(a))}break;case"ArrowLeft":if(t.getKeyLeftOf){var A,W,q;let a=(A=t.getKeyLeftOf)===null||A===void 0?void 0:A.call(t,e.focusedKey);a==null&&n&&(a=x==="rtl"?(W=t.getFirstKey)===null||W===void 0?void 0:W.call(t,e.focusedKey):(q=t.getLastKey)===null||q===void 0?void 0:q.call(t,e.focusedKey)),a!=null&&(r.preventDefault(),v(a,x==="rtl"?"first":"last"))}break;case"ArrowRight":if(t.getKeyRightOf){var H,G,k;let a=(H=t.getKeyRightOf)===null||H===void 0?void 0:H.call(t,e.focusedKey);a==null&&n&&(a=x==="rtl"?(G=t.getLastKey)===null||G===void 0?void 0:G.call(t,e.focusedKey):(k=t.getFirstKey)===null||k===void 0?void 0:k.call(t,e.focusedKey)),a!=null&&(r.preventDefault(),v(a,x==="rtl"?"last":"first"))}break;case"Home":if(t.getFirstKey){r.preventDefault();let a=t.getFirstKey(e.focusedKey,V(r));e.setFocusedKey(a),V(r)&&r.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(a):u&&e.replaceSelection(a)}break;case"End":if(t.getLastKey){r.preventDefault();let a=t.getLastKey(e.focusedKey,V(r));e.setFocusedKey(a),V(r)&&r.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(a):u&&e.replaceSelection(a)}break;case"PageDown":if(t.getKeyPageBelow){let a=t.getKeyPageBelow(e.focusedKey);a!=null&&(r.preventDefault(),v(a))}break;case"PageUp":if(t.getKeyPageAbove){let a=t.getKeyPageAbove(e.focusedKey);a!=null&&(r.preventDefault(),v(a))}break;case"a":V(r)&&e.selectionMode==="multiple"&&f!==!0&&(r.preventDefault(),e.selectAll());break;case"Escape":!c&&e.selectedKeys.size!==0&&(r.stopPropagation(),r.preventDefault(),e.clearSelection());break;case"Tab":if(!K){if(r.shiftKey)l.current.focus();else{let a=he(l.current,{tabbable:!0}),L,z;do z=a.lastChild(),z&&(L=z);while(z);L&&!L.contains(document.activeElement)&&ee(L)}break}}},b=g.useRef({top:0,left:0});te(h,"scroll",d?null:()=>{b.current={top:h.current.scrollTop,left:h.current.scrollLeft}});let S=r=>{if(e.isFocused){r.currentTarget.contains(r.target)||e.setFocused(!1);return}if(r.currentTarget.contains(r.target)){if(e.setFocused(!0),e.focusedKey==null){let $=C=>{C!=null&&(e.setFocusedKey(C),u&&e.replaceSelection(C))},R=r.relatedTarget;var v,w;R&&r.currentTarget.compareDocumentPosition(R)&Node.DOCUMENT_POSITION_FOLLOWING?$((v=e.lastSelectedKey)!==null&&v!==void 0?v:t.getLastKey()):$((w=e.firstSelectedKey)!==null&&w!==void 0?w:t.getFirstKey())}else d||(h.current.scrollTop=b.current.top,h.current.scrollLeft=b.current.left);if(e.focusedKey!=null){let $=h.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);$&&($.contains(document.activeElement)||ee($),_()==="keyboard"&&le($,{containingElement:l.current}))}}},I=r=>{r.currentTarget.contains(r.relatedTarget)||e.setFocused(!1)};const T=g.useRef(i);g.useEffect(()=>{if(T.current){let r=null;i==="first"&&(r=t.getFirstKey()),i==="last"&&(r=t.getLastKey());let v=e.selectedKeys;if(v.size){for(let w of v)if(e.canSelectItem(w)){r=w;break}}e.setFocused(!0),e.setFocusedKey(r),r==null&&!y&&X(l.current)}},[]);let E=g.useRef(e.focusedKey);g.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==E.current||T.current)&&(h!=null&&h.current)){let r=_(),v=l.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);if(!v)return;(r==="keyboard"||T.current)&&(ve(h.current,v),r!=="virtual"&&le(v,{containingElement:l.current}))}!y&&e.isFocused&&e.focusedKey==null&&E.current!=null&&X(l.current),E.current=e.focusedKey,T.current=!1}),te(l,"react-aria-focus-scope-restore",r=>{r.preventDefault(),e.setFocused(!0)});let M={onKeyDown:F,onFocus:S,onBlur:I,onMouseDown(r){h.current===r.target&&r.preventDefault()}},{typeSelectProps:N}=De({keyboardDelegate:t,selectionManager:e});m||(M=J(N,M));let B;return y||(B=e.focusedKey==null?0:-1),{collectionProps:{...M,tabIndex:B}}}function ke(s){let{selectionManager:e,key:t,ref:l,shouldSelectOnPressUp:i,shouldUseVirtualFocus:n,focus:c,isDisabled:f,onAction:u,allowsDifferentPressOrigin:m,linkBehavior:y="action"}=s,K=fe(),d=o=>{if(o.pointerType==="keyboard"&&Z(o))e.toggleSelection(t);else{if(e.selectionMode==="none")return;if(e.isLink(t)){if(y==="selection"){let A=e.getItemProps(t);K.open(l.current,o,A.href,A.routerOptions),e.setSelectedKeys(e.selectedKeys);return}else if(y==="override"||y==="none")return}e.selectionMode==="single"?e.isSelected(t)&&!e.disallowEmptySelection?e.toggleSelection(t):e.replaceSelection(t):o&&o.shiftKey?e.extendSelection(t):e.selectionBehavior==="toggle"||o&&(V(o)||o.pointerType==="touch"||o.pointerType==="virtual")?e.toggleSelection(t):e.replaceSelection(t)}};g.useEffect(()=>{t===e.focusedKey&&e.isFocused&&!n&&(c?c():document.activeElement!==l.current&&X(l.current))},[l,t,e.focusedKey,e.childFocusStrategy,e.isFocused,n]),f=f||e.isDisabled(t);let h={};!n&&!f?h={tabIndex:t===e.focusedKey?0:-1,onFocus(o){o.target===l.current&&e.setFocusedKey(t)}}:f&&(h.onMouseDown=o=>{o.preventDefault()});let P=e.isLink(t)&&y==="override",x=e.isLink(t)&&y!=="selection"&&y!=="none",p=!f&&e.canSelectItem(t)&&!P,F=(u||x)&&!f,b=F&&(e.selectionBehavior==="replace"?!p:!p||e.isEmpty),S=F&&p&&e.selectionBehavior==="replace",I=b||S,T=g.useRef(null),E=I&&p,M=g.useRef(!1),N=g.useRef(!1),B=o=>{if(u&&u(),x){let A=e.getItemProps(t);K.open(l.current,o,A.href,A.routerOptions)}},r={};i?(r.onPressStart=o=>{T.current=o.pointerType,M.current=E,o.pointerType==="keyboard"&&(!I||ne())&&d(o)},m?(r.onPressUp=b?null:o=>{o.pointerType!=="keyboard"&&p&&d(o)},r.onPress=b?B:null):r.onPress=o=>{if(b||S&&o.pointerType!=="mouse"){if(o.pointerType==="keyboard"&&!se())return;B(o)}else o.pointerType!=="keyboard"&&p&&d(o)}):(r.onPressStart=o=>{T.current=o.pointerType,M.current=E,N.current=b,p&&(o.pointerType==="mouse"&&!b||o.pointerType==="keyboard"&&(!F||ne()))&&d(o)},r.onPress=o=>{(o.pointerType==="touch"||o.pointerType==="pen"||o.pointerType==="virtual"||o.pointerType==="keyboard"&&I&&se()||o.pointerType==="mouse"&&N.current)&&(I?B(o):p&&d(o))}),h["data-key"]=t,r.preventFocusOnPress=n;let{pressProps:v,isPressed:w}=ue(r),$=S?o=>{T.current==="mouse"&&(o.stopPropagation(),o.preventDefault(),B(o))}:void 0,{longPressProps:R}=xe({isDisabled:!E,onLongPress(o){o.pointerType==="touch"&&(d(o),e.setSelectionBehavior("toggle"))}}),C=o=>{T.current==="touch"&&M.current&&o.preventDefault()},U=e.isLink(t)?o=>{me.isOpening||o.preventDefault()}:void 0;return{itemProps:J(h,p||b?v:{},E?R:{},{onDoubleClick:$,onDragStartCapture:C,onClick:U}),isPressed:w,isSelected:e.isSelected(t),isFocused:e.isFocused&&e.focusedKey===t,isDisabled:f,allowsSelection:p,hasAction:I}}function se(){let s=window.event;return(s==null?void 0:s.key)==="Enter"}function ne(){let s=window.event;return(s==null?void 0:s.key)===" "||(s==null?void 0:s.code)==="Space"}class re{getItemRect(e){let t=this.ref.current,l=e!=null?t.querySelector(`[data-key="${CSS.escape(e.toString())}"]`):null;if(!l)return null;let i=t.getBoundingClientRect(),n=l.getBoundingClientRect();return{x:n.left-i.left+t.scrollLeft,y:n.top-i.top+t.scrollTop,width:n.width,height:n.height}}getContentSize(){let e=this.ref.current;return{width:e.scrollWidth,height:e.scrollHeight}}getVisibleRect(){let e=this.ref.current;return{x:e.scrollLeft,y:e.scrollTop,width:e.offsetWidth,height:e.offsetHeight}}constructor(e){this.ref=e}}class Ye{isDisabled(e){var t;return this.disabledBehavior==="all"&&(((t=e.props)===null||t===void 0?void 0:t.isDisabled)||this.disabledKeys.has(e.key))}findNextNonDisabled(e,t){for(;e!=null;){let l=this.collection.getItem(e);if((l==null?void 0:l.type)==="item"&&!this.isDisabled(l))return e;e=t(e)}return null}getNextKey(e){return e=this.collection.getKeyAfter(e),this.findNextNonDisabled(e,t=>this.collection.getKeyAfter(t))}getPreviousKey(e){return e=this.collection.getKeyBefore(e),this.findNextNonDisabled(e,t=>this.collection.getKeyBefore(t))}findKey(e,t,l){let i=this.layoutDelegate.getItemRect(e);if(!i)return null;let n=i;do e=t(e),i=this.layoutDelegate.getItemRect(e);while(i&&l(n,i));return e}isSameRow(e,t){return e.y===t.y||e.x!==t.x}isSameColumn(e,t){return e.x===t.x||e.y!==t.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getNextKey(t),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getPreviousKey(t),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,t){return t?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let t=this.direction==="ltr"?"getKeyRightOf":"getKeyLeftOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,l=>this.layoutDelegate[t](l))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,l=>this.getNextColumn(l,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){let t=this.direction==="ltr"?"getKeyLeftOf":"getKeyRightOf";return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,l=>this.layoutDelegate[t](l))):this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,l=>this.getNextColumn(l,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyAfter(t))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,t=>this.collection.getKeyBefore(t))}getKeyPageAbove(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(!ie(t))return this.getFirstKey();if(this.orientation==="horizontal"){let i=Math.max(0,l.x+l.width-this.layoutDelegate.getVisibleRect().width);for(;l&&l.x>i;)e=this.getKeyAbove(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}else{let i=Math.max(0,l.y+l.height-this.layoutDelegate.getVisibleRect().height);for(;l&&l.y>i;)e=this.getKeyAbove(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}return e??this.getFirstKey()}getKeyPageBelow(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(!ie(t))return this.getLastKey();if(this.orientation==="horizontal"){let i=Math.min(this.layoutDelegate.getContentSize().width,l.y-l.width+this.layoutDelegate.getVisibleRect().width);for(;l&&l.x<i;)e=this.getKeyBelow(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}else{let i=Math.min(this.layoutDelegate.getContentSize().height,l.y-l.height+this.layoutDelegate.getVisibleRect().height);for(;l&&l.y<i;)e=this.getKeyBelow(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}return e??this.getLastKey()}getKeyForSearch(e,t){if(!this.collator)return null;let l=this.collection,i=t||this.getFirstKey();for(;i!=null;){let n=l.getItem(i),c=n.textValue.slice(0,e.length);if(n.textValue&&this.collator.compare(c,e)===0)return i;i=this.getNextKey(i)}return null}constructor(...e){if(e.length===1){let t=e[0];this.collection=t.collection,this.ref=t.ref,this.collator=t.collator,this.disabledKeys=t.disabledKeys||new Set,this.disabledBehavior=t.disabledBehavior||"all",this.orientation=t.orientation||"vertical",this.direction=t.direction,this.layout=t.layout||"stack",this.layoutDelegate=t.layoutDelegate||new re(t.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new re(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}class Fe{build(e,t){return this.context=t,oe(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:l}=e;if(O.isValidElement(t)&&t.type===O.Fragment)yield*this.iterateCollection({children:t.props.children,items:l});else if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");for(let i of e.items)yield*this.getFullNode({value:i},{renderer:t})}else{let i=[];O.Children.forEach(t,c=>{i.push(c)});let n=0;for(let c of i){let f=this.getFullNode({element:c,index:n},{});for(let u of f)n++,yield u}}}getKey(e,t,l,i){if(e.key!=null)return e.key;if(t.type==="cell"&&t.key!=null)return`${i}${t.key}`;let n=t.value;if(n!=null){var c;let f=(c=n.key)!==null&&c!==void 0?c:n.id;if(f==null)throw new Error("No key found for item");return f}return i?`${i}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,l,i){if(O.isValidElement(e.element)&&e.element.type===O.Fragment){let u=[];O.Children.forEach(e.element.props.children,y=>{u.push(y)});let m=e.index;for(const y of u)yield*this.getFullNode({element:y,index:m++},t,l,i);return}let n=e.element;if(!n&&e.value&&t&&t.renderer){let u=this.cache.get(e.value);if(u&&(!u.shouldInvalidate||!u.shouldInvalidate(this.context))){u.index=e.index,u.parentKey=i?i.key:null,yield u;return}n=t.renderer(e.value)}if(O.isValidElement(n)){let u=n.type;if(typeof u!="function"&&typeof u.getCollectionNode!="function"){let d=typeof n.type=="function"?n.type.name:n.type;throw new Error(`Unknown element <${d}> in collection.`)}let m=u.getCollectionNode(n.props,this.context),y=e.index,K=m.next();for(;!K.done&&K.value;){let d=K.value;e.index=y;let h=d.key;h||(h=d.element?null:this.getKey(n,e,t,l));let x=[...this.getFullNode({...d,key:h,index:y,wrapper:Ie(e.wrapper,d.wrapper)},this.getChildState(t,d),l?`${l}${n.key}`:n.key,i)];for(let p of x){if(p.value=d.value||e.value,p.value&&this.cache.set(p.value,p),e.type&&p.type!==e.type)throw new Error(`Unsupported type <${Y(p.type)}> in <${Y(i.type)}>. Only <${Y(e.type)}> is supported.`);y++,yield p}K=m.next(x)}return}if(e.key==null)return;let c=this,f={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:e.value,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:oe(function*(){if(!e.hasChildNodes)return;let u=0;for(let m of e.childNodes()){m.key!=null&&(m.key=`${f.key}${m.key}`),m.index=u;let y=c.getFullNode(m,c.getChildState(t,m),f.key,f);for(let K of y)u++,yield K}})};yield f}constructor(){this.cache=new WeakMap}}function oe(s){let e=[],t=null;return{*[Symbol.iterator](){for(let l of e)yield l;t||(t=s());for(let l of t)e.push(l),yield l}}}function Ie(s,e){if(s&&e)return t=>s(e(t));if(s)return s;if(e)return e}function Y(s){return s[0].toUpperCase()+s.slice(1)}function je(s,e,t){let l=g.useMemo(()=>new Fe,[]),{children:i,items:n,collection:c}=s;return g.useMemo(()=>{if(c)return c;let u=l.build({children:i,items:n},t);return e(u)},[l,i,n,c,t,e])}function Te(s,e){return typeof e.getChildren=="function"?e.getChildren(s.key):s.childNodes}function Re(s){return Ce(s,0)}function Ce(s,e){if(e<0)return;let t=0;for(let l of s){if(t===e)return l;t++}}function Xe(s){let e;for(let t of s)e=t;return e}function j(s,e,t){if(e.parentKey===t.parentKey)return e.index-t.index;let l=[...ce(s,e),e],i=[...ce(s,t),t],n=l.slice(0,i.length).findIndex((c,f)=>c!==i[f]);return n!==-1?(e=l[n],t=i[n],e.index-t.index):l.findIndex(c=>c===t)>=0?1:(i.findIndex(c=>c===e)>=0,-1)}function ce(s,e){let t=[];for(;(e==null?void 0:e.parentKey)!=null;)e=s.getItem(e.parentKey),t.unshift(e);return t}class D extends Set{constructor(e,t,l){super(e),e instanceof D?(this.anchorKey=t??e.anchorKey,this.currentKey=l??e.currentKey):(this.anchorKey=t,this.currentKey=l)}}function Ae(s,e){if(s.size!==e.size)return!1;for(let t of s)if(!e.has(t))return!1;return!0}function Ze(s){let{selectionMode:e="none",disallowEmptySelection:t,allowDuplicateSelectionEvents:l,selectionBehavior:i="toggle",disabledBehavior:n="all"}=s,c=g.useRef(!1),[,f]=g.useState(!1),u=g.useRef(null),m=g.useRef(null),[,y]=g.useState(null),K=g.useMemo(()=>ae(s.selectedKeys),[s.selectedKeys]),d=g.useMemo(()=>ae(s.defaultSelectedKeys,new D),[s.defaultSelectedKeys]),[h,P]=Se(K,d,s.onSelectionChange),x=g.useMemo(()=>s.disabledKeys?new Set(s.disabledKeys):new Set,[s.disabledKeys]),[p,F]=g.useState(i);i==="replace"&&p==="toggle"&&typeof h=="object"&&h.size===0&&F("replace");let b=g.useRef(i);return g.useEffect(()=>{i!==b.current&&(F(i),b.current=i)},[i]),{selectionMode:e,disallowEmptySelection:t,selectionBehavior:p,setSelectionBehavior:F,get isFocused(){return c.current},setFocused(S){c.current=S,f(S)},get focusedKey(){return u.current},get childFocusStrategy(){return m.current},setFocusedKey(S,I="first"){u.current=S,m.current=I,y(S)},selectedKeys:h,setSelectedKeys(S){(l||!Ae(S,h))&&P(S)},disabledKeys:x,disabledBehavior:n}}function ae(s,e){return s?s==="all"?"all":new D(s):e}class Je{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){return this.state.selectionMode==="none"?!1:(e=this.getKey(e),this.state.selectedKeys==="all"?this.canSelectItem(e):this.state.selectedKeys.has(e))}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(l=>t.has(l)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!e||l&&j(this.collection,l,e)<0)&&(e=l)}return e==null?void 0:e.key}get lastSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!e||l&&j(this.collection,l,e)>0)&&(e=l)}return e==null?void 0:e.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}e=this.getKey(e);let t;if(this.state.selectedKeys==="all")t=new D([e],e,e);else{let n=this.state.selectedKeys;var l;let c=(l=n.anchorKey)!==null&&l!==void 0?l:e;t=new D(n,c,e);var i;for(let f of this.getKeyRange(c,(i=n.currentKey)!==null&&i!==void 0?i:e))t.delete(f);for(let f of this.getKeyRange(e,c))this.canSelectItem(f)&&t.add(f)}this.state.setSelectedKeys(t)}getKeyRange(e,t){let l=this.collection.getItem(e),i=this.collection.getItem(t);return l&&i?j(this.collection,l,i)<=0?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){var l;if(!((l=this.layoutDelegate)===null||l===void 0)&&l.getKeyRange)return this.layoutDelegate.getKeyRange(e,t);let i=[],n=e;for(;n!=null;){let c=this.collection.getItem(n);if((c&&c.type==="item"||c.type==="cell"&&this.allowsCellSelection)&&i.push(n),n===t)return i;n=this.collection.getKeyAfter(n)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||t.type==="cell"&&this.allowsCellSelection)return e;for(;t.type!=="item"&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!=="item"?null:t.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}if(e=this.getKey(e),e==null)return;let t=new D(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);t.has(e)?t.delete(e):this.canSelectItem(e)&&(t.add(e),t.anchorKey=e,t.currentKey=e),!(this.disallowEmptySelection&&t.size===0)&&this.state.setSelectedKeys(t)}replaceSelection(e){if(this.selectionMode==="none"||(e=this.getKey(e),e==null))return;let t=this.canSelectItem(e)?new D([e],e,e):new D;this.state.setSelectedKeys(t)}setSelectedKeys(e){if(this.selectionMode==="none")return;let t=new D;for(let l of e)if(l=this.getKey(l),l!=null&&(t.add(l),this.selectionMode==="single"))break;this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=l=>{for(;l!=null;){if(this.canSelectItem(l)){let i=this.collection.getItem(l);i.type==="item"&&e.push(l),i.hasChildNodes&&(this.allowsCellSelection||i.type!=="item")&&t(Re(Te(i,this.collection)).key)}l=this.collection.getKeyAfter(l)}};return t(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new D)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||t&&(t.pointerType==="touch"||t.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let l of e)if(!t.has(l))return!1;for(let l of t)if(!e.has(l))return!1;return!0}canSelectItem(e){var t;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let l=this.collection.getItem(e);return!(!l||!(l==null||(t=l.props)===null||t===void 0)&&t.isDisabled||l.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var t,l;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.isDisabled))}isLink(e){var t,l;return!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.href)}getItemProps(e){var t;return(t=this.collection.getItem(e))===null||t===void 0?void 0:t.props}constructor(e,t,l){this.collection=e,this.state=t;var i;this.allowsCellSelection=(i=l==null?void 0:l.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null,this.layoutDelegate=(l==null?void 0:l.layoutDelegate)||null}}export{Ze as $,je as a,Je as b,ke as c,Ye as d,De as e,Ge as f,Te as g,xe as h,Ce as i,Xe as j,Re as k,re as l};
