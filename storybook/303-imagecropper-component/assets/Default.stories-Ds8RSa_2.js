var y=Object.defineProperty;var R=(t,e,r)=>e in t?y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var I=(t,e,r)=>R(t,typeof e!="symbol"?e+"":e,r);import{r as i,R as s}from"./index-uCp2LrAq.js";import{a as x,F}from"./FileController-BavFnD70.js";import{I as q}from"./ImageCropper-DajnaLpK.js";import{c as L}from"./clsx-B-dksMZM.js";import{m as T,o as Z,b as _}from"./flowComponent-d9koHm8X.js";import{u as k}from"./useSelector-BUIORffs.js";import{L as O}from"./Link-CFfN6dAc.js";import{S as z}from"./Section-C8kIh9p2.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Button-CKjWx2QM.js";import"./PropsContextProvider-DJl9unei.js";import"./index-CqLFpzzG.js";import"./IconApp-08dtyhav.js";import"./IconWarning--xZ87BQk.js";import"./Wrap-DQq6jo70.js";import"./Text-CzfDsx2u.js";import"./EmulatedBoldText-DzNCZpDp.js";import"./Text-BxG67LRB.js";import"./utils-CRveUs4Q.js";import"./index-BOkhicXD.js";import"./LoadingSpinner-DBUWTLW8.js";import"./useLocalizedStringFormatter-CPyIEVee.js";import"./Button-B6RNnFE-.js";import"./filterDOMProps-CeZl_uWj.js";import"./useFocusable-DIY1EfD0.js";import"./usePress-B-418flx.js";import"./intlStrings-ZMTSFH_M.js";import"./useLabels-CrvI0Xse.js";import"./FocusScope-DRFNwxZB.js";import"./useDescription-DkXZ8A7g.js";import"./VisuallyHidden-BwH5wu93.js";import"./Input-CR20gog_.js";import"./PressResponder-CvugjgZN.js";import"./tslib.es6-CwyXKlH1.js";import"./Slider-C0d6X_7e.js";import"./Label-B6vS7Cqe.js";import"./useNumberFormatter-B6MG36v4.js";import"./useControlledState-B8AA3oOY.js";import"./number-nHrFdSb-.js";import"./useLabel-C-G_TB0Q.js";import"./useFormReset-D51lDO-b.js";import"./Activity-DYbiBj6P.js";import"./Collection-AT6m4EFM.js";import"./Header-hOCBwC_K.js";const j="flow--image-upload",A="flow--image-upload--file-drop-zone",B="flow--image-upload--canvas",g={imageUpload:j,fileDropZone:A,canvas:B},w=t=>{const{canvasController:e,width:r=300,height:o=200,cropShape:n,className:p}=t,[a,l]=i.useState(),[d,N]=i.useState(),h=x.useNew(),m=h.useFiles()[0],v=new FileReader,f=i.useRef(null),b=L(g.imageUpload,p);return i.useEffect(()=>{m&&(v.onload=c=>{c.target&&typeof c.target.result=="string"&&l(c.target.result)},v.readAsDataURL(m))},[m]),i.useEffect(()=>{f.current&&a&&d&&e.drawImage(f.current,a,d,r,o)},[a,d]),s.createElement("div",{className:b},!m&&s.createElement(F,{className:g.fileDropZone,controller:h}),m&&s.createElement(q,{cropShape:n,aspect:r/o,image:a,onCropComplete:(c,S)=>{N(S)}}),s.createElement("canvas",{className:g.canvas,ref:f,width:r,height:o}))};w.__docgenInfo={description:"",methods:[],displayName:"ImageUpload",props:{className:{required:!1,tsType:{name:"string"},description:""},canvasController:{required:!0,tsType:{name:"CanvasController"},description:""},width:{required:!1,tsType:{name:"number"},description:""},height:{required:!1,tsType:{name:"number"},description:""}},composes:["Pick"]};class C{constructor(){I(this,"url");T(this,{url:Z,drawImage:_.bound})}static useNew(){return i.useRef(new C).current}drawImage(e,r,o,n,p){const a=e.getContext("2d"),l=new Image(n,p);l.src=r,a&&(a.drawImage(l,o.x,o.y,o.width,o.height,0,0,n,p),this.url=a.canvas.toDataURL("image/png"))}useUrl(){return k(()=>this.url)}}const Ze={title:"Upload/ImageUpload",component:w,render:t=>{const e=C.useNew(),r=e.useUrl();return s.createElement(z,null,s.createElement(w,{...t,canvasController:e}),s.createElement(O,{href:r,isDisabled:!r,download:!0},"Download cropped image"))}},u={};var E,U,D;u.parameters={...u.parameters,docs:{...(E=u.parameters)==null?void 0:E.docs,source:{originalSource:"{}",...(D=(U=u.parameters)==null?void 0:U.docs)==null?void 0:D.source}}};const _e=["Default"];export{u as Default,_e as __namedExportsOrder,Ze as default};
