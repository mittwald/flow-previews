var D=Object.defineProperty;var F=(a,e,r)=>e in a?D(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r;var n=(a,e,r)=>F(a,typeof e!="symbol"?e+"":e,r);import{r as u,R as o}from"./index-BwDkhjyp.js";import{F as L}from"./FileDropZone-CspB1vVd.js";import{I as T}from"./ImageCropper-CISCSspH.js";import{c as q}from"./clsx-B-dksMZM.js";import{B as Z}from"./Button-CGYujOOx.js";import"./IconApp-C-B10zNi.js";import{j as _}from"./IconWarning-D08KcEGW.js";import{u as $}from"./useFileController-BcnHklDd.js";import{a as B}from"./useLocalizedStringFormatter-BgjAeG81.js";import{m as j,o as f,b as z}from"./flowComponent-pf1ZT_RA.js";import{u as h}from"./useSelector-Pyc-engy.js";import{S as O}from"./Section-DhcKGvwf.js";import{L as P}from"./LabeledValue-CRikwZpb.js";import{L as k}from"./Label-DqyDhkXf.js";import{I as V}from"./Image-DUsAPYFe.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Text-OHQxmlAI.js";import"./PropsContextProvider-DR_AoDrQ.js";import"./index-D1Z7wIYD.js";import"./EmulatedBoldText-B1t6hs5E.js";import"./Wrap-DQq6jo70.js";import"./Text-YaHrFsZr.js";import"./utils-_0I8Kdxf.js";import"./index-B8XB3FuZ.js";import"./intlStrings-ZMTSFH_M.js";import"./filterDOMProps-CeZl_uWj.js";import"./useLabels-h5MY4Xo1.js";import"./FocusScope-h9apr_hQ.js";import"./useFocusable-Di1f8vLw.js";import"./useDescription-CvuWAMaA.js";import"./Button-j9P20aTv.js";import"./usePress-CipJ8IEr.js";import"./VisuallyHidden-CctDujdB.js";import"./tslib.es6-CwyXKlH1.js";import"./Slider-BQ0LG3BC.js";import"./Label-BbJlieEf.js";import"./useNumberFormatter-zlIxl0ha.js";import"./useControlledState-C0C-dzuH.js";import"./number-nHrFdSb-.js";import"./useLabel-Dy08JOVD.js";import"./useFormReset-CqSSSrN8.js";import"./LoadingSpinner-BjsJqdEZ.js";import"./Input-Bxlqy7dR.js";import"./PressResponder-CS6YBkA6.js";import"./Activity-DsHdYeGi.js";import"./ContextMenu.module-CAjBRoKS.js";import"./Collection-BUjDbYEY.js";import"./Header-CClMDSoE.js";const W="flow--image-upload",G="flow--image-upload--file-drop-zone",H="flow--image-upload--image-cropper-container",J="flow--image-upload--canvas",c={imageUpload:W,fileDropZone:G,imageCropperContainer:H,canvas:J},K={"de-DE":{"imageUpload.remove":"Bild entfernen"},"en-EN":{"imageUpload.remove":"Remove image"}},C=a=>{const{controller:e,cropShape:r,width:t=300,height:s=r==="round"?300:200,className:i}=a,g=$(),p=g.useFiles(),E=e.useImageSrc(),y=e.useCroppedArea(),m=u.useRef(null),N=q(c.imageUpload,i),x=B(K);return u.useEffect(()=>{e.setImageSrc(p)},[p]),u.useEffect(()=>{m.current&&e.drawImage(m.current,t,s)},[E,y]),o.createElement("div",{className:N},p.length===0&&o.createElement(L,{className:c.fileDropZone,controller:g,acceptedFileTypes:["image/png","image/jpeg"]}),p.length>0&&o.createElement("div",{className:c.imageCropperContainer},o.createElement(T,{cropShape:r,aspect:t/s,image:E,onCropComplete:(Q,R)=>{e.setCroppedArea(R)}}),o.createElement(Z,{color:"secondary",variant:"plain","aria-label":x.format("imageUpload.remove"),size:"s",onPress:()=>{g.clear(),e.clearCanvas(m.current)}},o.createElement(_,null))),o.createElement("canvas",{className:c.canvas,ref:m,width:t,height:s}))};C.__docgenInfo={description:"",methods:[],displayName:"ImageUpload",props:{className:{required:!1,tsType:{name:"string"},description:""},controller:{required:!0,tsType:{name:"ImageUploadController"},description:""},width:{required:!1,tsType:{name:"number"},description:""},height:{required:!1,tsType:{name:"number"},description:""}},composes:["Partial"]};class S{constructor(){n(this,"url");n(this,"imageSrc");n(this,"croppedArea");j(this,{url:f,imageSrc:f,croppedArea:f,drawImage:z.bound})}static useNew(){return u.useRef(new S).current}drawImage(e,r,t){const s=e.getContext("2d"),i=new Image(r,t);this.imageSrc&&(i.src=this.imageSrc),s&&this.croppedArea&&(s.drawImage(i,this.croppedArea.x,this.croppedArea.y,this.croppedArea.width,this.croppedArea.height,0,0,r,t),this.url=s.canvas.toDataURL("image/png"))}useUrl(){return h(()=>this.url)}useImageSrc(){return h(()=>this.imageSrc)}useCroppedArea(){return h(()=>this.croppedArea)}setImageSrc(e){const r=new FileReader;e.length>0&&(r.onload=t=>{t.target&&typeof t.target.result=="string"&&(this.imageSrc=t.target.result)},r.readAsDataURL(e[0]))}setCroppedArea(e){this.croppedArea=e}clearCanvas(e){if(e){const r=e.getContext("2d");r&&r.reset(),this.url=void 0}}}const M=()=>S.useNew(),He={title:"Upload/image-upload",component:C,parameters:{controls:{exclude:["className","controller"]}},argTypes:{cropShape:{control:"inline-radio",options:["rect","round"]},width:{control:"number"},height:{control:"number"}},render:a=>{const e=M(),r=e.useUrl();return o.createElement(O,null,o.createElement(C,{...a,controller:e}),r&&o.createElement(P,null,o.createElement(k,null,"Ergebnis"),o.createElement(V,{src:r,style:{width:"contentWidth"}})))}},l={},d={args:{cropShape:"round"}};var I,b,w;l.parameters={...l.parameters,docs:{...(I=l.parameters)==null?void 0:I.docs,source:{originalSource:"{}",...(w=(b=l.parameters)==null?void 0:b.docs)==null?void 0:w.source}}};var v,A,U;d.parameters={...d.parameters,docs:{...(v=d.parameters)==null?void 0:v.docs,source:{originalSource:`{
  args: {
    cropShape: "round"
  }
}`,...(U=(A=d.parameters)==null?void 0:A.docs)==null?void 0:U.source}}};const Je=["Default","RoundCropShape"];export{l as Default,d as RoundCropShape,Je as __namedExportsOrder,He as default};
