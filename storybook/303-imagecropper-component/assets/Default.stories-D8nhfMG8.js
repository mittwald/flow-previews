var T=Object.defineProperty;var q=(o,e,r)=>e in o?T(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var C=(o,e,r)=>q(o,typeof e!="symbol"?e+"":e,r);import{r as m,R as s}from"./index-uCp2LrAq.js";import{F as L}from"./FileDropZone-8cUAKrav.js";import{F as Z}from"./FileController-D2Ef-lyc.js";import{I as _}from"./ImageCropper-CsqvDufv.js";import{c as k}from"./clsx-B-dksMZM.js";import{m as O,o as j,b as z}from"./flowComponent-d9koHm8X.js";import{u as A}from"./useSelector-BUIORffs.js";import{L as B}from"./Link-CFfN6dAc.js";import{S as G}from"./Section-C8kIh9p2.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Button-CKjWx2QM.js";import"./PropsContextProvider-DJl9unei.js";import"./index-CqLFpzzG.js";import"./IconApp-08dtyhav.js";import"./IconWarning--xZ87BQk.js";import"./Wrap-DQq6jo70.js";import"./Text-CzfDsx2u.js";import"./EmulatedBoldText-DzNCZpDp.js";import"./Text-BxG67LRB.js";import"./utils-CRveUs4Q.js";import"./index-BOkhicXD.js";import"./LoadingSpinner-DBUWTLW8.js";import"./useLocalizedStringFormatter-CPyIEVee.js";import"./Button-B6RNnFE-.js";import"./filterDOMProps-CeZl_uWj.js";import"./useFocusable-DIY1EfD0.js";import"./usePress-B-418flx.js";import"./intlStrings-ZMTSFH_M.js";import"./useLabels-CrvI0Xse.js";import"./FocusScope-DRFNwxZB.js";import"./useDescription-DkXZ8A7g.js";import"./VisuallyHidden-BwH5wu93.js";import"./Input-CR20gog_.js";import"./PressResponder-CvugjgZN.js";import"./tslib.es6-CwyXKlH1.js";import"./Slider-C0d6X_7e.js";import"./Label-B6vS7Cqe.js";import"./useNumberFormatter-B6MG36v4.js";import"./useControlledState-B8AA3oOY.js";import"./number-nHrFdSb-.js";import"./useLabel-C-G_TB0Q.js";import"./useFormReset-D51lDO-b.js";import"./Activity-DYbiBj6P.js";import"./Collection-AT6m4EFM.js";import"./Header-hOCBwC_K.js";const H="flow--image-upload",J="flow--image-upload--file-drop-zone",K="flow--image-upload--canvas",h={imageUpload:H,fileDropZone:J,canvas:K},w=o=>{const{controller:e,cropShape:r,width:t=300,height:i=r==="round"?300:200,className:p}=o,[a,c]=m.useState(),[g,v]=m.useState(),I=Z.useNew(),n=I.useFiles()[0],b=new FileReader,f=m.useRef(null),x=k(h.imageUpload,p);return m.useEffect(()=>{n&&(b.onload=l=>{l.target&&typeof l.target.result=="string"&&c(l.target.result)},b.readAsDataURL(n))},[n]),m.useEffect(()=>{f.current&&a&&g&&e.drawImage(f.current,a,g,t,i)},[a,g]),s.createElement("div",{className:x},!n&&s.createElement(L,{className:h.fileDropZone,controller:I,acceptedFileTypes:["image/png","image/jpeg"]}),n&&s.createElement(_,{cropShape:r,aspect:t/i,image:a,onCropComplete:(l,F)=>{v(F)}}),s.createElement("canvas",{className:h.canvas,ref:f,width:t,height:i}))};w.__docgenInfo={description:"",methods:[],displayName:"ImageUpload",props:{className:{required:!1,tsType:{name:"string"},description:""},controller:{required:!0,tsType:{name:"ImageUploadController"},description:""},width:{required:!1,tsType:{name:"number"},description:""},height:{required:!1,tsType:{name:"number"},description:""}},composes:["Pick"]};class S{constructor(){C(this,"url");O(this,{url:j,drawImage:z.bound})}static useNew(){return m.useRef(new S).current}drawImage(e,r,t,i,p){const a=e.getContext("2d"),c=new Image(i,p);c.src=r,a&&(a.drawImage(c,t.x,t.y,t.width,t.height,0,0,i,p),this.url=a.canvas.toDataURL("image/png"))}useUrl(){return A(()=>this.url)}}const ze={title:"Upload/image-upload",component:w,parameters:{controls:{exclude:["className","controller"]}},argTypes:{cropShape:{control:"inline-radio",options:["rect","round"]},width:{control:"number"},height:{control:"number"}},render:o=>{const e=S.useNew(),r=e.useUrl();return s.createElement(G,null,s.createElement(w,{...o,controller:e}),s.createElement(B,{href:r,isDisabled:!r,download:!0},"Download cropped image"))}},u={},d={args:{cropShape:"round"}};var E,N,U;u.parameters={...u.parameters,docs:{...(E=u.parameters)==null?void 0:E.docs,source:{originalSource:"{}",...(U=(N=u.parameters)==null?void 0:N.docs)==null?void 0:U.source}}};var y,D,R;d.parameters={...d.parameters,docs:{...(y=d.parameters)==null?void 0:y.docs,source:{originalSource:`{
  args: {
    cropShape: "round"
  }
}`,...(R=(D=d.parameters)==null?void 0:D.docs)==null?void 0:R.source}}};const Ae=["Default","RoundCropShape"];export{u as Default,d as RoundCropShape,Ae as __namedExportsOrder,ze as default};
