var D=Object.defineProperty;var F=(a,e,r)=>e in a?D(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r;var n=(a,e,r)=>F(a,typeof e!="symbol"?e+"":e,r);import{r as u,R as o}from"./index-Cs7sjTYM.js";import{F as L}from"./FileDropZone-Desw5ZB-.js";import{I as T}from"./ImageCropper-GaQscDbK.js";import{c as q}from"./clsx-B-dksMZM.js";import{B as Z}from"./Button-BNaSPzM2.js";import"./IconApp-BUZKcXPP.js";import{j as _}from"./IconWarning-BHhVudlO.js";import{u as $}from"./useFileController-B0rp0Ebf.js";import{a as B}from"./useLocalizedStringFormatter-Ccpl5Mb8.js";import{m as j,o as f,b as z}from"./flowComponent-S4fYrZHa.js";import{u as h}from"./useSelector-CuLBdmz2.js";import{S as O}from"./Section-CLAa2zTx.js";import{L as P}from"./LabeledValue-BMZtnonS.js";import{L as k}from"./Label-C-YBza_T.js";import{I as V}from"./Image-AFu_KPhI.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Text-DabHCseC.js";import"./PropsContextProvider-C-7PaZ52.js";import"./index-Dy0c0dcE.js";import"./EmulatedBoldText-Dmze-Iwg.js";import"./Wrap-DQq6jo70.js";import"./Text-Dh5WnJTs.js";import"./utils-Cy-A-nlV.js";import"./index-BMdlDBjA.js";import"./intlStrings-ZMTSFH_M.js";import"./filterDOMProps-CeZl_uWj.js";import"./useLabels-n83dATVM.js";import"./FocusScope-67rE8EpU.js";import"./useFocusable-OFlS-6qe.js";import"./useDescription-BDysBDpW.js";import"./Button-DrQgql3X.js";import"./usePress-CTrgc7uI.js";import"./VisuallyHidden-D76woJCP.js";import"./Slider-BvnHw8Li.js";import"./Label-8PgMpAzA.js";import"./useNumberFormatter-CckdFgkV.js";import"./useControlledState-B7K2eYzO.js";import"./number-nHrFdSb-.js";import"./useLabel-B-9ggeSA.js";import"./useFormReset-DRCqKyTt.js";import"./LoadingSpinner-JoUWEwvb.js";import"./Input-B2XFbQTW.js";import"./PressResponder-COi_Rbo6.js";import"./Activity-Bj6QwKZx.js";import"./ContextMenu.module-68N5lvfm.js";import"./Collection-DR5xXegF.js";import"./Header-CXhviMrv.js";const W="flow--image-upload",G="flow--image-upload--file-drop-zone",H="flow--image-upload--image-cropper-container",J="flow--image-upload--canvas",c={imageUpload:W,fileDropZone:G,imageCropperContainer:H,canvas:J},K={"de-DE":{"imageUpload.remove":"Bild entfernen"},"en-EN":{"imageUpload.remove":"Remove image"}},C=a=>{const{controller:e,cropShape:r,width:t=300,height:s=r==="round"?300:200,className:i}=a,g=$(),p=g.useFiles(),I=e.useImageSrc(),y=e.useCroppedArea(),m=u.useRef(null),N=q(c.imageUpload,i),x=B(K);return u.useEffect(()=>{e.setImageSrc(p)},[p]),u.useEffect(()=>{m.current&&e.drawImage(m.current,t,s)},[I,y]),o.createElement("div",{className:N},p.length===0&&o.createElement(L,{className:c.fileDropZone,controller:g,acceptedFileTypes:["image/png","image/jpeg"]}),p.length>0&&o.createElement("div",{className:c.imageCropperContainer},o.createElement(T,{cropShape:r,aspect:t/s,image:I,onCropComplete:(Q,R)=>{e.setCroppedArea(R)}}),o.createElement(Z,{color:"secondary",variant:"plain","aria-label":x.format("imageUpload.remove"),size:"s",onPress:()=>{g.clear(),e.clearCanvas(m.current)}},o.createElement(_,null))),o.createElement("canvas",{className:c.canvas,ref:m,width:t,height:s}))};C.__docgenInfo={description:"",methods:[],displayName:"ImageUpload",props:{className:{required:!1,tsType:{name:"string"},description:""},controller:{required:!0,tsType:{name:"ImageUploadController"},description:""},width:{required:!1,tsType:{name:"number"},description:""},height:{required:!1,tsType:{name:"number"},description:""}},composes:["Partial"]};class S{constructor(){n(this,"url");n(this,"imageSrc");n(this,"croppedArea");j(this,{url:f,imageSrc:f,croppedArea:f,drawImage:z.bound})}static useNew(){return u.useRef(new S).current}drawImage(e,r,t){const s=e.getContext("2d"),i=new Image(r,t);this.imageSrc&&(i.src=this.imageSrc),s&&this.croppedArea&&(s.drawImage(i,this.croppedArea.x,this.croppedArea.y,this.croppedArea.width,this.croppedArea.height,0,0,r,t),this.url=s.canvas.toDataURL("image/png"))}useUrl(){return h(()=>this.url)}useImageSrc(){return h(()=>this.imageSrc)}useCroppedArea(){return h(()=>this.croppedArea)}setImageSrc(e){const r=new FileReader;e.length>0&&(r.onload=t=>{t.target&&typeof t.target.result=="string"&&(this.imageSrc=t.target.result)},r.readAsDataURL(e[0]))}setCroppedArea(e){this.croppedArea=e}clearCanvas(e){if(e){const r=e.getContext("2d");r&&r.reset(),this.url=void 0}}}const M=()=>S.useNew(),Ge={title:"Upload/ImageUpload",component:C,parameters:{controls:{exclude:["className","controller"]}},argTypes:{cropShape:{control:"inline-radio",options:["rect","round"]},width:{control:"number"},height:{control:"number"}},render:a=>{const e=M(),r=e.useUrl();return o.createElement(O,null,o.createElement(C,{...a,controller:e}),r&&o.createElement(P,null,o.createElement(k,null,"Ergebnis"),o.createElement(V,{src:r,style:{width:"contentWidth"}})))}},l={},d={args:{cropShape:"round"}};var E,b,w;l.parameters={...l.parameters,docs:{...(E=l.parameters)==null?void 0:E.docs,source:{originalSource:"{}",...(w=(b=l.parameters)==null?void 0:b.docs)==null?void 0:w.source}}};var v,U,A;d.parameters={...d.parameters,docs:{...(v=d.parameters)==null?void 0:v.docs,source:{originalSource:`{
  args: {
    cropShape: "round"
  }
}`,...(A=(U=d.parameters)==null?void 0:U.docs)==null?void 0:A.source}}};const He=["Default","RoundCropShape"];export{l as Default,d as RoundCropShape,He as __namedExportsOrder,Ge as default};
