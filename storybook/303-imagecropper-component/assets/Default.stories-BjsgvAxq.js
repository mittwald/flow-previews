var R=Object.defineProperty;var D=(t,e,r)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var v=(t,e,r)=>D(t,typeof e!="symbol"?e+"":e,r);import{r as m,R as s}from"./index-uCp2LrAq.js";import{a as x,F}from"./FileController-BavFnD70.js";import{I as q}from"./ImageCropper-DajnaLpK.js";import{c as L}from"./clsx-B-dksMZM.js";import{m as T,o as _,b as k}from"./flowComponent-d9koHm8X.js";import{u as O}from"./useSelector-BUIORffs.js";import{L as Z}from"./Link-CFfN6dAc.js";import{S as j}from"./Section-C8kIh9p2.js";import"./_commonjsHelpers-BosuxZz1.js";import"./Button-CKjWx2QM.js";import"./PropsContextProvider-DJl9unei.js";import"./index-CqLFpzzG.js";import"./IconApp-08dtyhav.js";import"./IconWarning--xZ87BQk.js";import"./Wrap-DQq6jo70.js";import"./Text-CzfDsx2u.js";import"./EmulatedBoldText-DzNCZpDp.js";import"./Text-BxG67LRB.js";import"./utils-CRveUs4Q.js";import"./index-BOkhicXD.js";import"./LoadingSpinner-DBUWTLW8.js";import"./useLocalizedStringFormatter-CPyIEVee.js";import"./Button-B6RNnFE-.js";import"./filterDOMProps-CeZl_uWj.js";import"./useFocusable-DIY1EfD0.js";import"./usePress-B-418flx.js";import"./intlStrings-ZMTSFH_M.js";import"./useLabels-CrvI0Xse.js";import"./FocusScope-DRFNwxZB.js";import"./useDescription-DkXZ8A7g.js";import"./VisuallyHidden-BwH5wu93.js";import"./Input-CR20gog_.js";import"./PressResponder-CvugjgZN.js";import"./tslib.es6-CwyXKlH1.js";import"./Slider-C0d6X_7e.js";import"./Label-B6vS7Cqe.js";import"./useNumberFormatter-B6MG36v4.js";import"./useControlledState-B8AA3oOY.js";import"./number-nHrFdSb-.js";import"./useLabel-C-G_TB0Q.js";import"./useFormReset-D51lDO-b.js";import"./Activity-DYbiBj6P.js";import"./Collection-AT6m4EFM.js";import"./Header-hOCBwC_K.js";const z="flow--image-upload--canvas",I={canvas:z},g=t=>{const{canvasController:e,width:r=300,height:o=200,cropShape:n,className:p}=t,[a,c]=m.useState(),[d,S]=m.useState(),C=x.useNew(),i=C.useFiles()[0],h=new FileReader,f=m.useRef(null),U=L(I.imageUpload,p);return m.useEffect(()=>{i&&(h.onload=l=>{l.target&&typeof l.target.result=="string"&&c(l.target.result)},h.readAsDataURL(i))},[i]),m.useEffect(()=>{f.current&&a&&d&&e.drawImage(f.current,a,d,r,o)},[a,d]),s.createElement("div",{className:U},!i&&s.createElement(F,{controller:C}),i&&s.createElement(q,{cropShape:n,aspect:r/o,image:a,onCropComplete:(l,y)=>{S(y)}}),s.createElement("canvas",{className:I.canvas,ref:f,width:r,height:o}))};g.__docgenInfo={description:"",methods:[],displayName:"ImageUpload",props:{className:{required:!1,tsType:{name:"string"},description:""},canvasController:{required:!0,tsType:{name:"CanvasController"},description:""},width:{required:!1,tsType:{name:"number"},description:""},height:{required:!1,tsType:{name:"number"},description:""}},composes:["Pick"]};class w{constructor(){v(this,"url");T(this,{url:_,drawImage:k.bound})}static useNew(){return m.useRef(new w).current}drawImage(e,r,o,n,p){const a=e.getContext("2d"),c=new Image(n,p);c.src=r,a&&(a.drawImage(c,o.x,o.y,o.width,o.height,0,0,n,p),this.url=a.canvas.toDataURL("image/png"))}useUrl(){return O(()=>this.url)}}const Le={title:"Upload/ImageUpload",component:g,render:t=>{const e=w.useNew(),r=e.useUrl();return s.createElement(j,null,s.createElement(g,{...t,canvasController:e}),s.createElement(Z,{href:r,isDisabled:!r,download:!0},"Download cropped image"))}},u={};var E,b,N;u.parameters={...u.parameters,docs:{...(E=u.parameters)==null?void 0:E.docs,source:{originalSource:"{}",...(N=(b=u.parameters)==null?void 0:b.docs)==null?void 0:N.source}}};const Te=["Default"];export{u as Default,Te as __namedExportsOrder,Le as default};
