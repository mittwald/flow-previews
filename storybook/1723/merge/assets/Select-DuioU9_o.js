import{r as u,R as v,j as x}from"./iframe-BpEavT04.js";import{f as _,P as G,N as J,R as Q}from"./PropsContextProvider-REkcYbgF.js";import{f as F}from"./FormField.module-B9AzUSUD.js";import{F as Y}from"./FieldError-DY8OUBEl.js";import{c as Z}from"./clsx-B-dksMZM.js";import{c as ee}from"./IconWarning-vA6HsYJq.js";import{a as le}from"./Option-DPVCVVRW.js";import{u as te}from"./DialogTriggerView-DpWn2yoK.js";import{$ as z,a as ae}from"./Button-CEEqH0ki.js";import{$ as H,c as W,a as L,g as oe,d as ie,e as re}from"./utils-CpHgE-S6.js";import{$ as se}from"./FieldError-BmEWAGf_.js";import{b as ne,c as de,a as ce,$ as fe}from"./Form-DJ2svD4f.js";import{$ as ue}from"./intlStrings-ZMTSFH_M.js";import{$ as U}from"./Label-DpfcozJA.js";import{$ as be,a as $e}from"./ListBox-Dm28Vww0.js";import{l as me,h as pe,m as ve}from"./Dialog-DAXkTNx8.js";import{a as q}from"./Text-DWLjOUr2.js";import{b as ge}from"./CollectionBuilder-DQGAitfS.js";import{$ as k,d as xe,e as ye}from"./mergeRefs-BC_BuoXn.js";import{$ as j}from"./filterDOMProps-i7L6S0l1.js";import{c as he,g as Pe}from"./OverlayArrow-CMORky_-.js";import{$ as Se}from"./useLocalizedStringFormatter-DJSuZDt4.js";import{$ as Ce}from"./useSingleSelectListState-1hkbhvZ1.js";import{a as Re}from"./useFocusRing-DmvqpG-I.js";import{$ as De,o as Fe}from"./SelectionManager-BpD0kl0T.js";import{D as Ie}from"./useFocus-BaJLfW1J.js";import{a as Ke}from"./useCollator-bTe8AndB.js";import{$ as Ee}from"./useFormReset-CovQJR7M.js";import{a as Be}from"./VisuallyHidden-DD5pbayJ.js";const N=new WeakMap;function we(e,l,s){let{keyboardDelegate:i,isDisabled:o,isRequired:n,name:b,form:a,validationBehavior:r="aria"}=e,$=Ke({usage:"search",sensitivity:"base"}),t=u.useMemo(()=>i||new De(l.collection,l.disabledKeys,s,$),[i,l.collection,l.disabledKeys,$,s]),{menuTriggerProps:m,menuProps:f}=me({isDisabled:o,type:"listbox"},l,s),d=c=>{switch(c.key){case"ArrowLeft":{var h,P;c.preventDefault();let D=l.selectedKey!=null?(h=t.getKeyAbove)===null||h===void 0?void 0:h.call(t,l.selectedKey):(P=t.getFirstKey)===null||P===void 0?void 0:P.call(t);D&&l.setSelectedKey(D);break}case"ArrowRight":{var O,M;c.preventDefault();let D=l.selectedKey!=null?(O=t.getKeyBelow)===null||O===void 0?void 0:O.call(t,l.selectedKey):(M=t.getFirstKey)===null||M===void 0?void 0:M.call(t);D&&l.setSelectedKey(D);break}}},{typeSelectProps:p}=Fe({keyboardDelegate:t,selectionManager:l.selectionManager,onTypeSelect(c){l.setSelectedKey(c)}}),{isInvalid:S,validationErrors:C,validationDetails:K}=l.displayValidation,{labelProps:E,fieldProps:R,descriptionProps:y,errorMessageProps:B}=ne({...e,labelElementType:"span",isInvalid:S,errorMessage:e.errorMessage||C});p.onKeyDown=p.onKeyDownCapture,delete p.onKeyDownCapture;let w=j(e,{labelable:!0}),g=k(p,m,R),I=xe();return N.set(l,{isDisabled:o,isRequired:n,name:b,form:a,validationBehavior:r}),{labelProps:{...E,onClick:()=>{if(!e.isDisabled){var c;(c=s.current)===null||c===void 0||c.focus(),Ie("keyboard")}}},triggerProps:k(w,{...g,isDisabled:o,onKeyDown:ye(g.onKeyDown,d,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[I,g["aria-labelledby"],g["aria-label"]&&!g["aria-labelledby"]?g.id:null].filter(Boolean).join(" "),onFocus(c){l.isFocused||(e.onFocus&&e.onFocus(c),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(c){l.isOpen||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:I},menuProps:{...f,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:c=>{c.currentTarget.contains(c.relatedTarget)||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[R["aria-labelledby"],g["aria-label"]&&!R["aria-labelledby"]?g.id:null].filter(Boolean).join(" ")},descriptionProps:y,errorMessageProps:B,isInvalid:S,validationErrors:C,validationDetails:K,hiddenSelectProps:{isDisabled:o,name:b,label:e.label,state:l,triggerRef:s,form:a}}}function Oe(e,l,s){let i=N.get(l)||{},{autoComplete:o,name:n=i.name,form:b=i.form,isDisabled:a=i.isDisabled}=e,{validationBehavior:r,isRequired:$}=i,{visuallyHiddenProps:t}=Be({style:{position:"fixed",top:0,left:0}});Ee(e.selectRef,l.defaultSelectedKey,l.setSelectedKey),de({validationBehavior:r,focus:()=>{var d;return(d=s.current)===null||d===void 0?void 0:d.focus()}},l,e.selectRef);let m=u.useCallback(d=>l.setSelectedKey(d.currentTarget.value),[l.setSelectedKey]);var f;return{containerProps:{...t,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:a,required:r==="native"&&$,name:n,form:b,value:(f=l.selectedKey)!==null&&f!==void 0?f:"",onChange:m,onInput:m}}}function Me(e){let{state:l,triggerRef:s,label:i,name:o,form:n,isDisabled:b}=e,a=u.useRef(null),r=u.useRef(null),{containerProps:$,selectProps:t}=Oe({...e,selectRef:l.collection.size<=300?a:r},l,s);if(l.collection.size<=300)return v.createElement("div",{...$,"data-testid":"hidden-select-container"},v.createElement("label",null,i,v.createElement("select",{...t,ref:a},v.createElement("option",null),[...l.collection.getKeys()].map(f=>{let d=l.collection.getItem(f);if(d&&d.type==="item")return v.createElement("option",{key:d.key,value:d.key},d.textValue)}))));if(o){let f=N.get(l)||{},{validationBehavior:d}=f;var m;let p={type:"hidden",autoComplete:t.autoComplete,name:o,form:n,disabled:b,value:(m=l.selectedKey)!==null&&m!==void 0?m:""};return d==="native"?v.createElement("input",{...p,ref:r,style:{display:"none"},type:"text",required:t.required,onChange:()=>{}}):v.createElement("input",{...p,ref:r})}return null}function ke(e){let l=he(e),[s,i]=u.useState(null),o=Ce({...e,onSelectionChange:t=>{e.onSelectionChange!=null&&e.onSelectionChange(t),l.close(),n.commitValidation()}}),n=ce({...e,value:o.selectedKey}),[b,a]=u.useState(!1),[r]=u.useState(o.selectedKey);var $;return{...n,...o,...l,defaultSelectedKey:($=e.defaultSelectedKey)!==null&&$!==void 0?$:r,focusStrategy:s,open(t=null){o.collection.size!==0&&(i(t),l.open())},toggle(t=null){o.collection.size!==0&&(i(t),l.toggle())},isFocused:b,setFocused:a}}function qe(e){return e&&e.__esModule?e.default:e}const V=u.createContext(null),A=u.createContext(null),je=u.forwardRef(function(l,s){[l,s]=H(l,s,V);let{children:i,isDisabled:o=!1,isInvalid:n=!1,isRequired:b=!1}=l,a=u.useMemo(()=>typeof i=="function"?i({isOpen:!1,isDisabled:o,isInvalid:n,isRequired:b,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):i,[i,o,n,b]);return v.createElement(ge,{content:a},r=>v.createElement(Ve,{props:l,collection:r,selectRef:s}))}),Ne=[U,z,q];function Ve({props:e,selectRef:l,collection:s}){let{validationBehavior:i}=W(fe)||{};var o,n;let b=(n=(o=e.validationBehavior)!==null&&o!==void 0?o:i)!==null&&n!==void 0?n:"native",a=ke({...e,collection:s,children:void 0,validationBehavior:b}),{isFocusVisible:r,focusProps:$}=Re({within:!0}),t=u.useRef(null),[m,f]=oe(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:d,triggerProps:p,valueProps:S,menuProps:C,descriptionProps:K,errorMessageProps:E,hiddenSelectProps:R,...y}=we({...ie(e),label:f,validationBehavior:b},a,t),[B,w]=u.useState(null),g=u.useCallback(()=>{t.current&&w(t.current.offsetWidth+"px")},[t]);Pe({ref:t,onResize:g});let I=u.useMemo(()=>({isOpen:a.isOpen,isFocused:a.isFocused,isFocusVisible:r,isDisabled:e.isDisabled||!1,isInvalid:y.isInvalid||!1,isRequired:e.isRequired||!1}),[a.isOpen,a.isFocused,r,e.isDisabled,y.isInvalid,e.isRequired]),c=L({...e,values:I,defaultClassName:"react-aria-Select"}),h=j(e,{global:!0});delete h.id;let P=u.useRef(null);return v.createElement(re,{values:[[V,e],[A,a],[X,S],[U,{...d,ref:m,elementType:"span"}],[z,{...p,ref:t,isPressed:a.isOpen,autoFocus:e.autoFocus}],[pe,a],[ve,{trigger:"Select",triggerRef:t,scrollRef:P,placement:"bottom start",style:{"--trigger-width":B},"aria-labelledby":C["aria-labelledby"],clearContexts:Ne}],[be,{...C,ref:P}],[$e,a],[q,{slots:{description:K,errorMessage:E}}],[se,y]]},v.createElement("div",{...k(h,c,$),ref:l,slot:e.slot||void 0,"data-focused":a.isFocused||void 0,"data-focus-visible":r||void 0,"data-open":a.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":y.isInvalid||void 0,"data-required":e.isRequired||void 0},c.children,v.createElement(Me,{...R,autoComplete:e.autoComplete})))}const X=u.createContext(null),Te=u.forwardRef(function(l,s){var i,o;[l,s]=H(l,s,X);let n=u.useContext(A),{placeholder:b}=W(V),a=n.selectedKey!=null?n.collection.getItem(n.selectedKey):null,r=a?.props.children;typeof r=="function"&&(r=r({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"}));let $=Se(qe(ue),"react-aria-components");var t,m,f;let d=L({...l,defaultChildren:(t=r??b)!==null&&t!==void 0?t:$.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(m=(i=n.selectedItem)===null||i===void 0?void 0:i.value)!==null&&m!==void 0?m:null,selectedText:(f=(o=n.selectedItem)===null||o===void 0?void 0:o.textValue)!==null&&f!==void 0?f:null,isPlaceholder:!a}}),p=j(l,{global:!0});return v.createElement("span",{ref:s,...p,...d,"data-placeholder":!a||void 0},v.createElement(q.Provider,{value:void 0},d.children))}),ze="flow--select",He="flow--select--toggle",T={select:ze,toggle:He},We=_("Select",e=>{const{children:l,className:s,onChange:i=()=>{},onSelectionChange:o=()=>{},controller:n,ref:b,...a}=e,r=Z(T.select,F.formField,s),$={Label:{className:F.label,optional:!e.isRequired},FieldDescription:{className:F.fieldDescription},FieldError:{className:F.customFieldError},Option:{tunnelId:"options"}},t=p=>{i(String(p)),o(p)},m=te("Select",{reuseControllerFromContext:!0}),f=n??m,d=f.useIsOpen();return x.jsx(je,{...a,className:r,ref:b,onSelectionChange:t,onOpenChange:p=>f.setOpen(p),isOpen:d,children:x.jsx(G,{props:$,children:x.jsxs(J,{children:[x.jsxs(ae,{className:T.toggle,children:[x.jsx(Te,{}),x.jsx(ee,{})]}),l,x.jsx(le,{controller:f,children:x.jsx(Q,{id:"options"})}),x.jsx(Y,{className:F.fieldError})]})})})});We.__docgenInfo={description:`@flr-generate all
@flr-clear-props-context`,methods:[],displayName:"Select"};export{We as S};
