import{$ as N,a as ae}from"./Collection-BHsfcKmd.js";import{$ as re,c as R,b as le,a as A,g as Q,d as ie,h as de}from"./utils-BAtcVSHo.js";import{$ as T,a as ne,b as X,c as se}from"./DragAndDrop-CvXJIw9w.js";import{d as ce,e as ue,f as fe,g as pe}from"./Dialog-CI6Vrv3H.js";import{a as be}from"./Separator-BH0DZ6tu.js";import{a as $e}from"./Text-CxIdO6ok.js";import{b as ge,c as ve,a as me}from"./CollectionBuilder-C_ibKIdv.js";import{d as Y,$ as H,e as G,f as he}from"./index-Dfd2pZHs.js";import{$ as _}from"./filterDOMProps-CeZl_uWj.js";import{r as d,R as f}from"./index-BZISi7jw.js";import{a as xe,$ as Pe}from"./useListState-W_0yGyns.js";import{a as De}from"./useLocalizedStringFormatter-CZn_2Om1.js";import{$ as ye}from"./useCollator-CDl7pGf-.js";import{c as Se,d as ke}from"./SelectionManager-DjqhJ6FU.js";import{$ as Fe,a as Z,b as Ce}from"./useFocusRing-D6MLu59I.js";import{$ as we}from"./useLabel-Bh1EGhcd.js";import{a as Ee}from"./usePress-AhNAqARA.js";import{s as He,t as Me,q as J}from"./useFocus-CGq_xkJe.js";import{a as Be}from"./FocusScope-FOL1CxoP.js";const K=new WeakMap;function Ve(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function Ie(t,e){let a=K.get(t);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Ve(e)}`}function Ae(t,e,a){let r=_(t,{labelable:!0}),i=t.selectionBehavior||"toggle",l=t.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&l==="action"&&(l="override");let{listProps:o}=ce({...t,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:l}),{focusWithinProps:s}=Fe({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),b=Y(t.id);K.set(e,{id:b,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:l});let{labelProps:p,fieldProps:c}=we({...t,id:b,labelElementType:"span"});return{labelProps:p,listBoxProps:H(r,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...H(c,o)})}}function Te(t,e,a){var r,i;let{key:l}=t,o=K.get(e);var s;let b=(s=t.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(l);var p;let c=(p=t.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(l);var g;let n=(g=t.shouldSelectOnPressUp)!==null&&g!==void 0?g:o==null?void 0:o.shouldSelectOnPressUp;var v;let h=(v=t.shouldFocusOnHover)!==null&&v!==void 0?v:o==null?void 0:o.shouldFocusOnHover;var m;let $=(m=t.shouldUseVirtualFocus)!==null&&m!==void 0?m:o==null?void 0:o.shouldUseVirtualFocus;var x;let S=(x=t.isVirtualized)!==null&&x!==void 0?x:o==null?void 0:o.isVirtualized,k=G(),M=G(),y={role:"option","aria-disabled":b||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};He()&&Me()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=k,y["aria-describedby"]=M);let u=e.collection.getItem(l);if(S){let D=Number(u==null?void 0:u.index);y["aria-posinset"]=Number.isNaN(D)?void 0:D+1,y["aria-setsize"]=ue(e.collection)}let B=o!=null&&o.onAction?()=>{var D;return o==null||(D=o.onAction)===null||D===void 0?void 0:D.call(o,l)}:void 0,V=Ie(e,l),{itemProps:U,isPressed:C,isFocused:P,hasAction:F,allowsSelection:w}=Se({selectionManager:e.selectionManager,key:l,ref:a,shouldSelectOnPressUp:n,allowsDifferentPressOrigin:n&&h,isVirtualized:S,shouldUseVirtualFocus:$,isDisabled:b,onAction:B||!(u==null||(r=u.props)===null||r===void 0)&&r.onAction?he(u==null||(i=u.props)===null||i===void 0?void 0:i.onAction,B):void 0,linkBehavior:o==null?void 0:o.linkBehavior,id:V}),{hoverProps:I}=Z({isDisabled:b||!h,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(l))}}),E=_(u==null?void 0:u.props);delete E.id;let O=Ee(u==null?void 0:u.props);return{optionProps:{...y,...H(E,U,I,O),id:V},labelProps:{id:k},descriptionProps:{id:M},isFocused:P,isFocusVisible:P&&e.selectionManager.isFocused&&J(),isSelected:c,isDisabled:b,isPressed:C,allowsSelection:w,hasAction:F}}function _e(t){let{heading:e,"aria-label":a}=t,r=Y();return{itemProps:{role:"presentation"},headingProps:e?{id:r,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?r:void 0}}}const ee=d.createContext(null),L=d.createContext(null),so=d.forwardRef(function(e,a){[e,a]=re(e,a,ee);let r=d.useContext(L);return r?f.createElement(oe,{state:r,props:e,listBoxRef:a}):f.createElement(ge,{content:f.createElement(ve,e)},i=>f.createElement(Le,{props:e,listBoxRef:a,collection:i}))});function Le({props:t,listBoxRef:e,collection:a}){t={...t,collection:a,children:null,items:null};let{layoutDelegate:r}=d.useContext(N),i=Pe({...t,layoutDelegate:r});return f.createElement(oe,{state:i,props:t,listBoxRef:e})}function oe({state:t,props:e,listBoxRef:a}){let{filter:r,collectionProps:i,collectionRef:l}=d.useContext(fe)||{};e=d.useMemo(()=>i?{...e,...i}:e,[e,i]);let{dragAndDropHooks:o,layout:s="stack",orientation:b="vertical"}=e;a=R(d.useMemo(()=>le(a,l!==void 0?l:null),[l,a]));let p=xe(t,r),{collection:c,selectionManager:g}=p,n=!!(o!=null&&o.useDraggableCollectionState),v=!!(o!=null&&o.useDroppableCollectionState),{direction:h}=De(),{disabledBehavior:m,disabledKeys:$}=g,x=ye({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:k,dropTargetDelegate:M,CollectionRoot:y}=d.useContext(N),u=d.useMemo(()=>e.keyboardDelegate||new ke({collection:c,collator:x,ref:a,disabledKeys:$,disabledBehavior:m,layout:s,orientation:b,direction:h,layoutDelegate:k}),[c,x,a,m,$,b,h,e.keyboardDelegate,s,k]),{listBoxProps:B}=Ae({...e,shouldSelectOnPressUp:n||e.shouldSelectOnPressUp,keyboardDelegate:u,isVirtualized:S},p,a),V=d.useRef(n),U=d.useRef(v);d.useEffect(()=>{V.current!==n&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),U.current!==v&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[n,v]);let C,P,F,w=!1,I=null,E=d.useRef(null);if(n&&o){C=o.useDraggableCollectionState({collection:c,selectionManager:g,preview:o.renderDragPreview?E:void 0}),o.useDraggableCollection({},C,a);let z=o.DragPreview;I=o.renderDragPreview?f.createElement(z,{ref:E},o.renderDragPreview):null}if(v&&o){P=o.useDroppableCollectionState({collection:c,selectionManager:g});let z=o.dropTargetDelegate||M||new o.ListDropTargetDelegate(c,a,{orientation:b,layout:s,direction:h});F=o.useDroppableCollection({keyboardDelegate:u,dropTargetDelegate:z},P,a),w=P.isDropTarget({type:"root"})}let{focusProps:O,isFocused:D,isFocusVisible:W}=Ce(),q={isDropTarget:w,isEmpty:p.collection.size===0,isFocused:D,isFocusVisible:W,layout:e.layout||"stack",state:p},te=A({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:q}),j=null;return p.collection.size===0&&e.renderEmptyState&&(j=f.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(q))),f.createElement(Be,null,f.createElement("div",{..._(e),...H(B,O,F==null?void 0:F.collectionProps),...te,ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":p.collection.size===0||void 0,"data-focused":D||void 0,"data-focus-visible":W||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},f.createElement(Q,{values:[[ee,e],[L,p],[T,{dragAndDropHooks:o,dragState:C,dropState:P}],[be,{elementType:"div"}],[ne,{render:Oe}],[ae,{name:"ListBoxSection",render:Ue}]]},f.createElement(y,{collection:c,scrollRef:a,persistedKeys:se(g,o,P),renderDropIndicator:X(o,P)})),j,I))}function Ue(t,e,a,r="react-aria-ListBoxSection"){let i=d.useContext(L),{dragAndDropHooks:l,dropState:o}=d.useContext(T),{CollectionBranch:s}=d.useContext(N),[b,p]=ie();var c;let{headingProps:g,groupProps:n}=_e({heading:p,"aria-label":(c=t["aria-label"])!==null&&c!==void 0?c:void 0}),v=A({defaultClassName:r,className:t.className,style:t.style,values:{}});return f.createElement("section",{..._(t),...n,...v,ref:e},f.createElement(pe.Provider,{value:{...g,ref:b}},f.createElement(s,{collection:i.collection,parent:a,renderDropIndicator:X(l,o)})))}const co=me("item",function(e,a,r){let i=R(a),l=d.useContext(L),{dragAndDropHooks:o,dragState:s,dropState:b}=d.useContext(T),{optionProps:p,labelProps:c,descriptionProps:g,...n}=Te({key:r.key,"aria-label":e==null?void 0:e["aria-label"]},l,i),{hoverProps:v,isHovered:h}=Z({isDisabled:!n.allowsSelection&&!n.hasAction,onHoverStart:r.props.onHoverStart,onHoverChange:r.props.onHoverChange,onHoverEnd:r.props.onHoverEnd}),m=null;s&&o&&(m=o.useDraggableItem({key:r.key},s));let $=null;b&&o&&($=o.useDroppableItem({target:{type:"item",key:r.key,dropPosition:"on"}},b,i));let x=s&&s.isDragging(r.key),S=A({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...n,isHovered:h,selectionMode:l.selectionManager.selectionMode,selectionBehavior:l.selectionManager.selectionBehavior,allowsDragging:!!s,isDragging:x,isDropTarget:$==null?void 0:$.isDropTarget}});d.useEffect(()=>{r.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[r.textValue]);let k=e.href?"a":"div";return f.createElement(k,{...H(p,v,m==null?void 0:m.dragProps,$==null?void 0:$.dropProps),...S,ref:i,"data-allows-dragging":!!s||void 0,"data-selected":n.isSelected||void 0,"data-disabled":n.isDisabled||void 0,"data-hovered":h||void 0,"data-focused":n.isFocused||void 0,"data-focus-visible":n.isFocusVisible||void 0,"data-pressed":n.isPressed||void 0,"data-dragging":x||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":l.selectionManager.selectionMode==="none"?void 0:l.selectionManager.selectionMode},f.createElement(Q,{values:[[$e,{slots:{[de]:c,label:c,description:g}}]]},S.children))});function Oe(t,e){e=R(e);let{dragAndDropHooks:a,dropState:r}=d.useContext(T),{dropIndicatorProps:i,isHidden:l,isDropTarget:o}=a.useDropIndicator(t,r,e);return l?null:f.createElement(Ne,{...t,dropIndicatorProps:i,isDropTarget:o,ref:e})}function ze(t,e){let{dropIndicatorProps:a,isDropTarget:r,...i}=t,l=A({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:r}});return f.createElement("div",{...a,...l,role:"option",ref:e,"data-drop-target":r||void 0})}const Ne=d.forwardRef(ze);export{so as $,co as a,ee as b,L as c,K as d,Ie as e};
