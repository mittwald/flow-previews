import{$ as z,a as le}from"./Collection-BUlFfF8c.js";import{$ as re,b as R,a as B,e as J,g as ie,f as de}from"./utils-DLoLmG8U.js";import{$ as U,a as ne,b as Q,c as se,d as ce}from"./DragAndDrop-mRyNcCsw.js";import{n as ue,o as $e,p as fe,q as be}from"./Dialog-B6nmokeD.js";import{$ as ve}from"./Separator-UXxAVoEs.js";import{a as pe}from"./Text-K3zhr9uI.js";import{b as ge,c as me,$ as X}from"./CollectionBuilder-odsoNS1P.js";import{d as Y,$ as C,g as j,e as xe,a as he}from"./mergeRefs-CjEz_01H.js";import{$ as I}from"./filterDOMProps-CghfNOdR.js";import{$ as Pe}from"./inertValue-DLhP2AV5.js";import{r as d,R as n}from"./iframe-Cvd7_oGo.js";import{$ as De,a as ye}from"./useListState-C4RXt51m.js";import{$ as Se}from"./context-CPCW_rIy.js";import{a as Ee}from"./useCollator-Z2E5mfuy.js";import{d as Me,$ as Ce}from"./SelectionManager-C8UQ25IV.js";import{b as Fe,$ as Z,a as ke}from"./useFocusRing-BORhh_J0.js";import{a as we}from"./useLabel-C20I_MYv.js";import{b as Ie}from"./usePress-dFXSg5ro.js";import{r as Le,q as Be,g as G}from"./useFocus-mBCJQH3P.js";import{a as Ve}from"./FocusScope-_f1yOmDv.js";const W=new WeakMap;function Oe(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function _e(t,e){let a=W.get(t);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Oe(e)}`}function He(t,e,a){let l=I(t,{labelable:!0}),r=t.selectionBehavior||"toggle",i=t.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&i==="action"&&(i="override");let{listProps:o}=ue({...t,ref:a,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:i}),{focusWithinProps:s}=Fe({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),f=Y(t.id);W.set(e,{id:f,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:i});let{labelProps:$,fieldProps:c}=we({...t,id:f,labelElementType:"span"});return{labelProps:$,listBoxProps:C(l,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...C(c,o)})}}function Ae(t,e,a){var l,r;let{key:i}=t,o=W.get(e);var s;let f=(s=t.isDisabled)!==null&&s!==void 0?s:e.selectionManager.isDisabled(i);var $;let c=($=t.isSelected)!==null&&$!==void 0?$:e.selectionManager.isSelected(i);var v;let u=(v=t.shouldSelectOnPressUp)!==null&&v!==void 0?v:o==null?void 0:o.shouldSelectOnPressUp;var m;let g=(m=t.shouldFocusOnHover)!==null&&m!==void 0?m:o==null?void 0:o.shouldFocusOnHover;var x;let p=(x=t.shouldUseVirtualFocus)!==null&&x!==void 0?x:o==null?void 0:o.shouldUseVirtualFocus;var P;let E=(P=t.isVirtualized)!==null&&P!==void 0?P:o==null?void 0:o.isVirtualized,M=j(),D=j(),y={role:"option","aria-disabled":f||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?c:void 0};Le()&&Be()||(y["aria-label"]=t["aria-label"],y["aria-labelledby"]=M,y["aria-describedby"]=D);let b=e.collection.getItem(i);if(E){let h=Number(b==null?void 0:b.index);y["aria-posinset"]=Number.isNaN(h)?void 0:h+1,y["aria-setsize"]=$e(e.collection)}let O=o!=null&&o.onAction?()=>{var h;return o==null||(h=o.onAction)===null||h===void 0?void 0:h.call(o,i)}:void 0,F=_e(e,i),{itemProps:S,isPressed:k,isFocused:w,hasAction:_,allowsSelection:H}=Me({selectionManager:e.selectionManager,key:i,ref:a,shouldSelectOnPressUp:u,allowsDifferentPressOrigin:u&&g,isVirtualized:E,shouldUseVirtualFocus:p,isDisabled:f,onAction:O||!(b==null||(l=b.props)===null||l===void 0)&&l.onAction?xe(b==null||(r=b.props)===null||r===void 0?void 0:r.onAction,O):void 0,linkBehavior:o==null?void 0:o.linkBehavior,id:F}),{hoverProps:T}=Z({isDisabled:f||!g,onHoverStart(){G()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(i))}}),L=I(b==null?void 0:b.props);delete L.id;let A=Ie(b==null?void 0:b.props);return{optionProps:{...y,...C(L,S,T,A),id:F},labelProps:{id:M},descriptionProps:{id:D},isFocused:w,isFocusVisible:w&&e.selectionManager.isFocused&&G(),isSelected:c,isDisabled:f,isPressed:k,allowsSelection:H,hasAction:_}}function Ue(t){let{heading:e,"aria-label":a}=t,l=Y();return{itemProps:{role:"presentation"},headingProps:e?{id:l,role:"presentation"}:{},groupProps:{role:"group","aria-label":a,"aria-labelledby":e?l:void 0}}}const ee=d.createContext(null),V=d.createContext(null),$o=d.forwardRef(function(e,a){[e,a]=re(e,a,ee);let l=d.useContext(V);return l?n.createElement(oe,{state:l,props:e,listBoxRef:a}):n.createElement(ge,{content:n.createElement(me,e)},r=>n.createElement(Te,{props:e,listBoxRef:a,collection:r}))});function Te({props:t,listBoxRef:e,collection:a}){t={...t,collection:a,children:null,items:null};let{layoutDelegate:l}=d.useContext(z),r=ye({...t,layoutDelegate:l});return n.createElement(oe,{state:r,props:t,listBoxRef:e})}function oe({state:t,props:e,listBoxRef:a}){let{filter:l,collectionProps:r,collectionRef:i}=d.useContext(fe)||{};e=d.useMemo(()=>r?{...e,...r}:e,[e,r]);let{dragAndDropHooks:o,layout:s="stack",orientation:f="vertical"}=e;a=R(d.useMemo(()=>he(a,i!==void 0?i:null),[i,a]));let $=De(t,l),{collection:c,selectionManager:v}=$,u=!!(o!=null&&o.useDraggableCollectionState),m=!!(o!=null&&o.useDroppableCollectionState),{direction:g}=Se(),{disabledBehavior:x,disabledKeys:p}=v,P=Ee({usage:"search",sensitivity:"base"}),{isVirtualized:E,layoutDelegate:M,dropTargetDelegate:D,CollectionRoot:y}=d.useContext(z),b=d.useMemo(()=>e.keyboardDelegate||new Ce({collection:c,collator:P,ref:a,disabledKeys:p,disabledBehavior:x,layout:s,orientation:f,direction:g,layoutDelegate:M}),[c,P,a,x,p,f,g,e.keyboardDelegate,s,M]),{listBoxProps:O}=He({...e,shouldSelectOnPressUp:u||e.shouldSelectOnPressUp,keyboardDelegate:b,isVirtualized:E},$,a);d.useRef(u),d.useRef(m),d.useEffect(()=>{},[u,m]);let F,S,k,w=!1,_=null,H=d.useRef(null);if(u&&o){F=o.useDraggableCollectionState({collection:c,selectionManager:v,preview:o.renderDragPreview?H:void 0}),o.useDraggableCollection({},F,a);let N=o.DragPreview;_=o.renderDragPreview?n.createElement(N,{ref:H},o.renderDragPreview):null}if(m&&o){S=o.useDroppableCollectionState({collection:c,selectionManager:v});let N=o.dropTargetDelegate||D||new o.ListDropTargetDelegate(c,a,{orientation:f,layout:s,direction:g});k=o.useDroppableCollection({keyboardDelegate:b,dropTargetDelegate:N},S,a),w=S.isDropTarget({type:"root"})}let{focusProps:T,isFocused:L,isFocusVisible:A}=ke(),h=$.collection.size===0,K={isDropTarget:w,isEmpty:h,isFocused:L,isFocusVisible:A,layout:e.layout||"stack",state:$},te=B({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:K}),q=null;h&&e.renderEmptyState&&(q=n.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(K)));let ae=I(e,{global:!0});return n.createElement(Ve,null,n.createElement("div",{...C(ae,te,O,T,k==null?void 0:k.collectionProps),ref:a,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":w||void 0,"data-empty":h||void 0,"data-focused":L||void 0,"data-focus-visible":A||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},n.createElement(J,{values:[[ee,e],[V,$],[U,{dragAndDropHooks:o,dragState:F,dropState:S}],[ve,{elementType:"div"}],[ne,{render:ze}],[le,{name:"ListBoxSection",render:Ne}]]},n.createElement(y,{collection:c,scrollRef:a,persistedKeys:se(v,o,S),renderDropIndicator:Q(o,S)})),q,_))}function Ne(t,e,a,l="react-aria-ListBoxSection"){let r=d.useContext(V),{dragAndDropHooks:i,dropState:o}=d.useContext(U),{CollectionBranch:s}=d.useContext(z),[f,$]=ie();var c;let{headingProps:v,groupProps:u}=Ue({heading:$,"aria-label":(c=t["aria-label"])!==null&&c!==void 0?c:void 0}),m=B({defaultClassName:l,className:t.className,style:t.style,values:{}}),g=I(t,{global:!0});return delete g.id,n.createElement("section",{...C(g,m,u),ref:e},n.createElement(be.Provider,{value:{...v,ref:f}},n.createElement(s,{collection:r.collection,parent:a,renderDropIndicator:Q(i,o)})))}const fo=X("item",function(e,a,l){let r=R(a),i=d.useContext(V),{dragAndDropHooks:o,dragState:s,dropState:f}=d.useContext(U),{optionProps:$,labelProps:c,descriptionProps:v,...u}=Ae({key:l.key,"aria-label":e==null?void 0:e["aria-label"]},i,r),{hoverProps:m,isHovered:g}=Z({isDisabled:!u.allowsSelection&&!u.hasAction,onHoverStart:l.props.onHoverStart,onHoverChange:l.props.onHoverChange,onHoverEnd:l.props.onHoverEnd}),x=null;s&&o&&(x=o.useDraggableItem({key:l.key},s));let p=null;f&&o&&(p=o.useDroppableItem({target:{type:"item",key:l.key,dropPosition:"on"}},f,r));let P=s&&s.isDragging(l.key),E=B({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...u,isHovered:g,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!s,isDragging:P,isDropTarget:p==null?void 0:p.isDropTarget}});d.useEffect(()=>{l.textValue},[l.textValue]);let M=e.href?"a":"div",D=I(e,{global:!0});return delete D.id,delete D.onClick,n.createElement(M,{...C(D,E,$,m,x==null?void 0:x.dragProps,p==null?void 0:p.dropProps),ref:r,"data-allows-dragging":!!s||void 0,"data-selected":u.isSelected||void 0,"data-disabled":u.isDisabled||void 0,"data-hovered":g||void 0,"data-focused":u.isFocused||void 0,"data-focus-visible":u.isFocusVisible||void 0,"data-pressed":u.isPressed||void 0,"data-dragging":P||void 0,"data-drop-target":(p==null?void 0:p.isDropTarget)||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},n.createElement(J,{values:[[pe,{slots:{[de]:c,label:c,description:v}}]]},E.children))});function ze(t,e){e=R(e);let{dragAndDropHooks:a,dropState:l}=d.useContext(U),{dropIndicatorProps:r,isHidden:i,isDropTarget:o}=a.useDropIndicator(t,l,e);return i?null:n.createElement(We,{...t,dropIndicatorProps:r,isDropTarget:o,ref:e})}function Re(t,e){let{dropIndicatorProps:a,isDropTarget:l,...r}=t,i=B({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:l}});return n.createElement("div",{...a,...i,role:"option",ref:e,"data-drop-target":l||void 0})}const We=d.forwardRef(Re);X("loader",function(e,a,l){let r=d.useContext(V),{isLoading:i,onLoadMore:o,scrollOffset:s,...f}=e,$=d.useRef(null),c=d.useMemo(()=>({onLoadMore:o,collection:r==null?void 0:r.collection,sentinelRef:$,scrollOffset:s}),[o,s,r==null?void 0:r.collection]);ce(c,$);let v=B({...f,id:void 0,children:l.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),u={tabIndex:-1};return n.createElement(n.Fragment,null,n.createElement("div",{style:{position:"relative",width:0,height:0},inert:Pe(!0)},n.createElement("div",{"data-testid":"loadMoreSentinel",ref:$,style:{position:"absolute",height:1,width:1}})),i&&v.children&&n.createElement("div",{...C(I(e,{global:!0}),u),...v,role:"option",ref:a},v.children))});export{ee as $,V as a,$o as b,fo as c,W as d,_e as e};
