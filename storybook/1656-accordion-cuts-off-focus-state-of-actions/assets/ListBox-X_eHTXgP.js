import{$ as T,a as le}from"./Collection-U6iOHpYg.js";import{$ as ie,b as R,a as L,e as Q,g as re,f as de}from"./utils-5hQd1GPy.js";import{$ as z,a as ne,b as X,c as se,d as ce}from"./DragAndDrop-CxunliPT.js";import{n as ue,o as fe,p as $e,q as be}from"./Dialog-IOGvswXh.js";import{$ as ve}from"./Separator-mXU6o4ZK.js";import{a as pe}from"./Text-CW9rRGi5.js";import{b as ge,c as me,$ as Y}from"./CollectionBuilder-Bvhqn8Ns.js";import{d as Z,$ as F,g as G,e as xe,a as he}from"./mergeRefs--BPoweoc.js";import{$ as _}from"./filterDOMProps-CeZl_uWj.js";import{$ as Pe}from"./inertValue-CPObkqIT.js";import{r as n,R as c}from"./iframe-tng_7MnI.js";import{$ as De,a as ye}from"./useListState-Xg4w4G_U.js";import{$ as Se}from"./context-DF7MMgfI.js";import{a as Ee}from"./useCollator-B2nuGa8V.js";import{d as Ce,$ as Fe}from"./SelectionManager-Ci6gTmLN.js";import{b as Me,$ as ee,a as ke}from"./useFocusRing-DhOBCV_L.js";import{a as we}from"./useLabel-Xo2bW3MF.js";import{b as Ie}from"./usePress-GMQejvE6.js";import{q as Le,p as _e,g as J}from"./useFocus-DB2yX2jm.js";import{a as Be}from"./FocusScope-DGiBHAPP.js";const W=new WeakMap;function Ve(o){return typeof o=="string"?o.replace(/\s*/g,""):""+o}function He(o,e){let l=W.get(o);if(!l)throw new Error("Unknown list");return`${l.id}-option-${Ve(e)}`}function Ae(o,e,l){let i=_(o,{labelable:!0}),r=o.selectionBehavior||"toggle",d=o.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&d==="action"&&(d="override");let{listProps:t}=ue({...o,ref:l,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:d}),{focusWithinProps:a}=Me({onFocusWithin:o.onFocus,onBlurWithin:o.onBlur,onFocusWithinChange:o.onFocusChange}),f=Z(o.id);W.set(e,{id:f,shouldUseVirtualFocus:o.shouldUseVirtualFocus,shouldSelectOnPressUp:o.shouldSelectOnPressUp,shouldFocusOnHover:o.shouldFocusOnHover,isVirtualized:o.isVirtualized,onAction:o.onAction,linkBehavior:d});let{labelProps:p,fieldProps:s}=we({...o,id:f,labelElementType:"span"});return{labelProps:p,listBoxProps:F(i,a,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...F(s,t)})}}function Oe(o,e,l){var i,r;let{key:d}=o,t=W.get(e);var a;let f=(a=o.isDisabled)!==null&&a!==void 0?a:e.selectionManager.isDisabled(d);var p;let s=(p=o.isSelected)!==null&&p!==void 0?p:e.selectionManager.isSelected(d);var b;let u=(b=o.shouldSelectOnPressUp)!==null&&b!==void 0?b:t==null?void 0:t.shouldSelectOnPressUp;var v;let x=(v=o.shouldFocusOnHover)!==null&&v!==void 0?v:t==null?void 0:t.shouldFocusOnHover;var m;let g=(m=o.shouldUseVirtualFocus)!==null&&m!==void 0?m:t==null?void 0:t.shouldUseVirtualFocus;var h;let D=(h=o.isVirtualized)!==null&&h!==void 0?h:t==null?void 0:t.isVirtualized,C=G(),M=G(),y={role:"option","aria-disabled":f||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?s:void 0};Le()&&_e()||(y["aria-label"]=o["aria-label"],y["aria-labelledby"]=C,y["aria-describedby"]=M);let $=e.collection.getItem(d);if(D){let P=Number($==null?void 0:$.index);y["aria-posinset"]=Number.isNaN(P)?void 0:P+1,y["aria-setsize"]=fe(e.collection)}let k=t!=null&&t.onAction?()=>{var P;return t==null||(P=t.onAction)===null||P===void 0?void 0:P.call(t,d)}:void 0,V=He(e,d),{itemProps:w,isPressed:S,isFocused:E,hasAction:I,allowsSelection:H}=Ce({selectionManager:e.selectionManager,key:d,ref:l,shouldSelectOnPressUp:u,allowsDifferentPressOrigin:u&&x,isVirtualized:D,shouldUseVirtualFocus:g,isDisabled:f,onAction:k||!($==null||(i=$.props)===null||i===void 0)&&i.onAction?xe($==null||(r=$.props)===null||r===void 0?void 0:r.onAction,k):void 0,linkBehavior:t==null?void 0:t.linkBehavior,id:V}),{hoverProps:A}=ee({isDisabled:f||!x,onHoverStart(){J()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(d))}}),O=_($==null?void 0:$.props);delete O.id;let U=Ie($==null?void 0:$.props);return{optionProps:{...y,...F(O,w,A,U),id:V},labelProps:{id:C},descriptionProps:{id:M},isFocused:E,isFocusVisible:E&&e.selectionManager.isFocused&&J(),isSelected:s,isDisabled:f,isPressed:S,allowsSelection:H,hasAction:I}}function Ue(o){let{heading:e,"aria-label":l}=o,i=Z();return{itemProps:{role:"presentation"},headingProps:e?{id:i,role:"presentation"}:{},groupProps:{role:"group","aria-label":l,"aria-labelledby":e?i:void 0}}}const oe=n.createContext(null),B=n.createContext(null),fo=n.forwardRef(function(e,l){[e,l]=ie(e,l,oe);let i=n.useContext(B);return i?c.createElement(te,{state:i,props:e,listBoxRef:l}):c.createElement(ge,{content:c.createElement(me,e)},r=>c.createElement(Te,{props:e,listBoxRef:l,collection:r}))});function Te({props:o,listBoxRef:e,collection:l}){o={...o,collection:l,children:null,items:null};let{layoutDelegate:i}=n.useContext(T),r=ye({...o,layoutDelegate:i});return c.createElement(te,{state:r,props:o,listBoxRef:e})}function te({state:o,props:e,listBoxRef:l}){var i;let{filter:r,collectionProps:d,collectionRef:t}=n.useContext($e)||{};e=n.useMemo(()=>d?{...e,...d}:e,[e,d]);let{dragAndDropHooks:a,layout:f="stack",orientation:p="vertical"}=e;l=R(n.useMemo(()=>he(l,t!==void 0?t:null),[t,l]));let s=De(o,r),{collection:b,selectionManager:u}=s,v=!!(a!=null&&a.useDraggableCollectionState),x=!!(a!=null&&a.useDroppableCollectionState),{direction:m}=Se(),{disabledBehavior:g,disabledKeys:h}=u,D=Ee({usage:"search",sensitivity:"base"}),{isVirtualized:C,layoutDelegate:M,dropTargetDelegate:y,CollectionRoot:$}=n.useContext(T),k=n.useMemo(()=>e.keyboardDelegate||new Fe({collection:b,collator:D,ref:l,disabledKeys:h,disabledBehavior:g,layout:f,orientation:p,direction:m,layoutDelegate:M}),[b,D,l,g,h,p,m,e.keyboardDelegate,f,M]),{listBoxProps:V}=Ae({...e,shouldSelectOnPressUp:v||e.shouldSelectOnPressUp,keyboardDelegate:k,isVirtualized:C},s,l);n.useRef(v),n.useRef(x),n.useEffect(()=>{},[v,x]);let w,S,E,I=!1,H=null,A=n.useRef(null);if(v&&a){w=a.useDraggableCollectionState({collection:b,selectionManager:u,preview:a.renderDragPreview?A:void 0}),a.useDraggableCollection({},w,l);let K=a.DragPreview;H=a.renderDragPreview?c.createElement(K,{ref:A},a.renderDragPreview):null}if(x&&a){S=a.useDroppableCollectionState({collection:b,selectionManager:u});let K=a.dropTargetDelegate||y||new a.ListDropTargetDelegate(b,l,{orientation:p,layout:f,direction:m});E=a.useDroppableCollection({keyboardDelegate:k,dropTargetDelegate:K},S,l),I=S.isDropTarget({type:"root"})}let{focusProps:O,isFocused:U,isFocusVisible:P}=ke(),N=s.collection.size===0||s.collection.size===1&&((i=s.collection.getItem(s.collection.getFirstKey()))===null||i===void 0?void 0:i.type)==="loader",q={isDropTarget:I,isEmpty:N,isFocused:U,isFocusVisible:P,layout:e.layout||"stack",state:s},ae=L({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:q}),j=null;return N&&e.renderEmptyState&&(j=c.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(q))),c.createElement(Be,null,c.createElement("div",{..._(e),...F(V,O,E==null?void 0:E.collectionProps),...ae,ref:l,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":I||void 0,"data-empty":N||void 0,"data-focused":U||void 0,"data-focus-visible":P||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},c.createElement(Q,{values:[[oe,e],[B,s],[z,{dragAndDropHooks:a,dragState:w,dropState:S}],[ve,{elementType:"div"}],[ne,{render:Ne}],[le,{name:"ListBoxSection",render:ze}]]},c.createElement($,{collection:b,scrollRef:l,persistedKeys:se(u,a,S),renderDropIndicator:X(a,S)})),j,H))}function ze(o,e,l,i="react-aria-ListBoxSection"){let r=n.useContext(B),{dragAndDropHooks:d,dropState:t}=n.useContext(z),{CollectionBranch:a}=n.useContext(T),[f,p]=re();var s;let{headingProps:b,groupProps:u}=Ue({heading:p,"aria-label":(s=o["aria-label"])!==null&&s!==void 0?s:void 0}),v=L({defaultClassName:i,className:o.className,style:o.style,values:{}});return c.createElement("section",{..._(o),...u,...v,ref:e},c.createElement(be.Provider,{value:{...b,ref:f}},c.createElement(a,{collection:r.collection,parent:l,renderDropIndicator:X(d,t)})))}const $o=Y("item",function(e,l,i){let r=R(l),d=n.useContext(B),{dragAndDropHooks:t,dragState:a,dropState:f}=n.useContext(z),{optionProps:p,labelProps:s,descriptionProps:b,...u}=Oe({key:i.key,"aria-label":e==null?void 0:e["aria-label"]},d,r),{hoverProps:v,isHovered:x}=ee({isDisabled:!u.allowsSelection&&!u.hasAction,onHoverStart:i.props.onHoverStart,onHoverChange:i.props.onHoverChange,onHoverEnd:i.props.onHoverEnd}),m=null;a&&t&&(m=t.useDraggableItem({key:i.key},a));let g=null;f&&t&&(g=t.useDroppableItem({target:{type:"item",key:i.key,dropPosition:"on"}},f,r));let h=a&&a.isDragging(i.key),D=L({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...u,isHovered:x,selectionMode:d.selectionManager.selectionMode,selectionBehavior:d.selectionManager.selectionBehavior,allowsDragging:!!a,isDragging:h,isDropTarget:g==null?void 0:g.isDropTarget}});n.useEffect(()=>{i.textValue},[i.textValue]);let C=e.href?"a":"div";return c.createElement(C,{...F(p,v,m==null?void 0:m.dragProps,g==null?void 0:g.dropProps),...D,ref:r,"data-allows-dragging":!!a||void 0,"data-selected":u.isSelected||void 0,"data-disabled":u.isDisabled||void 0,"data-hovered":x||void 0,"data-focused":u.isFocused||void 0,"data-focus-visible":u.isFocusVisible||void 0,"data-pressed":u.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":(g==null?void 0:g.isDropTarget)||void 0,"data-selection-mode":d.selectionManager.selectionMode==="none"?void 0:d.selectionManager.selectionMode},c.createElement(Q,{values:[[pe,{slots:{[de]:s,label:s,description:b}}]]},D.children))});function Ne(o,e){e=R(e);let{dragAndDropHooks:l,dropState:i}=n.useContext(z),{dropIndicatorProps:r,isHidden:d,isDropTarget:t}=l.useDropIndicator(o,i,e);return d?null:c.createElement(Re,{...o,dropIndicatorProps:r,isDropTarget:t,ref:e})}function Ke(o,e){let{dropIndicatorProps:l,isDropTarget:i,...r}=o,d=L({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:i}});return c.createElement("div",{...l,...d,role:"option",ref:e,"data-drop-target":i||void 0})}const Re=n.forwardRef(Ke);Y("loader",function(e,l,i){let r=n.useContext(B),{isVirtualized:d}=n.useContext(T),{isLoading:t,onLoadMore:a,scrollOffset:f,...p}=e,s=n.useRef(null),b=n.useMemo(()=>({onLoadMore:a,collection:r==null?void 0:r.collection,sentinelRef:s,scrollOffset:f}),[a,f,r==null?void 0:r.collection]);ce(b,s);let u=L({...p,id:void 0,children:i.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),v={tabIndex:-1};return d&&(v["aria-posinset"]=i.index+1,v["aria-setsize"]=r.collection.size),c.createElement(c.Fragment,null,c.createElement("div",{style:{position:"relative",width:0,height:0},inert:Pe(!0)},c.createElement("div",{"data-testid":"loadMoreSentinel",ref:s,style:{position:"absolute",height:1,width:1}})),t&&u.children&&c.createElement("div",{...F(_(e),v),...u,role:"option",ref:l},u.children))});export{oe as $,B as a,fo as b,$o as c,W as d,He as e};
