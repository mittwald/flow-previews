import{r as d,R as s}from"./index-Cs7sjTYM.js";import{s as Q}from"./ContextMenu.module-68N5lvfm.js";import{f as B}from"./flowComponent-D7ioKQ_2.js";import{P as xe}from"./PopoverTrigger-CPvHHhEu.js";import{C as ve,P as O}from"./PropsContextProvider-BmJWDS_p.js";import{h as he,k as R,l as Pe,m as Ce,u as Me,O as Ke,c as Se}from"./OverlayTrigger-oVkQhLAu.js";import{A as Ee}from"./Action-BlvwaV-k.js";import{c as Y}from"./clsx-B-dksMZM.js";import"./IconApp-BOae6dD3.js";import{F as ke,G as Ie,B as we,D as Te}from"./IconWarning-BGVP9Fx9.js";import{T as X}from"./Text-rn9R6Aq3.js";import{d as Fe}from"./deepFindOfType-BylCc5Xi.js";import{W as De}from"./Wrap-DQq6jo70.js";import{a as Z,b as Ne,c as _e}from"./Collection-BSVICx61.js";import{f as H,$ as ee,c as Oe,b as Re,a as U,d as Ae}from"./utils-Bcr9fq-m.js";import{a as Be}from"./Header-R7RwfTAD.js";import{a as He}from"./Separator-BzhAqcSZ.js";import{a as Ue}from"./Text-KzcdCwWD.js";import{b as Ve,c as ze,d as We}from"./CollectionBuilder-C1pJ_vaJ.js";import{b as V,e as _,a as qe}from"./index-C8LjR2Bd.js";import{$ as k}from"./filterDOMProps-CeZl_uWj.js";import{a as Le,d as je}from"./OverlayArrow-ZcRxrH45.js";import{a as te,k as Ge,f as Je,b as Qe}from"./useFocusRing-CRCkdtud.js";import{$ as Xe,a as Ye,b as Ze}from"./useMenuTrigger-KFsGyysD.js";import{a as et,$ as tt,b as ot}from"./usePress-Do5SRlXR.js";import{b as nt}from"./useFocusable-B6dIjavV.js";import{c as rt,$ as at,a as st,b as lt}from"./SelectionManager-D54GM_Uc.js";import{a as it}from"./FocusScope-CGKzeA_Y.js";import{$ as ct}from"./useControlledState-B7K2eYzO.js";const oe=new WeakMap;function dt(o,e,t){let{shouldFocusWrap:a=!0,onKeyDown:n,onKeyUp:l,...r}=o;!o["aria-label"]&&!o["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let i=k(o,{labelable:!0}),{listProps:u}=Xe({...r,ref:t,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:a,linkBehavior:"override"});return oe.set(e,{onClose:o.onClose,onAction:o.onAction}),{menuProps:V(i,{onKeyDown:n,onKeyUp:l},{role:"menu",...u,onKeyDown:c=>{c.key!=="Escape"&&u.onKeyDown(c)}})}}function ut(o,e,t){let{id:a,key:n,closeOnSelect:l,isVirtualized:r,"aria-haspopup":i,onPressStart:u,onPressUp:c,onPress:p,onPressChange:b,onPressEnd:m,onHoverStart:$,onHoverChange:h,onHoverEnd:x,onKeyDown:y,onKeyUp:P,onFocus:I,onFocusChange:se,onBlur:le}=o,v=!!i;var w;let C=(w=o.isDisabled)!==null&&w!==void 0?w:e.selectionManager.isDisabled(n);var T;let W=(T=o.isSelected)!==null&&T!==void 0?T:e.selectionManager.isSelected(n),F=oe.get(e),g=e.collection.getItem(n),M=o.onClose||F.onClose,ie=et(),q=f=>{var N;if(!v){if(!(g==null||(N=g.props)===null||N===void 0)&&N.onAction?g.props.onAction():o.onAction&&o.onAction(n),F.onAction){let ge=F.onAction;ge(n)}f.target instanceof HTMLAnchorElement&&ie.open(f.target,f,g.props.href,g.props.routerOptions)}},D="menuitem";v||(e.selectionManager.selectionMode==="single"?D="menuitemradio":e.selectionManager.selectionMode==="multiple"&&(D="menuitemcheckbox"));let L=_(),j=_(),G=_(),S={id:a,"aria-disabled":C||void 0,role:D,"aria-label":o["aria-label"],"aria-labelledby":L,"aria-describedby":[j,G].filter(Boolean).join(" ")||void 0,"aria-controls":o["aria-controls"],"aria-haspopup":i,"aria-expanded":o["aria-expanded"]};e.selectionManager.selectionMode!=="none"&&!v&&(S["aria-checked"]=W),r&&(S["aria-posinset"]=g==null?void 0:g.index,S["aria-setsize"]=Ye(e.collection));let ce=f=>{f.pointerType==="keyboard"&&q(f),u==null||u(f)},de=f=>{f.pointerType!=="keyboard"&&(q(f),!v&&M&&(l??(e.selectionManager.selectionMode!=="multiple"||e.selectionManager.isLink(n)))&&M()),c==null||c(f)},{itemProps:E,isFocused:ue}=rt({selectionManager:e.selectionManager,key:n,ref:t,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none"}),{pressProps:fe,isPressed:pe}=tt({onPressStart:ce,onPress:p,onPressUp:de,onPressChange:b,onPressEnd:m,isDisabled:C}),{hoverProps:be}=te({isDisabled:C,onHoverStart(f){Ge()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(n)),$==null||$(f)},onHoverChange:h,onHoverEnd:x}),{keyboardProps:me}=nt({onKeyDown:f=>{if(f.repeat){f.continuePropagation();return}switch(f.key){case" ":!C&&e.selectionManager.selectionMode==="none"&&!v&&l!==!1&&M&&M();break;case"Enter":!C&&l!==!1&&!v&&M&&M();break;default:v||f.continuePropagation(),y==null||y(f);break}},onKeyUp:P}),{focusProps:$e}=Je({onBlur:le,onFocus:I,onFocusChange:se}),J=k(g.props);delete J.id;let ye=ot(g.props);return{menuItemProps:{...S,...V(J,ye,v?{onFocus:E.onFocus,"data-key":E["data-key"]}:E,fe,be,me,$e),tabIndex:E.tabIndex!=null?-1:void 0},labelProps:{id:L},descriptionProps:{id:j},keyboardShortcutProps:{id:G},isFocused:ue,isSelected:W,isPressed:pe,isDisabled:C}}function ft(o){let{heading:e,"aria-label":t}=o,a=qe();return{itemProps:{role:"presentation"},headingProps:e?{id:a,role:"presentation"}:{},groupProps:{role:"group","aria-label":t,"aria-labelledby":e?a:void 0}}}function pt(o){let e=Le(o),[t,a]=d.useState(null),[n,l]=d.useState([]),r=()=>{l([]),e.close()};return{focusStrategy:t,...e,open(c=null){a(c),e.open()},toggle(c=null){a(c),e.toggle()},close(){r()},expandedKeysStack:n,openSubmenu:(c,p)=>{l(b=>p>b.length?b:[...b.slice(0,p),c])},closeSubmenu:(c,p)=>{l(b=>b[p]===c?b.slice(0,p):b)}}}class bt{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);return t?t.prevKey:null}getKeyAfter(e){let t=this.keyMap.get(e);return t?t.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){this.keyMap=new Map,this.iterable=e,t=t||new Set;let a=r=>{if(this.keyMap.set(r.key,r),r.childNodes&&(r.type==="section"||t.has(r.key)))for(let i of r.childNodes)a(i)};for(let r of e)a(r);let n,l=0;for(let[r,i]of this.keyMap)n?(n.nextKey=r,i.prevKey=n.key):(this.firstKey=r,i.prevKey=void 0),i.type==="item"&&(i.index=l++),n=i,n.nextKey=void 0;this.lastKey=n==null?void 0:n.key}}function mt(o){let{onExpandedChange:e}=o,[t,a]=ct(o.expandedKeys?new Set(o.expandedKeys):void 0,o.defaultExpandedKeys?new Set(o.defaultExpandedKeys):new Set,e),n=at(o),l=d.useMemo(()=>o.disabledKeys?new Set(o.disabledKeys):new Set,[o.disabledKeys]),r=st(o,d.useCallback(u=>new bt(u,{expandedKeys:t}),[t]),null);return d.useEffect(()=>{n.focusedKey!=null&&!r.getItem(n.focusedKey)&&n.setFocusedKey(null)},[r,n.focusedKey]),{collection:r,expandedKeys:t,disabledKeys:l,toggleKey:u=>{a($t(t,u))},setExpandedKeys:a,selectionManager:new lt(r,n)}}function $t(o,e){let t=new Set(o);return t.has(e)?t.delete(e):t.add(e),t}const yt=d.createContext({}),ne=d.createContext(null),z=d.createContext(null),re=d.createContext(null);function gt(o){let e=pt(o),t=d.useRef(null),{menuTriggerProps:a,menuProps:n}=Ze({...o,type:"menu"},e,t),[l,r]=d.useState(null),i=d.useCallback(()=>{t.current&&r(t.current.offsetWidth+"px")},[t]);je({ref:t,onResize:i});let u=d.useRef(null);return s.createElement(H,{values:[[ne,{...n,ref:u}],[he,e],[re,e],[R,{trigger:"MenuTrigger",triggerRef:t,scrollRef:u,placement:"bottom start",style:{"--trigger-width":l}}]]},s.createElement(Pe,{...a,ref:t,isPressed:e.isOpen},o.children))}const xt=d.createContext(null);function vt(o,e){return[o,e]=ee(o,e,ne),s.createElement(ze,{content:s.createElement(We,o)},t=>t.size>0&&s.createElement(ht,{props:o,collection:t,menuRef:e}))}function ht({props:o,collection:e,menuRef:t}){let a=mt({...o,collection:e,children:void 0}),[n,l]=d.useState(null),{isVirtualized:r,CollectionRoot:i}=d.useContext(Z),{menuProps:u}=dt({...o,isVirtualized:r},a,t),c=d.useContext(re),p=d.useContext(R),b=(p==null?void 0:p.trigger)==="SubmenuTrigger";Ce({ref:t,onInteractOutside:y=>{c&&!(n!=null&&n.contains(y.target))&&c.close()},isDisabled:b||(c==null?void 0:c.expandedKeysStack.length)===0});let m=d.useRef(null),[$,h]=d.useState({left:0});d.useEffect(()=>{if(n&&m.current!==n&&$.left===0){m.current=n;let{left:y}=n.getBoundingClientRect();h({left:-1*y})}},[$,n]);let x=U({defaultClassName:"react-aria-Menu",className:o.className,style:o.style,values:{}});return s.createElement(it,null,s.createElement("div",{...k(o),...u,...x,ref:t,slot:o.slot||void 0,onScroll:o.onScroll},s.createElement(H,{values:[[z,a],[He,{elementType:"div"}],[R,{UNSTABLE_portalContainer:n||void 0}],[Ne,{render:Ct}],[xt,{parentMenuRef:t}],[A,null]]},s.createElement(i,{collection:e,persistedKeys:_e(a.selectionManager.focusedKey),scrollRef:t}))),s.createElement("div",{ref:l,style:{width:"100vw",position:"absolute",top:0,...$}}))}const Pt=d.forwardRef(vt);function Ct(o,e,t){var a,n;let l=d.useContext(z),{CollectionBranch:r}=d.useContext(Z),[i,u]=Ae();var c;let{headingProps:p,groupProps:b}=ft({heading:u,"aria-label":(c=t.props["aria-label"])!==null&&c!==void 0?c:void 0}),m=U({defaultClassName:"react-aria-Section",className:(a=t.props)===null||a===void 0?void 0:a.className,style:(n=t.props)===null||n===void 0?void 0:n.style,values:{}});return s.createElement("section",{...k(o),...b,...m,ref:e},s.createElement(Be.Provider,{value:{...p,ref:i}},s.createElement(r,{collection:l.collection,parent:t})))}const A=d.createContext(null),Mt=Ve("item",function(e,t,a){var n;[e,t]=ee(e,t,A);let l=(n=Oe(A))===null||n===void 0?void 0:n.id,r=d.useContext(z),i=Re(t),{menuItemProps:u,labelProps:c,descriptionProps:p,keyboardShortcutProps:b,...m}=ut({...e,id:l,key:a.key},r,i),{isFocusVisible:$,focusProps:h}=Qe(),{hoverProps:x,isHovered:y}=te({isDisabled:m.isDisabled}),P=U({...e,id:void 0,children:a.rendered,defaultClassName:"react-aria-MenuItem",values:{...m,isHovered:y,isFocusVisible:$,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,hasSubmenu:!!e["aria-haspopup"],isOpen:e["aria-expanded"]==="true"}}),I=e.href?"a":"div";return s.createElement(I,{...V(u,h,x),...P,ref:i,"data-disabled":m.isDisabled||void 0,"data-hovered":y||void 0,"data-focused":m.isFocused||void 0,"data-focus-visible":$||void 0,"data-pressed":m.isPressed||void 0,"data-selected":m.isSelected||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode,"data-has-submenu":!!e["aria-haspopup"]||void 0,"data-open":e["aria-expanded"]==="true"||void 0},s.createElement(H,{values:[[Ue,{slots:{label:c,description:p}}],[yt,b]]},P.children))}),Kt=B("ContextMenu",o=>{const{children:e,onAction:t,selectionMode:a,selectedKeys:n,defaultSelectedKeys:l,disabledKeys:r,onSelectionChange:i,refProp:u,controller:c,width:p,...b}=o,m=Me("ContextMenu",{reuseControllerFromContext:!0}),$=c??m,h=a==="navigation"?"none":a,x=a==="navigation"?"navigation":"control",y={MenuItem:{selectionVariant:x},Section:{MenuItem:{selectionVariant:x},renderContextMenuSection:!0}},P=a==="single"||a==="navigation"?"ContextMenu":void 0;return s.createElement(ve,null,s.createElement(xe,{width:p,...b,contentClassName:Q.popoverContent,controller:$,isDialogContent:!1},s.createElement(Ke,{type:"ContextMenu",controller:$},s.createElement(Pt,{className:Q.contextMenu,onAction:t,selectionMode:h,selectedKeys:n,defaultSelectedKeys:l,disabledKeys:r,onSelectionChange:i,ref:u},s.createElement(O,{props:y},s.createElement(Ee,{closeOverlay:P},e))))))});Kt.__docgenInfo={description:"",methods:[],displayName:"ContextMenu"};const St="flow--menu-item",Et="flow--menu-item--icon",kt="flow--menu-item--text",It="flow--menu-item--control-icon",K={menuItem:St,icon:Et,text:kt,controlIcon:It},wt=(o,e)=>!!Fe(o,e),ae=o=>{const{selectionMode:e,isSelected:t,selectionVariant:a="control",children:n}=o,l={Icon:{className:K.icon},Text:{className:K.text}},r={Icon:{className:Y(K.controlIcon,K.icon)}},i=e==="none"||a==="navigation"?null:e==="single"&&t?s.createElement(ke,null):e==="single"&&!t?s.createElement(Ie,null):e==="multiple"&&t?s.createElement(we,null):s.createElement(Te,null),u=wt(n,X);return s.createElement(s.Fragment,null,s.createElement(O,{props:r},i),s.createElement(O,{props:l},s.createElement(De,{if:!u},s.createElement(X,null,n))))};ae.__docgenInfo={description:"",methods:[],displayName:"MenuItemContent",props:{selectionVariant:{required:!1,tsType:{name:"union",raw:'"control" | "navigation"',elements:[{name:"literal",value:'"control"'},{name:"literal",value:'"navigation"'}]},description:""}},composes:["PropsWithChildren"]};const Tt=B("MenuItem",o=>{const{children:e,className:t,selectionVariant:a,refProp:n,...l}=o,r=Y(K.menuItem,t);return s.createElement(Mt,{...l,className:r,ref:n},i=>s.createElement(ae,{...i,selectionVariant:a},e))});Tt.__docgenInfo={description:"",methods:[],displayName:"MenuItem"};const Ft=B("ContextMenuTrigger",o=>{const{children:e,...t}=o;return s.createElement(Se,{overlayType:"ContextMenu",...t,component:gt},e)});Ft.__docgenInfo={description:"",methods:[],displayName:"ContextMenuTrigger",props:{tunnelId:{required:!1,tsType:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]},description:"@internal"},wrapWith:{required:!1,tsType:{name:"ReactElement"},description:""},isDefaultOpen:{required:!1,tsType:{name:"boolean"},description:""},children:{required:!0,tsType:{name:"ReactNode"},description:""},controller:{required:!1,tsType:{name:"OverlayController"},description:""}}};export{Kt as C,Tt as M,Ft as a};
