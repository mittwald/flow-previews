import{r as i,R as p,j as m}from"./iframe-Da9Lw8R_.js";import{c as V}from"./clsx-B-dksMZM.js";import{u as _}from"./useOverlayController-DXJN5Feb.js";import{O as H}from"./OverlayContextProvider-BnH0GpUl.js";import{L as W}from"./LoadingSpinner-DXGsR4uF.js";import{v as L}from"./flowComponent-DSxpIroI.js";import{u as k}from"./Button-CkcTXATp.js";import{$ as z,b as P,a as T,d as A}from"./utils-Cwd4tFKX.js";import{h as B,i as U,j as K,k as G,l as g,m as J,n as Q,b as X}from"./Dialog-Cw1z9AtQ.js";import{e as M,$ as x,a as Y}from"./index-CM0YhoHL.js";import{$ as N}from"./filterDOMProps-BNnC3YgW.js";import{a as Z}from"./useCollator-D6vsHj3W.js";import{$ as E}from"./SelectionManager-42CnKCgE.js";import{d as ee,e as O,f as D}from"./OverlayArrow-Cf3S1QD1.js";let c=typeof document<"u"&&window.visualViewport;function te(){let t=M(),[e,n]=i.useState(()=>t?{width:0,height:0}:R());return i.useEffect(()=>{let r=()=>{c&&c.scale>1||n(l=>{let a=R();return a.width===l.width&&a.height===l.height?l:a})},o,s=l=>{c&&c.scale>1||E(l.target)&&(o=requestAnimationFrame(()=>{(!document.activeElement||!E(document.activeElement))&&n(a=>{let d={width:window.innerWidth,height:window.innerHeight};return d.width===a.width&&d.height===a.height?a:d})}))};return window.addEventListener("blur",s,!0),c?c.addEventListener("resize",r):window.addEventListener("resize",r),()=>{cancelAnimationFrame(o),window.removeEventListener("blur",s,!0),c?c.removeEventListener("resize",r):window.removeEventListener("resize",r)}},[]),e}function R(){return{width:c?c.width*c.scale:window.innerWidth,height:c?c.height*c.scale:window.innerHeight}}function ne(t,e,n){let{overlayProps:r,underlayProps:o}=B({...t,isOpen:e.isOpen,onClose:e.close},n);return U({isDisabled:!e.isOpen}),K(),i.useEffect(()=>{if(e.isOpen&&n.current)return G([n.current],{shouldUseInert:!0})},[e.isOpen,n]),{modalProps:x(r),underlayProps:o}}const ae=i.createContext(null),y=i.createContext(null),re=i.forwardRef(function(e,n){if(i.useContext(y))return p.createElement(S,{...e,modalRef:n},e.children);let{isDismissable:o,isKeyboardDismissDisabled:s,isOpen:l,defaultOpen:a,onOpenChange:d,children:f,isEntering:$,isExiting:u,UNSTABLE_portalContainer:h,shouldCloseOnInteractOutside:b,...v}=e;return p.createElement(j,{isDismissable:o,isKeyboardDismissDisabled:s,isOpen:l,defaultOpen:a,onOpenChange:d,isEntering:$,isExiting:u,UNSTABLE_portalContainer:h,shouldCloseOnInteractOutside:b},p.createElement(S,{...v,modalRef:n},f))});function ie(t,e){[t,e]=z(t,e,ae);let n=i.useContext(g),r=ee(t),o=t.isOpen!=null||t.defaultOpen!=null||!n?r:n,s=P(e),l=i.useRef(null),a=O(s,o.isOpen),d=O(l,o.isOpen),f=a||d||t.isExiting||!1,$=M();return!o.isOpen&&!f||$?null:p.createElement(oe,{...t,state:o,isExiting:f,overlayRef:s,modalRef:l})}const j=i.forwardRef(ie);function oe({UNSTABLE_portalContainer:t,...e}){let n=e.modalRef,{state:r}=e,{modalProps:o,underlayProps:s}=ne(e,r,n),l=D(e.overlayRef)||e.isEntering||!1,a=T({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:l,isExiting:e.isExiting,state:r}}),d=te(),f;if(typeof document<"u"){let u=Z(document.body)?document.body:document.scrollingElement||document.documentElement,h=u.getBoundingClientRect().height%1;f=u.scrollHeight-h}let $={...a.style,"--visual-viewport-height":d.height+"px","--page-height":f!==void 0?f+"px":void 0};return p.createElement(Q,{isExiting:e.isExiting,portalContainer:t},p.createElement("div",{...x(N(e,{global:!0}),s),...a,style:$,ref:e.overlayRef,"data-entering":l||void 0,"data-exiting":e.isExiting||void 0},p.createElement(A,{values:[[y,{modalProps:o,modalRef:n,isExiting:e.isExiting,isDismissable:e.isDismissable}],[g,r]]},a.children)))}function S(t){let{modalProps:e,modalRef:n,isExiting:r,isDismissable:o}=i.useContext(y),s=i.useContext(g),l=i.useMemo(()=>Y(t.modalRef,n),[t.modalRef,n]),a=P(l),d=D(a),f=T({...t,defaultClassName:"react-aria-Modal",values:{isEntering:d,isExiting:r,state:s}});return p.createElement("div",{...x(N(t,{global:!0}),e),...f,ref:a,"data-entering":d||void 0,"data-exiting":r||void 0},o&&p.createElement(J,{onDismiss:s.close}),f.children)}const se="flow--overlay",q={overlay:se},w=i.memo(t=>{const e=i.useContext(L).LoadingSpinner??W;return m.jsx(e,{...t})});w.displayName="LoadingSpinnerView";w.__docgenInfo={description:"",methods:[],displayName:"LoadingSpinnerView"};const F=()=>(k(),m.jsx(w,{color:"dark"}));F.__docgenInfo={description:"",methods:[],displayName:"OverlaySuspenseFallback"};const I=t=>{const{children:e,className:n,...r}=t,[o,s]=i.useState(!1),l=()=>(i.useLayoutEffect(()=>(s(!0),()=>s(!1)),[s]),m.jsx(F,{...r})),a=o?q.overlay:n;return m.jsx(j,{...r,className:a,children:m.jsx(re,{children:m.jsx(i.Suspense,{fallback:m.jsx(l,{}),children:m.jsx(X,{children:e})})})})};I.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"OverlayContent",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:""},isDismissable:{required:!1,tsType:{name:"boolean"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:""}},composes:["PropsWithChildren","PropsWithClassName"]};const C=i.memo(t=>{const e=i.useContext(L).OverlayContent??I;return m.jsx(e,{...t})});C.displayName="OverlayContentView";C.__docgenInfo={description:"",methods:[],displayName:"OverlayContentView"};const le=t=>{const{controller:e,children:n,isDismissable:r=!0,className:o,overlayType:s="Modal",isOpen:l,ref:a,unsavedChangesConfirmationController:d,disableUnsavedChangesConfirmation:f}=t,$=_(s,{reuseControllerFromContext:!0}),u=e??$,h=l??u.useIsOpen(),b=V(q.overlay,o);return m.jsx(m.Fragment,{children:m.jsx(C,{onOpenChange:v=>{s==="Modal"&&u.confirmUnsavedChanges&&!f&&!v?d?.open():u.setOpen(v)},isOpen:h,ref:a,isDismissable:r,className:b,children:m.jsx(H,{type:"Modal",controller:u,children:n})})})};le.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},controller:{required:!1,tsType:{name:"OverlayController"},description:"The controller to control the overlay state."},isDismissable:{required:!1,tsType:{name:"boolean"},description:"Whether the overlay can be closed by clicking outside of it."},overlayType:{required:!1,tsType:{name:"union",raw:'"Modal" | "LightBox"',elements:[{name:"literal",value:'"Modal"'},{name:"literal",value:'"LightBox"'}]},description:"Whether the overlay is a modal or a light box."},isOpen:{required:!1,tsType:{name:"boolean"},description:""},unsavedChangesConfirmationController:{required:!1,tsType:{name:"OverlayController"},description:"The controller to show the unsaved changes confirmation modal."},disableUnsavedChangesConfirmation:{required:!1,tsType:{name:"boolean"},description:"Disables the confirmation dialog when there are unsaved changes."}},composes:["PropsWithChildren","PropsWithClassName"]};export{w as L,le as O};
