import{j as r}from"./iframe-Da9Lw8R_.js";import{$ as w,a as P}from"./useFormValidation-DjSyrx87.js";import{$ as j}from"./FieldError-DSdSdK3H.js";import{b as v}from"./utils-Cwd4tFKX.js";import{P as x,f as R}from"./flowComponent-DSxpIroI.js";import{a as B}from"./Input-inZV5DIC.js";import"./browser-DDWH8I0V.js";import{u as A}from"./useFieldComponent-yufHgNqa.js";const l="mittwald.flow-core.file.awaitedArrayBuffer";function q(e){return l in e&&e[l]instanceof ArrayBuffer&&!e[l].detached}const T=async e=>{if(q(e))return e;const n=await e.arrayBuffer();return Object.assign(e,{[l]:n}),e},E="flow--file-field--file-input",V="flow--file-field--trigger",g={FileInput:E,trigger:V},F=e=>{const{children:n,isDisabled:d,onChange:t,isReadOnly:f,ref:p,...s}=e,i=v(p),a=()=>{i.current?.value&&(i.current.value="",t?.(null)),i.current?.click()},c=m=>{t?.(m.target.files)},u={Button:{onPress:a,className:g.trigger,isDisabled:d,isReadOnly:f}};return r.jsxs(x,{props:u,children:[n,r.jsx(B,{...s,className:g.FileInput,type:"file",ref:i,onChange:c})]})};F.__docgenInfo={description:"@internal",methods:[],displayName:"FileInput",props:{onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(files: FileList | null) => void",signature:{arguments:[{type:{name:"union",raw:"FileList | null",elements:[{name:"FileList"},{name:"null"}]},name:"files"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLInputElement"}],raw:"Ref<HTMLInputElement>"},description:""},isReadOnly:{required:!1,tsType:{name:"boolean"},description:""}},composes:["PropsWithChildren"]};const N=R("FileField",e=>{const{children:n,ref:d,isRequired:t,isInvalid:f,isDisabled:p,validationBehavior:s,onChange:i,isReadOnly:a,...c}=e,{FieldErrorView:u,FieldErrorCaptureContext:m,fieldProps:$,fieldPropsContext:b}=A(e),y=v(d),o=w({value:void 0,validationBehavior:s,isInvalid:f});P({validationBehavior:s},o,y);const C={...c,"aria-invalid":o.displayValidation.isInvalid,value:void 0},I=h=>{h&&i&&Promise.all(Array.from(h).map(T)).then(()=>i(h))};return r.jsx("div",{...$,children:r.jsxs(j.Provider,{value:o.displayValidation,children:[r.jsx(m,{children:r.jsx(x,{props:b,children:r.jsx("div",{"data-readonly":a,"data-required":!!t||void 0,"data-invalid":o.displayValidation.isInvalid||void 0,children:r.jsx(F,{ref:y,isReadOnly:a,onChange:a?void 0:I,isDisabled:p,...C,children:n})})})}),r.jsx(u,{})]})})});N.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"FileField"};export{N as F,T as a};
