import{r as n,R as C,j as M}from"./iframe-EtTbRQoM.js";import{f as G,P as J,N as Q,R as Y}from"./flowComponent-CRP3amPt.js";import{f as K}from"./FormField.module-CqWyJNQI.js";import{F as Z}from"./FieldError-Bx65Dx0T.js";import{c as _}from"./clsx-B-dksMZM.js";import{c as ee}from"./IconWarning-CO-lUcxm.js";import{$ as le,a as te,b as ae}from"./Option-BJgdrxpo.js";import{u as oe}from"./useOverlayController-BhlWBiph.js";import{$ as T,c as z,a as H,f as re,g as ie,d as ne,b as se}from"./utils-C_hvyJpn.js";import{u as de}from"./useMakeFocusable-qjH8k0Qb.js";import{$ as L,a as ce}from"./Button-qX7xBgDX.js";import{a as ue}from"./FieldError-Dm1dzE4u.js";import{a as fe,$ as me}from"./Form-CyJo_kk3.js";import{$ as be}from"./intlStrings-ZMTSFH_M.js";import{b as W}from"./Label-FPs7V2cE.js";import{l as $e,h as ve,m as pe}from"./Dialog-D4gVf8vR.js";import{a as k}from"./Text-CANjZEUs.js";import{e as ge}from"./CollectionBuilder-DTV-m0tl.js";import{b as ye}from"./Hidden-BhWY_xu3.js";import{$ as O,f as xe,e as he}from"./index-DwnAt2PO.js";import{$ as q}from"./filterDOMProps-i7L6S0l1.js";import{c as Pe,g as Se}from"./OverlayArrow-CczkULsk.js";import{$ as Ce}from"./context-HEbrZrvP.js";import{$ as Fe}from"./useLocalizedStringFormatter-FAUwXJff.js";import{b as Re,$ as Me}from"./useFormValidation-CisZkPpg.js";import{$ as De}from"./useListState-Bda54Xva.js";import{$ as Ie}from"./useControlledState-DmCe06Ai.js";import{a as Ee}from"./useFocusRing-hCmULEnE.js";import{a as Ke,i as Ve}from"./SelectionManager-DfS84ysN.js";import{E as Be}from"./useFocus-9RWBE5qv.js";import{b as we}from"./useCollator-CjrbHKqV.js";import{$ as Oe}from"./useFormReset-B1BZ1rNK.js";import{a as ke}from"./VisuallyHidden-B8Lwuqmn.js";function qe(e={}){let{locale:l}=Ce();return n.useMemo(()=>new Intl.ListFormat(l,e),[l,e])}const A=new WeakMap;function Ae(e,l,d){let{keyboardDelegate:f,isDisabled:a,isRequired:b,name:v,form:t,validationBehavior:u="aria"}=e,m=we({usage:"search",sensitivity:"base"}),o=n.useMemo(()=>f||new Ke(l.collection,l.disabledKeys,d,m),[f,l.collection,l.disabledKeys,m,d]),{menuTriggerProps:c,menuProps:p}=$e({isDisabled:a,type:"listbox"},l,d),$=g=>{if(l.selectionManager.selectionMode!=="multiple")switch(g.key){case"ArrowLeft":{var D,I;g.preventDefault();let E=l.selectedKey!=null?(D=o.getKeyAbove)===null||D===void 0?void 0:D.call(o,l.selectedKey):(I=o.getFirstKey)===null||I===void 0?void 0:I.call(o);E&&l.setSelectedKey(E);break}case"ArrowRight":{var B,w;g.preventDefault();let E=l.selectedKey!=null?(B=o.getKeyBelow)===null||B===void 0?void 0:B.call(o,l.selectedKey):(w=o.getFirstKey)===null||w===void 0?void 0:w.call(o);E&&l.setSelectedKey(E);break}}},{typeSelectProps:s}=Ve({keyboardDelegate:o,selectionManager:l.selectionManager,onTypeSelect(g){l.setSelectedKey(g)}}),{isInvalid:y,validationErrors:P,validationDetails:i}=l.displayValidation,{labelProps:x,fieldProps:S,descriptionProps:r,errorMessageProps:F}=fe({...e,labelElementType:"span",isInvalid:y,errorMessage:e.errorMessage||P});s.onKeyDown=s.onKeyDownCapture,delete s.onKeyDownCapture,l.selectionManager.selectionMode==="multiple"&&(s={});let R=q(e,{labelable:!0}),h=O(s,c,S),V=xe();return A.set(l,{isDisabled:a,isRequired:b,name:v,form:t,validationBehavior:u}),{labelProps:{...x,onClick:()=>{if(!e.isDisabled){var g;(g=d.current)===null||g===void 0||g.focus(),Be("keyboard")}}},triggerProps:O(R,{...h,isDisabled:a,onKeyDown:he(h.onKeyDown,$,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[V,h["aria-labelledby"],h["aria-label"]&&!h["aria-labelledby"]?h.id:null].filter(Boolean).join(" "),onFocus(g){l.isFocused||(e.onFocus&&e.onFocus(g),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(g){l.isOpen||(e.onBlur&&e.onBlur(g),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:V},menuProps:{...p,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:g=>{g.currentTarget.contains(g.relatedTarget)||(e.onBlur&&e.onBlur(g),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[S["aria-labelledby"],h["aria-label"]&&!S["aria-labelledby"]?h.id:null].filter(Boolean).join(" ")},descriptionProps:r,errorMessageProps:F,isInvalid:y,validationErrors:P,validationDetails:i,hiddenSelectProps:{isDisabled:a,name:v,label:e.label,state:l,triggerRef:d,form:t}}}function je(e,l,d){let f=A.get(l)||{},{autoComplete:a,name:b=f.name,form:v=f.form,isDisabled:t=f.isDisabled}=e,{validationBehavior:u,isRequired:m}=f,{visuallyHiddenProps:o}=ke({style:{position:"fixed",top:0,left:0}});Oe(e.selectRef,l.defaultValue,l.setValue),Re({validationBehavior:u,focus:()=>{var s;return(s=d.current)===null||s===void 0?void 0:s.focus()}},l,e.selectRef);let c=l.setValue,p=n.useCallback(s=>{s.target.multiple?c(Array.from(s.target.selectedOptions,y=>y.value)):c(s.currentTarget.value)},[c]);var $;return{containerProps:{...o,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:a,disabled:t,multiple:l.selectionManager.selectionMode==="multiple",required:u==="native"&&m,name:b,form:v,value:($=l.value)!==null&&$!==void 0?$:"",onChange:p,onInput:p}}}function Ne(e){let{state:l,triggerRef:d,label:f,name:a,form:b,isDisabled:v}=e,t=n.useRef(null),u=n.useRef(null),{containerProps:m,selectProps:o}=je({...e,selectRef:l.collection.size<=300?t:u},l,d);if(l.collection.size<=300)return C.createElement("div",{...m,"data-testid":"hidden-select-container"},C.createElement("label",null,f,C.createElement("select",{...o,ref:t},C.createElement("option",null),[...l.collection.getKeys()].map(c=>{let p=l.collection.getItem(c);if(p&&p.type==="item")return C.createElement("option",{key:p.key,value:p.key},p.textValue)}))));if(a){let c=A.get(l)||{},{validationBehavior:p}=c,$=Array.isArray(l.value)?l.value:[l.value];$.length===0&&($=[null]);let s=$.map((y,P)=>{let i={type:"hidden",autoComplete:o.autoComplete,name:a,form:b,disabled:v,value:y??""};return p==="native"?C.createElement("input",{key:P,...i,ref:P===0?u:null,style:{display:"none"},type:"text",required:P===0?o.required:!1,onChange:()=>{}}):C.createElement("input",{key:P,...i,ref:P===0?u:null})});return C.createElement(C.Fragment,null,s)}return null}function Te(e){let{selectionMode:l="single"}=e,d=Pe(e),[f,a]=n.useState(null),b=n.useMemo(()=>{var r;return e.defaultValue!==void 0?e.defaultValue:l==="single"?(r=e.defaultSelectedKey)!==null&&r!==void 0?r:null:[]},[e.defaultValue,e.defaultSelectedKey,l]),v=n.useMemo(()=>e.value!==void 0?e.value:l==="single"?e.selectedKey:void 0,[e.value,e.selectedKey,l]),[t,u]=Ie(v,b,e.onChange),m=l==="single"&&Array.isArray(t)?t[0]:t,o=r=>{if(l==="single"){var F,R;let h=Array.isArray(r)?(R=r[0])!==null&&R!==void 0?R:null:r;u(h),h!==m&&((F=e.onSelectionChange)===null||F===void 0||F.call(e,h))}else{let h=[];Array.isArray(r)?h=r:r!=null&&(h=[r]),u(h)}},c=De({...e,selectionMode:l,disallowEmptySelection:l==="single",allowDuplicateSelectionEvents:!0,selectedKeys:n.useMemo(()=>ze(m),[m]),onSelectionChange:r=>{if(r!=="all"){if(l==="single"){var F;let R=(F=r.values().next().value)!==null&&F!==void 0?F:null;o(R),d.close()}else o([...r]);s.commitValidation()}}}),p=c.selectionManager.firstSelectedKey,$=n.useMemo(()=>[...c.selectionManager.selectedKeys].map(r=>c.collection.getItem(r)).filter(r=>r!=null),[c.selectionManager.selectedKeys,c.collection]),s=Me({...e,value:Array.isArray(m)&&m.length===0?null:m}),[y,P]=n.useState(!1),[i]=n.useState(m);var x,S;return{...s,...c,...d,value:m,defaultValue:b??i,setValue:o,selectedKey:p,setSelectedKey:o,selectedItem:(x=$[0])!==null&&x!==void 0?x:null,selectedItems:$,defaultSelectedKey:(S=e.defaultSelectedKey)!==null&&S!==void 0?S:e.selectionMode==="single"?i:null,focusStrategy:f,open(r=null){c.collection.size!==0&&(a(r),d.open())},toggle(r=null){c.collection.size!==0&&(a(r),d.toggle())},isFocused:y,setFocused:P}}function ze(e){if(e!==void 0)return e===null?[]:Array.isArray(e)?e:[e]}function He(e){return e&&e.__esModule?e.default:e}const j=n.createContext(null),U=n.createContext(null),Le=n.forwardRef(function(l,d){[l,d]=T(l,d,j);let{children:f,isDisabled:a=!1,isInvalid:b=!1,isRequired:v=!1}=l,t=n.useMemo(()=>typeof f=="function"?f({isOpen:!1,isDisabled:a,isInvalid:b,isRequired:v,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):f,[f,a,b,v]);return C.createElement(ge,{content:t},u=>C.createElement(Ue,{props:l,collection:u,selectRef:d}))}),We=[W,L,k];function Ue({props:e,selectRef:l,collection:d}){let{validationBehavior:f}=z(me)||{};var a,b;let v=(b=(a=e.validationBehavior)!==null&&a!==void 0?a:f)!==null&&b!==void 0?b:"native",t=Te({...e,collection:d,children:void 0,validationBehavior:v}),{isFocusVisible:u,focusProps:m}=Ee({within:!0}),o=n.useRef(null),[c,p]=re(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:$,triggerProps:s,valueProps:y,menuProps:P,descriptionProps:i,errorMessageProps:x,hiddenSelectProps:S,...r}=Ae({...ie(e),label:p,validationBehavior:v},t,o),[F,R]=n.useState(null),h=n.useCallback(()=>{o.current&&R(o.current.offsetWidth+"px")},[o]);Se({ref:o,onResize:h});let V=n.useMemo(()=>({isOpen:t.isOpen,isFocused:t.isFocused,isFocusVisible:u,isDisabled:e.isDisabled||!1,isInvalid:r.isInvalid||!1,isRequired:e.isRequired||!1}),[t.isOpen,t.isFocused,u,e.isDisabled,r.isInvalid,e.isRequired]),g=H({...e,values:V,defaultClassName:"react-aria-Select"}),D=q(e,{global:!0});delete D.id;let I=n.useRef(null);return C.createElement(ne,{values:[[j,e],[U,t],[X,y],[W,{...$,ref:c,elementType:"span"}],[L,{...s,ref:o,isPressed:t.isOpen,autoFocus:e.autoFocus}],[ve,t],[pe,{trigger:"Select",triggerRef:o,scrollRef:I,placement:"bottom start",style:{"--trigger-width":F},"aria-labelledby":P["aria-labelledby"],clearContexts:We}],[le,{...P,ref:I}],[te,t],[k,{slots:{description:i,errorMessage:x}}],[ue,r]]},C.createElement("div",{...O(D,g,m),ref:l,slot:e.slot||void 0,"data-focused":t.isFocused||void 0,"data-focus-visible":u||void 0,"data-open":t.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":r.isInvalid||void 0,"data-required":e.isRequired||void 0},g.children,C.createElement(Ne,{...S,autoComplete:e.autoComplete})))}const X=n.createContext(null),Xe=ye(function(l,d){var f;[l,d]=T(l,d,X);let a=n.useContext(U),{placeholder:b}=z(j),v=a.selectedItems.map(i=>{var x;let S=(x=i.props)===null||x===void 0?void 0:x.children;return typeof S=="function"&&(S=S({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"})),S}),t=qe(),u=n.useMemo(()=>a.selectedItems.map(i=>i?.textValue),[a.selectedItems]),m=a.selectionManager.selectionMode,o=n.useMemo(()=>{var i;return m==="single"?(i=u[0])!==null&&i!==void 0?i:"":t.format(u)},[m,t,u]),c=n.useMemo(()=>{if(m==="single")return v[0];let i=t.formatToParts(u);if(i.length===0)return null;let x=0;return i.map(S=>S.type==="element"?C.createElement(n.Fragment,{key:x},v[x++]):S.value)},[m,t,u,v]),p=Fe(He(be),"react-aria-components");var $,s;let y=H({...l,defaultChildren:($=c??b)!==null&&$!==void 0?$:p.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(s=(f=a.selectedItems[0])===null||f===void 0?void 0:f.value)!==null&&s!==void 0?s:null,selectedItems:n.useMemo(()=>a.selectedItems.map(i=>{var x;return(x=i.value)!==null&&x!==void 0?x:null}),[a.selectedItems]),selectedText:o,isPlaceholder:a.selectedItems.length===0,state:a}}),P=q(l,{global:!0});return C.createElement("span",{ref:d,...P,...y,"data-placeholder":a.selectedItems.length===0||void 0},C.createElement(k.Provider,{value:void 0},y.children))}),Ge="flow--select",Je="flow--select--toggle",N={select:Ge,toggle:Je},Qe=G("Select",e=>{const{children:l,className:d,onChange:f=()=>{},onSelectionChange:a=()=>{},controller:b,ref:v,isReadOnly:t,...u}=e,m=_(N.select,K.formField,d),o={Label:{className:K.label,optional:!e.isRequired},FieldDescription:{className:K.fieldDescription},FieldError:{className:K.customFieldError},Option:{tunnelId:"options"}},c=i=>{f(i),a(i)},p=oe("Select",{reuseControllerFromContext:!0}),$=se(v),s=n.useRef(null);de($,()=>{s.current?.focus()});const y=b??p,P=y.useIsOpen();return M.jsx(Le,{...u,className:m,ref:$,onSelectionChange:t?void 0:c,onOpenChange:i=>!t&&y.setOpen(i),isOpen:P,"data-readonly":t,children:M.jsx(J,{props:o,children:M.jsxs(Q,{children:[M.jsxs(ce,{ref:s,"data-readonly":t,className:N.toggle,children:[M.jsx(Xe,{}),M.jsx(ee,{})]}),l,M.jsx(ae,{controller:y,children:M.jsx(Y,{id:"options"})}),M.jsx(Z,{className:K.fieldError})]})})})});Qe.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Select"};export{Qe as S};
