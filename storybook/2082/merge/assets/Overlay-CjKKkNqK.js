import{r as d,R as m,j as $}from"./iframe-D_6zdLny.js";import{c as j}from"./clsx-B-dksMZM.js";import{u as q}from"./useOverlayController-ClIsDnWC.js";import{O as H}from"./OverlayContextProvider-D1-D5Oi5.js";import{$ as W,b as O,a as R,d as I}from"./utils-PQD-Pczy.js";import{d as V,e as _,f as z,g as F,h as v,i as B,j as k,k as A}from"./Dialog-RcAnAvxk.js";import{c as P,$ as x,a as U}from"./index-BGrQFvII.js";import{$ as M}from"./filterDOMProps-i7L6S0l1.js";import{a as K}from"./useCollator-NS9MLfPk.js";import{$ as y}from"./SelectionManager-BR7WMr9Q.js";import{c as G,d as w,e as D}from"./OverlayArrow-vA-0UH51.js";import{v as J}from"./flowComponent-OxdpfLz0.js";import{C as Q}from"./ClearPropsContextView-BWtGAMVv.js";let f=typeof document<"u"&&window.visualViewport;function X(){let t=P(),[e,n]=d.useState(()=>t?{width:0,height:0}:E());return d.useEffect(()=>{let i=()=>{f&&f.scale>1||n(o=>{let r=E();return r.width===o.width&&r.height===o.height?o:r})},a,s=o=>{f&&f.scale>1||y(o.target)&&(a=requestAnimationFrame(()=>{(!document.activeElement||!y(document.activeElement))&&n(r=>{let l={width:window.innerWidth,height:window.innerHeight};return l.width===r.width&&l.height===r.height?r:l})}))};return window.addEventListener("blur",s,!0),f?f.addEventListener("resize",i):window.addEventListener("resize",i),()=>{cancelAnimationFrame(a),window.removeEventListener("blur",s,!0),f?f.removeEventListener("resize",i):window.removeEventListener("resize",i)}},[]),e}function E(){return{width:f?f.width*f.scale:window.innerWidth,height:f?f.height*f.scale:window.innerHeight}}function Y(t,e,n){let{overlayProps:i,underlayProps:a}=V({...t,isOpen:e.isOpen,onClose:e.close},n);return _({isDisabled:!e.isOpen}),z(),d.useEffect(()=>{if(e.isOpen&&n.current)return F([n.current],{shouldUseInert:!0})},[e.isOpen,n]),{modalProps:x(i),underlayProps:a}}const Z=d.createContext(null),b=d.createContext(null),ee=d.forwardRef(function(e,n){if(d.useContext(b))return m.createElement(C,{...e,modalRef:n},e.children);let{isDismissable:a,isKeyboardDismissDisabled:s,isOpen:o,defaultOpen:r,onOpenChange:l,children:c,isEntering:u,isExiting:p,UNSTABLE_portalContainer:h,shouldCloseOnInteractOutside:N,...S}=e;return m.createElement(T,{isDismissable:a,isKeyboardDismissDisabled:s,isOpen:o,defaultOpen:r,onOpenChange:l,isEntering:u,isExiting:p,UNSTABLE_portalContainer:h,shouldCloseOnInteractOutside:N},m.createElement(C,{...S,modalRef:n},c))});function te(t,e){[t,e]=W(t,e,Z);let n=d.useContext(v),i=G(t),a=t.isOpen!=null||t.defaultOpen!=null||!n?i:n,s=O(e),o=d.useRef(null),r=w(s,a.isOpen),l=w(o,a.isOpen),c=r||l||t.isExiting||!1,u=P();return!a.isOpen&&!c||u?null:m.createElement(ne,{...t,state:a,isExiting:c,overlayRef:s,modalRef:o})}const T=d.forwardRef(te);function ne({UNSTABLE_portalContainer:t,...e}){let n=e.modalRef,{state:i}=e,{modalProps:a,underlayProps:s}=Y(e,i,n),o=D(e.overlayRef)||e.isEntering||!1,r=R({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:o,isExiting:e.isExiting,state:i}}),l=X(),c;if(typeof document<"u"){let p=K(document.body)?document.body:document.scrollingElement||document.documentElement,h=p.getBoundingClientRect().height%1;c=p.scrollHeight-h}let u={...r.style,"--visual-viewport-height":l.height+"px","--page-height":c!==void 0?c+"px":void 0};return m.createElement(k,{isExiting:e.isExiting,portalContainer:t},m.createElement("div",{...x(M(e,{global:!0}),s),...r,style:u,ref:e.overlayRef,"data-entering":o||void 0,"data-exiting":e.isExiting||void 0},m.createElement(I,{values:[[b,{modalProps:a,modalRef:n,isExiting:e.isExiting,isDismissable:e.isDismissable}],[v,i]]},r.children)))}function C(t){let{modalProps:e,modalRef:n,isExiting:i,isDismissable:a}=d.useContext(b),s=d.useContext(v),o=d.useMemo(()=>U(t.modalRef,n),[t.modalRef,n]),r=O(o),l=D(r),c=R({...t,defaultClassName:"react-aria-Modal",values:{isEntering:l,isExiting:i,state:s}});return m.createElement("div",{...x(M(t,{global:!0}),e),...c,ref:r,"data-entering":l||void 0,"data-exiting":i||void 0},a&&m.createElement(B,{onDismiss:s.close}),c.children)}const re="flow--overlay",ie={overlay:re},L=t=>{const{children:e,...n}=t;return $.jsx(T,{...n,children:$.jsx(ee,{children:$.jsx(A,{children:e})})})};L.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"OverlayContent",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},onOpenChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(isOpen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isOpen"}],return:{name:"void"}}},description:""},isDismissable:{required:!1,tsType:{name:"boolean"},description:""},isOpen:{required:!1,tsType:{name:"boolean"},description:""}},composes:["PropsWithChildren","PropsWithClassName"]};const g=d.memo(t=>{const e=d.useContext(J).OverlayContent??L;return $.jsx(e,{...t})});g.displayName="OverlayContentView";g.__docgenInfo={description:"",methods:[],displayName:"OverlayContentView"};const ae=t=>{const{controller:e,children:n,isDismissable:i=!0,className:a,overlayType:s="Modal",ref:o}=t,r=q(s,{reuseControllerFromContext:!0}),l=e??r,c=l.useIsOpen(),u=j(ie.overlay,a);return $.jsx(Q,{keep:s,children:$.jsx(g,{onOpenChange:p=>l.setOpen(p),isOpen:c,ref:o,isDismissable:i,className:u,children:$.jsx(H,{type:"Modal",controller:l,children:c&&n})})})};ae.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},controller:{required:!1,tsType:{name:"OverlayController"},description:"The controller to control the overlay state."},isDismissable:{required:!1,tsType:{name:"boolean"},description:"Whether the overlay can be closed by clicking outside of it."},overlayType:{required:!1,tsType:{name:"union",raw:'"Modal" | "LightBox"',elements:[{name:"literal",value:'"Modal"'},{name:"literal",value:'"LightBox"'}]},description:"Whether the overlay is a modal or a light box."}},composes:["PropsWithChildren","PropsWithClassName"]};export{ae as O};
