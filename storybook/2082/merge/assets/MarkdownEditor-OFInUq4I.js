import{j as r,r as _}from"./iframe-EtTbRQoM.js";import{M as q}from"./Markdown-BC6pCH-C.js";import{T as C}from"./TextArea-NAi9HkBi.js";import{O as T,K as v,P as D,Q as O,R}from"./IconWarning-CO-lUcxm.js";import{B as E}from"./Button-DxuCaQyR.js";import{$ as I}from"./useLocalizedStringFormatter-FAUwXJff.js";import{c as F}from"./clsx-B-dksMZM.js";import{f as A}from"./flowComponent-CRP3amPt.js";import{b as z}from"./utils-C_hvyJpn.js";import{u as U}from"./useManagedValue-DOWOMeeY.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],Q=T("outline","bold","Bold",K);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],H=T("outline","italic","Italic",V);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],Z=T("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],J=T("outline","strikethrough","Strikethrough",G);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Y=T("filled","quote-filled","QuoteFilled",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",oe="flow--markdown-editor--toolbar-buttons",se="flow--markdown-editor--mode-button",ne="flow--markdown-editor--markdown",j={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:oe,modeButton:se,markdown:ne},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},k=(e,d)=>{const h=e.lastIndexOf(`
`,d-1);return h===-1?0:h+1},B=(e,d)=>{const h=e.indexOf(`
`,d);return h===-1?e.length:h},ie=(e,d,h,i)=>{const b=h.current;if(!b)return;const{before:l,after:p="",toggleable:y=!1}=re[i],t=b.selectionStart,g=b.selectionEnd,n=e.substring(t,g),m=n.split(`
`);let u=e,o=t,c=g;if(i==="code"&&n.includes(`
`))u=e.substring(0,t)+"```\n"+n+"\n```\n"+e.substring(g),o=t+4,c=o+n.length;else if(i==="orderedList")if(n){const s=m.map((a,f)=>`${f+1}. ${a}`).join(`
`);u=e.substring(0,t)+s+e.substring(g),o=t,c=t+s.length}else{const s=k(e,t),a=B(e,t),f=`1. ${e.substring(s,a)}`;u=e.substring(0,s)+l+e.substring(s),o=s+f.length,c=o}else if(i==="unorderedList")if(n){const s=m.map(a=>`${l}${a}`).join(`
`);u=e.substring(0,t)+s+e.substring(g),o=t,c=t+s.length}else{const s=k(e,t),a=B(e,t),f=`- ${e.substring(s,a)}`;u=e.substring(0,s)+l+e.substring(s),o=s+f.length,c=o}else if(i==="quote")if(n){const s=m.map(a=>`${l}${a}`).join(`
`);u=e.substring(0,t)+s+e.substring(g),o=t,c=t+s.length}else{const s=`
${l} `;u=e.substring(0,t)+s+e.substring(g),o=t+s.length,c=o}else if(y){const s=e.substring(t-l.length,t),a=e.substring(g,g+p.length),f=s===l&&a===p,M=n.startsWith(l)&&n.endsWith(p);if(f)u=e.substring(0,t-l.length)+n+e.substring(g+p.length),o=t-l.length,c=o+n.length;else if(M){const $=n.slice(l.length,n.length-p.length);u=e.substring(0,t)+$+e.substring(g),o=t,c=t+$.length}else u=e.substring(0,t)+l+n+p+e.substring(g),n.length===0?(o=t+l.length,c=o):(o=t+l.length,c=o+n.length)}else if(i==="link"){let s="",a="",f="",M=0;n?(N=>{try{return new URL(N),!0}catch{return!1}})(n)?(a=n,f=`[](${a})`,M=t+1):(s=n,f=`[${s}]()`,M=t+f.indexOf("](")+2):(f="[](https://)",M=t+1),u=e.substring(0,t)+f+e.substring(g),o=c=M}else u=e.substring(0,t)+l+n+p+e.substring(g),n.length===0?(o=t+l.length,c=o):(o=t+l.length,c=o+n.length);d(u),requestAnimationFrame(()=>{b.setSelectionRange(o,c),b.focus()})},w={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},x=e=>{const{children:d,type:h,onPress:i,...b}=e,l=I(w);return r.jsx(E,{...b,"aria-label":l.format(`toolbar.${h}`),size:"s",variant:"plain",color:"dark",onPress:()=>i?.(h),children:d})};x.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onPress:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const P=e=>{const{currentMode:d,onChange:h,...i}=e,b=I(w),l=d==="editor"?"preview":"editor";return r.jsx(E,{className:j.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{h?.(l)},...i,children:b.format(`mode.${l}`)})};P.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const S=e=>{const d={onPress:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return r.jsxs("header",{className:j.toolbar,role:"toolbar",children:[r.jsxs("div",{className:j.toolbarButtons,children:[r.jsx(x,{...d,type:"bold",children:r.jsx(v,{children:r.jsx(Q,{})})}),r.jsx(x,{...d,type:"italic",children:r.jsx(v,{children:r.jsx(H,{})})}),r.jsx(x,{...d,type:"strikeThrough",children:r.jsx(v,{children:r.jsx(J,{})})}),r.jsx(x,{...d,type:"quote",children:r.jsx(v,{children:r.jsx(Y,{})})}),r.jsx(x,{...d,type:"code",children:r.jsx(D,{})}),r.jsx(x,{...d,type:"link",children:r.jsx(O,{})}),r.jsx(x,{...d,type:"unorderedList",children:r.jsx(v,{children:r.jsx(R,{})})}),r.jsx(x,{...d,type:"orderedList",children:r.jsx(v,{children:r.jsx(Z,{})})})]}),r.jsx(P,{onChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};S.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{currentMode:{required:!0,tsType:{name:'ModeButtonProps["currentMode"]',raw:'ModeButtonProps["currentMode"]'},description:""},onModeChange:{required:!0,tsType:{name:'ModeButtonProps["onChange"]',raw:'ModeButtonProps["onChange"]'},description:""},onToolPressed:{required:!0,tsType:{name:'ToolBarButtonProps["onPress"]',raw:'ToolBarButtonProps["onPress"]'},description:""}},composes:["Pick"]};const L=e=>{const{selectionStart:d}=e,h=parseInt(getComputedStyle(e).lineHeight||"20",10),i=e.value.slice(0,d).split(`
`).length;e.scrollTop=(i-1)*h},le=(e,d,h)=>{if(e.key!=="Enter")return;const i=d.current;if(!i)return;const b=i.selectionStart,l=i.selectionEnd,p=i.value,y=p.slice(0,b),t=p.slice(l),g=y.lastIndexOf(`
`)+1,n=y.slice(g),m=n.match(/^(\s*)(\d+)\.\s+/),u=n.match(/^(\s*)([-*+])\s+/);if((m||u)&&n.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const o=p.slice(0,g)+`
`+t;h(o),requestAnimationFrame(()=>{i.selectionStart=i.selectionEnd=g+1,L(i)});return}if(m){e.preventDefault();const o=m[1],c=parseInt(m[2]??"",10)+1,s=`
${o}${c}. `,a=y+s+t;h(a),requestAnimationFrame(()=>{i.selectionStart=i.selectionEnd=b+s.length,L(i)})}else if(u){e.preventDefault();const o=u[1],c=u[2],s=`
${o}${c} `,a=y+s+t;h(a),requestAnimationFrame(()=>{i.selectionStart=i.selectionEnd=b+s.length,L(i)})}},ae=A("MarkdownEditor",e=>{const{isDisabled:d,isReadOnly:h,children:i,className:b,rows:l,autoResizeMaxRows:p,headingOffset:y,ref:t,...g}=e,[n,m]=_.useState("editor"),{value:u,handleOnChange:o}=U(e),c=z(t),s=F(j.markdownEditor,b,j[`mode-${n}`]);return r.jsxs(C,{...g,isReadOnly:h||n==="preview",isDisabled:d,className:s,ref:c,value:u,rows:l,autoResizeMaxRows:p,onChange:a=>{o(a)},onKeyDown:a=>le(a,c,o),children:[r.jsx(S,{currentMode:n,isDisabled:d,onModeChange:a=>m(a),onToolPressed:a=>{ie(u,o,c,a)}}),r.jsx(q,{headingOffset:y,className:j.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${p??l} + (var(--form-control--padding-y) * 2))`},children:u}),i]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
