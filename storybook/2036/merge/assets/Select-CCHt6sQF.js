import{r as f,R as v,j as h}from"./iframe-Co5olYEg.js";import{f as G,P as J,k as Q,A as Y}from"./PropsContextProvider-B3fcy-aZ.js";import{f as E}from"./FormField.module-CqWyJNQI.js";import{F as Z}from"./FieldError-ozznJ0Nd.js";import{c as ee}from"./clsx-B-dksMZM.js";import{c as le}from"./IconWarning-Deg5RPPa.js";import{$ as te,a as ae,b as oe}from"./Option-C4vswWz1.js";import{n as ie,k as re,o as se,u as ne}from"./DialogTriggerView-CesmwlI4.js";import{$ as H,c as W,a as A,f as de,g as ce,d as fe,b as T}from"./utils-CfsHCmXQ.js";import{u as ue}from"./useMakeFocusable-DB3B4rem.js";import{$ as L,a as be}from"./Button-B1uEfXYj.js";import{a as $e}from"./FieldError-Clh4ku1F.js";import{a as me,$ as pe}from"./Form-XAAYfRmY.js";import{$ as ve}from"./intlStrings-ZMTSFH_M.js";import{b as U}from"./Label-z037IMCX.js";import{a as q}from"./Text-DL7aZegp.js";import{e as ge}from"./CollectionBuilder-BnPgo0UY.js";import{$ as M,f as ye,e as xe}from"./mergeRefs-DCCfFRi5.js";import{$ as j}from"./filterDOMProps-CghfNOdR.js";import{d as he,h as Pe}from"./ClearPropsContextView-ZglcEVcs.js";import{$ as Se}from"./useLocalizedStringFormatter-CMxRm_Et.js";import{b as Ce,$ as Re}from"./useFormValidation-CpjqECXn.js";import{$ as Fe}from"./useSingleSelectListState-Dnn7N4Lc.js";import{a as De}from"./useFocusRing-CNR6shO8.js";import{$ as Ie,h as Ee}from"./SelectionManager-DPLcFzYl.js";import{E as Ke}from"./useFocus-D_PcVBPO.js";import{a as Be}from"./useCollator-BMKqU-cc.js";import{$ as Oe}from"./useFormReset-CgjW6y2V.js";import{a as ke}from"./VisuallyHidden-CTHGVqVW.js";const V=new WeakMap;function we(e,l,s){let{keyboardDelegate:r,isDisabled:o,isRequired:n,name:u,form:a,validationBehavior:i="aria"}=e,$=Be({usage:"search",sensitivity:"base"}),t=f.useMemo(()=>r||new Ie(l.collection,l.disabledKeys,s,$),[r,l.collection,l.disabledKeys,$,s]),{menuTriggerProps:m,menuProps:b}=ie({isDisabled:o,type:"listbox"},l,s),d=c=>{switch(c.key){case"ArrowLeft":{var C,R;c.preventDefault();let I=l.selectedKey!=null?(C=t.getKeyAbove)===null||C===void 0?void 0:C.call(t,l.selectedKey):(R=t.getFirstKey)===null||R===void 0?void 0:R.call(t);I&&l.setSelectedKey(I);break}case"ArrowRight":{var k,w;c.preventDefault();let I=l.selectedKey!=null?(k=t.getKeyBelow)===null||k===void 0?void 0:k.call(t,l.selectedKey):(w=t.getFirstKey)===null||w===void 0?void 0:w.call(t);I&&l.setSelectedKey(I);break}}},{typeSelectProps:p}=Ee({keyboardDelegate:t,selectionManager:l.selectionManager,onTypeSelect(c){l.setSelectedKey(c)}}),{isInvalid:P,validationErrors:x,validationDetails:F}=l.displayValidation,{labelProps:g,fieldProps:D,descriptionProps:S,errorMessageProps:B}=me({...e,labelElementType:"span",isInvalid:P,errorMessage:e.errorMessage||x});p.onKeyDown=p.onKeyDownCapture,delete p.onKeyDownCapture;let O=j(e,{labelable:!0}),y=M(p,m,D),K=ye();return V.set(l,{isDisabled:o,isRequired:n,name:u,form:a,validationBehavior:i}),{labelProps:{...g,onClick:()=>{if(!e.isDisabled){var c;(c=s.current)===null||c===void 0||c.focus(),Ke("keyboard")}}},triggerProps:M(O,{...y,isDisabled:o,onKeyDown:xe(y.onKeyDown,d,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[K,y["aria-labelledby"],y["aria-label"]&&!y["aria-labelledby"]?y.id:null].filter(Boolean).join(" "),onFocus(c){l.isFocused||(e.onFocus&&e.onFocus(c),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(c){l.isOpen||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:K},menuProps:{...b,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:c=>{c.currentTarget.contains(c.relatedTarget)||(e.onBlur&&e.onBlur(c),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[D["aria-labelledby"],y["aria-label"]&&!D["aria-labelledby"]?y.id:null].filter(Boolean).join(" ")},descriptionProps:S,errorMessageProps:B,isInvalid:P,validationErrors:x,validationDetails:F,hiddenSelectProps:{isDisabled:o,name:u,label:e.label,state:l,triggerRef:s,form:a}}}function Me(e,l,s){let r=V.get(l)||{},{autoComplete:o,name:n=r.name,form:u=r.form,isDisabled:a=r.isDisabled}=e,{validationBehavior:i,isRequired:$}=r,{visuallyHiddenProps:t}=ke({style:{position:"fixed",top:0,left:0}});Oe(e.selectRef,l.defaultSelectedKey,l.setSelectedKey),Ce({validationBehavior:i,focus:()=>{var d;return(d=s.current)===null||d===void 0?void 0:d.focus()}},l,e.selectRef);let m=f.useCallback(d=>l.setSelectedKey(d.currentTarget.value),[l.setSelectedKey]);var b;return{containerProps:{...t,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:a,required:i==="native"&&$,name:n,form:u,value:(b=l.selectedKey)!==null&&b!==void 0?b:"",onChange:m,onInput:m}}}function qe(e){let{state:l,triggerRef:s,label:r,name:o,form:n,isDisabled:u}=e,a=f.useRef(null),i=f.useRef(null),{containerProps:$,selectProps:t}=Me({...e,selectRef:l.collection.size<=300?a:i},l,s);if(l.collection.size<=300)return v.createElement("div",{...$,"data-testid":"hidden-select-container"},v.createElement("label",null,r,v.createElement("select",{...t,ref:a},v.createElement("option",null),[...l.collection.getKeys()].map(b=>{let d=l.collection.getItem(b);if(d&&d.type==="item")return v.createElement("option",{key:d.key,value:d.key},d.textValue)}))));if(o){let b=V.get(l)||{},{validationBehavior:d}=b;var m;let p={type:"hidden",autoComplete:t.autoComplete,name:o,form:n,disabled:u,value:(m=l.selectedKey)!==null&&m!==void 0?m:""};return d==="native"?v.createElement("input",{...p,ref:i,style:{display:"none"},type:"text",required:t.required,onChange:()=>{}}):v.createElement("input",{...p,ref:i})}return null}function je(e){let l=he(e),[s,r]=f.useState(null),o=Fe({...e,onSelectionChange:t=>{e.onSelectionChange!=null&&e.onSelectionChange(t),l.close(),n.commitValidation()}}),n=Re({...e,value:o.selectedKey}),[u,a]=f.useState(!1),[i]=f.useState(o.selectedKey);var $;return{...n,...o,...l,defaultSelectedKey:($=e.defaultSelectedKey)!==null&&$!==void 0?$:i,focusStrategy:s,open(t=null){o.collection.size!==0&&(r(t),l.open())},toggle(t=null){o.collection.size!==0&&(r(t),l.toggle())},isFocused:u,setFocused:a}}function Ve(e){return e&&e.__esModule?e.default:e}const N=f.createContext(null),X=f.createContext(null),Ne=f.forwardRef(function(l,s){[l,s]=H(l,s,N);let{children:r,isDisabled:o=!1,isInvalid:n=!1,isRequired:u=!1}=l,a=f.useMemo(()=>typeof r=="function"?r({isOpen:!1,isDisabled:o,isInvalid:n,isRequired:u,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):r,[r,o,n,u]);return v.createElement(ge,{content:a},i=>v.createElement(ze,{props:l,collection:i,selectRef:s}))}),Te=[U,L,q];function ze({props:e,selectRef:l,collection:s}){let{validationBehavior:r}=W(pe)||{};var o,n;let u=(n=(o=e.validationBehavior)!==null&&o!==void 0?o:r)!==null&&n!==void 0?n:"native",a=je({...e,collection:s,children:void 0,validationBehavior:u}),{isFocusVisible:i,focusProps:$}=De({within:!0}),t=f.useRef(null),[m,b]=de(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:d,triggerProps:p,valueProps:P,menuProps:x,descriptionProps:F,errorMessageProps:g,hiddenSelectProps:D,...S}=we({...ce(e),label:b,validationBehavior:u},a,t),[B,O]=f.useState(null),y=f.useCallback(()=>{t.current&&O(t.current.offsetWidth+"px")},[t]);Pe({ref:t,onResize:y});let K=f.useMemo(()=>({isOpen:a.isOpen,isFocused:a.isFocused,isFocusVisible:i,isDisabled:e.isDisabled||!1,isInvalid:S.isInvalid||!1,isRequired:e.isRequired||!1}),[a.isOpen,a.isFocused,i,e.isDisabled,S.isInvalid,e.isRequired]),c=A({...e,values:K,defaultClassName:"react-aria-Select"}),C=j(e,{global:!0});delete C.id;let R=f.useRef(null);return v.createElement(fe,{values:[[N,e],[X,a],[_,P],[U,{...d,ref:m,elementType:"span"}],[L,{...p,ref:t,isPressed:a.isOpen,autoFocus:e.autoFocus}],[re,a],[se,{trigger:"Select",triggerRef:t,scrollRef:R,placement:"bottom start",style:{"--trigger-width":B},"aria-labelledby":x["aria-labelledby"],clearContexts:Te}],[te,{...x,ref:R}],[ae,a],[q,{slots:{description:F,errorMessage:g}}],[$e,S]]},v.createElement("div",{...M(C,c,$),ref:l,slot:e.slot||void 0,"data-focused":a.isFocused||void 0,"data-focus-visible":i||void 0,"data-open":a.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":S.isInvalid||void 0,"data-required":e.isRequired||void 0},c.children,v.createElement(qe,{...D,autoComplete:e.autoComplete})))}const _=f.createContext(null),He=f.forwardRef(function(l,s){var r,o;[l,s]=H(l,s,_);let n=f.useContext(X),{placeholder:u}=W(N),a=n.selectedKey!=null?n.collection.getItem(n.selectedKey):null,i=a==null?void 0:a.props.children;typeof i=="function"&&(i=i({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"}));let $=Se(Ve(ve),"react-aria-components");var t,m,b;let d=A({...l,defaultChildren:(t=i??u)!==null&&t!==void 0?t:$.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(m=(r=n.selectedItem)===null||r===void 0?void 0:r.value)!==null&&m!==void 0?m:null,selectedText:(b=(o=n.selectedItem)===null||o===void 0?void 0:o.textValue)!==null&&b!==void 0?b:null,isPlaceholder:!a}}),p=j(l,{global:!0});return v.createElement("span",{ref:s,...p,...d,"data-placeholder":!a||void 0},v.createElement(q.Provider,{value:void 0},d.children))}),We="flow--select",Ae="flow--select--toggle",z={select:We,toggle:Ae},Le=G("Select",e=>{const{children:l,className:s,onChange:r=()=>{},onSelectionChange:o=()=>{},controller:n,ref:u,inputRef:a,isReadOnly:i,...$}=e,t=ee(z.select,E.formField,s),m={Label:{className:E.label,optional:!e.isRequired},FieldDescription:{className:E.fieldDescription},FieldError:{className:E.customFieldError},Option:{tunnelId:"options"}},b=g=>{r(String(g)),o(g)},d=ne("Select",{reuseControllerFromContext:!0}),p=T(u),P=T(a);ue(p,()=>{var g;(g=P.current)==null||g.focus()});const x=n??d,F=x.useIsOpen();return h.jsx(Ne,{...$,className:t,ref:p,onSelectionChange:i?void 0:b,onOpenChange:g=>!i&&x.setOpen(g),isOpen:F,"data-readonly":i,children:h.jsx(J,{props:m,children:h.jsxs(Q,{children:[h.jsxs(be,{ref:P,"data-readonly":i,className:z.toggle,children:[h.jsx(He,{}),h.jsx(le,{})]}),l,h.jsx(oe,{controller:x,children:h.jsx(Y,{id:"options"})}),h.jsx(Z,{className:E.fieldError})]})})})});Le.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Select"};export{Le as S};
