import{j as m}from"./jsx-runtime-CLpGMVip.js";import{r as s,R as $}from"./index-Cf9XvIV_.js";import{c as S}from"./clsx-B-dksMZM.js";import{u as T,a as L}from"./OverlayTrigger-BcgVlnqK.js";import{$ as N,c as E,h as v,i as O,a as C,g as j,b as z}from"./utils-DbIpkr2E.js";import{e as I,f as B,g as W,h as _,i as b,j as q,k as A,b as F}from"./Dialog-DtCnPnDw.js";import{$ as w,a as p}from"./index-CoqFY4cC.js";import{$ as R}from"./filterDOMProps-BSfnXAP7.js";import{a as U}from"./OverlayArrow-C189HunQ.js";let d=typeof document<"u"&&window.visualViewport;function H(){let t=w(),[e,i]=s.useState(()=>t?{width:0,height:0}:g());return s.useEffect(()=>{let a=()=>{i(n=>{let r=g();return r.width===n.width&&r.height===n.height?n:r})};return d?d.addEventListener("resize",a):window.addEventListener("resize",a),()=>{d?d.removeEventListener("resize",a):window.removeEventListener("resize",a)}},[]),e}function g(){return{width:d&&(d==null?void 0:d.width)||window.innerWidth,height:d&&(d==null?void 0:d.height)||window.innerHeight}}function K(t,e,i){let{overlayProps:a,underlayProps:n}=I({...t,isOpen:e.isOpen,onClose:e.close},i);return B({isDisabled:!e.isOpen}),W(),s.useEffect(()=>{if(e.isOpen&&i.current)return _([i.current])},[e.isOpen,i]),{modalProps:p(a),underlayProps:n}}const V=s.createContext(null),h=s.createContext(null);function k(t,e){if(s.useContext(h))return $.createElement(y,{...t,modalRef:e},t.children);let{isDismissable:a,isKeyboardDismissDisabled:n,isOpen:r,defaultOpen:f,onOpenChange:l,children:o,isEntering:c,isExiting:u,UNSTABLE_portalContainer:x,shouldCloseOnInteractOutside:D,...M}=t;return $.createElement(P,{isDismissable:a,isKeyboardDismissDisabled:n,isOpen:r,defaultOpen:f,onOpenChange:l,isEntering:c,isExiting:u,UNSTABLE_portalContainer:x,shouldCloseOnInteractOutside:D},$.createElement(y,{...M,modalRef:e},o))}const G=s.forwardRef(k);function J(t,e){[t,e]=N(t,e,V);let i=s.useContext(b),a=U(t),n=t.isOpen!=null||t.defaultOpen!=null||!i?a:i,r=E(e),f=s.useRef(null),l=v(r,n.isOpen),o=v(f,n.isOpen),c=l||o||t.isExiting||!1,u=w();return!n.isOpen&&!c||u?null:$.createElement(Q,{...t,state:n,isExiting:c,overlayRef:r,modalRef:f})}const P=s.forwardRef(J);function Q({UNSTABLE_portalContainer:t,...e}){let i=e.modalRef,{state:a}=e,{modalProps:n,underlayProps:r}=K(e,a,i),f=O(e.overlayRef)||e.isEntering||!1,l=C({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:f,isExiting:e.isExiting,state:a}}),o=H(),c={...l.style,"--visual-viewport-height":o.height+"px"};return $.createElement(q,{isExiting:e.isExiting,portalContainer:t},$.createElement("div",{...p(R(e),r),...l,style:c,ref:e.overlayRef,"data-entering":f||void 0,"data-exiting":e.isExiting||void 0},$.createElement(j,{values:[[h,{modalProps:n,modalRef:i,isExiting:e.isExiting,isDismissable:e.isDismissable}],[b,a]]},l.children)))}function y(t){let{modalProps:e,modalRef:i,isExiting:a,isDismissable:n}=s.useContext(h),r=s.useContext(b),f=s.useMemo(()=>z(t.modalRef,i),[t.modalRef,i]),l=E(f),o=O(l),c=C({...t,defaultClassName:"react-aria-Modal",values:{isEntering:o,isExiting:a,state:r}});return $.createElement("div",{...p(R(t),e),...c,ref:l,"data-entering":o||void 0,"data-exiting":a||void 0},n&&$.createElement(A,{onDismiss:r.close}),c.children)}const X="flow--src--overlay",Y={overlay:X,"overlay-fade":"flow--src--overlay--overlay-fade"},Z=t=>{const{controller:e,children:i,isDismissable:a=!0,className:n,overlayType:r="Modal",ref:f}=t,l=T(r,{reuseControllerFromContext:!0}),o=e??l,c=o.useIsOpen(),u=S(Y.overlay,n);return m.jsx(P,{className:u,isDismissable:a,isOpen:c,onOpenChange:x=>o.setOpen(x),ref:f,children:m.jsx(G,{children:m.jsx(F,{children:m.jsx(L,{type:"Modal",controller:o,children:i})})})})};Z.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},controller:{required:!1,tsType:{name:"OverlayController"},description:"The controller to control the overlay state."},isDismissable:{required:!1,tsType:{name:"boolean"},description:"Whether the overlay can be closed by clicking outside of it."},overlayType:{required:!1,tsType:{name:"union",raw:'"Modal" | "LightBox"',elements:[{name:"literal",value:'"Modal"'},{name:"literal",value:'"LightBox"'}]},description:"Whether the overlay is a modal or a light box."}},composes:["PropsWithChildren","PropsWithClassName"]};export{Z as O};
