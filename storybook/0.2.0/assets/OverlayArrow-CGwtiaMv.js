import{c as Y}from"./index-CoqFY4cC.js";import{r as fe}from"./index-CFEY-m6m.js";import{r as L,R as se}from"./index-Cf9XvIV_.js";import{k as ce}from"./useFocusRing-CKcPrrmF.js";import{c as q}from"./ProgressBar-Jtxrz8Zb.js";import{a as de}from"./useLocalizedStringFormatter-Dq-FGM-G.js";import{$ as ue}from"./useControlledState-19OAjgUP.js";import{$ as pe,a as me}from"./utils-CVMEqJeI.js";function ge(){return typeof window.ResizeObserver<"u"}function K(t){const{ref:e,box:l,onResize:o}=t;L.useEffect(()=>{let n=e==null?void 0:e.current;if(n)if(ge()){const r=new window.ResizeObserver(f=>{f.length&&o()});return r.observe(n,{box:l}),()=>{n&&r.unobserve(n)}}else return window.addEventListener("resize",o,!1),()=>{window.removeEventListener("resize",o,!1)}},[o,e,l])}function Oe(t,e=!0){let[l,o]=L.useState(!0),n=l&&e;return Y(()=>{if(n&&t.current&&"getAnimations"in t.current)for(let r of t.current.getAnimations())r instanceof CSSTransition&&r.cancel()},[t,n]),ne(t,n,L.useCallback(()=>o(!1),[])),n}function Ne(t,e){let[l,o]=L.useState(e?"open":"closed");switch(l){case"open":e||o("exiting");break;case"closed":case"exiting":e&&o("open");break}let n=l==="exiting";return ne(t,n,L.useCallback(()=>{o(r=>r==="exiting"?"closed":r)},[])),n}function ne(t,e,l){Y(()=>{if(e&&t.current){if(!("getAnimations"in t.current)){l();return}let o=t.current.getAnimations();if(o.length===0){l();return}let n=!1;return Promise.all(o.map(r=>r.finished)).then(()=>{n||fe.flushSync(()=>{l()})}).catch(()=>{}),()=>{n=!0}}},[t,e,l])}const M={top:"top",bottom:"top",left:"left",right:"left"},Z={top:"bottom",bottom:"top",left:"right",right:"left"},$e={top:"left",left:"top"},J={top:"height",left:"width"},le={width:"totalWidth",height:"totalHeight"},X={};let C=typeof document<"u"?window.visualViewport:null;function Q(t){let e=0,l=0,o=0,n=0,r=0,f=0,i={};var h;let c=((h=C==null?void 0:C.scale)!==null&&h!==void 0?h:1)>1;if(t.tagName==="BODY"){let d=document.documentElement;o=d.clientWidth,n=d.clientHeight;var u;e=(u=C==null?void 0:C.width)!==null&&u!==void 0?u:o;var $;l=($=C==null?void 0:C.height)!==null&&$!==void 0?$:n,i.top=d.scrollTop||t.scrollTop,i.left=d.scrollLeft||t.scrollLeft,C&&(r=C.offsetTop,f=C.offsetLeft)}else({width:e,height:l,top:r,left:f}=B(t)),i.top=t.scrollTop,i.left=t.scrollLeft,o=e,n=l;if(ce()&&(t.tagName==="BODY"||t.tagName==="HTML")&&c){i.top=0,i.left=0;var p;r=(p=C==null?void 0:C.pageTop)!==null&&p!==void 0?p:0;var a;f=(a=C==null?void 0:C.pageLeft)!==null&&a!==void 0?a:0}return{width:e,height:l,totalWidth:o,totalHeight:n,scroll:i,top:r,left:f}}function he(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function W(t,e,l,o,n,r,f){var i;let h=(i=n.scroll[t])!==null&&i!==void 0?i:0,c=o[J[t]],u=o.scroll[M[t]]+r,$=c+o.scroll[M[t]]-r,p=e-h+f[t]-o[M[t]],a=e-h+l+f[t]-o[M[t]];return p<u?u-p:a>$?Math.max($-a,u-p):0}function be(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function D(t){if(X[t])return X[t];let[e,l]=t.split(" "),o=M[e]||"right",n=$e[o];M[l]||(l="center");let r=J[o],f=J[n];return X[t]={placement:e,crossPlacement:l,axis:o,crossAxis:n,size:r,crossSize:f},X[t]}function G(t,e,l,o,n,r,f,i,h,c){let{placement:u,crossPlacement:$,axis:p,crossAxis:a,size:d,crossSize:b}=o,s={};var m;s[a]=(m=t[a])!==null&&m!==void 0?m:0;var g,E,T,P;$==="center"?s[a]+=(((g=t[b])!==null&&g!==void 0?g:0)-((E=l[b])!==null&&E!==void 0?E:0))/2:$!==a&&(s[a]+=((T=t[b])!==null&&T!==void 0?T:0)-((P=l[b])!==null&&P!==void 0?P:0)),s[a]+=r;const x=t[a]-l[b]+h+c,_=t[a]+t[b]-h-c;if(s[a]=q(s[a],x,_),u===p){const A=i?f[d]:e[le[d]];s[Z[p]]=Math.floor(A-t[p]+n)}else s[p]=Math.floor(t[p]+t[d]+n);return s}function xe(t,e,l,o,n,r,f,i){const h=o?l.height:e[le.height];var c;let u=t.top!=null?l.top+t.top:l.top+(h-((c=t.bottom)!==null&&c!==void 0?c:0)-f);var $,p,a,d,b,s;let m=i!=="top"?Math.max(0,e.height+e.top+(($=e.scroll.top)!==null&&$!==void 0?$:0)-u-(((p=n.top)!==null&&p!==void 0?p:0)+((a=n.bottom)!==null&&a!==void 0?a:0)+r)):Math.max(0,u+f-(e.top+((d=e.scroll.top)!==null&&d!==void 0?d:0))-(((b=n.top)!==null&&b!==void 0?b:0)+((s=n.bottom)!==null&&s!==void 0?s:0)+r));return Math.min(e.height-r*2,m)}function V(t,e,l,o,n,r){let{placement:f,axis:i,size:h}=r;var c,u;if(f===i)return Math.max(0,l[i]-t[i]-((c=t.scroll[i])!==null&&c!==void 0?c:0)+e[i]-((u=o[i])!==null&&u!==void 0?u:0)-o[Z[i]]-n);var $;return Math.max(0,t[h]+t[i]+t.scroll[i]-e[i]-l[i]-l[h]-(($=o[i])!==null&&$!==void 0?$:0)-o[Z[i]]-n)}function ve(t,e,l,o,n,r,f,i,h,c,u,$,p,a,d,b){let s=D(t),{size:m,crossAxis:g,crossSize:E,placement:T,crossPlacement:P}=s,x=G(e,i,l,s,u,$,c,p,d,b),_=u,A=V(i,c,e,n,r+u,s);if(f&&o[m]>A){let U=D(`${Z[T]} ${P}`),ae=G(e,i,l,U,u,$,c,p,d,b);V(i,c,e,n,r+u,U)>A&&(s=U,x=ae,_=u)}let H="bottom";s.axis==="top"?s.placement==="top"?H="top":s.placement==="bottom"&&(H="bottom"):s.crossAxis==="top"&&(s.crossPlacement==="top"?H="bottom":s.crossPlacement==="bottom"&&(H="top"));let w=W(g,x[g],l[E],i,h,r,c);x[g]+=w;let R=xe(x,i,c,p,n,r,l.height,H);a&&a<R&&(R=a),l.height=Math.min(l.height,R),x=G(e,i,l,s,_,$,c,p,d,b),w=W(g,x[g],l[E],i,h,r,c),x[g]+=w;let z={},k=e[g]+.5*e[E]-x[g]-n[M[g]];const y=d/2+b;var O,N,I,S;const F=M[g]==="left"?((O=n.left)!==null&&O!==void 0?O:0)+((N=n.right)!==null&&N!==void 0?N:0):((I=n.top)!==null&&I!==void 0?I:0)+((S=n.bottom)!==null&&S!==void 0?S:0),j=l[E]-F-d/2-b,oe=e[g]+d/2-(x[g]+n[M[g]]),re=e[g]+e[E]-d/2-(x[g]+n[M[g]]),ie=q(k,oe,re);return z[g]=q(ie,y,j),{position:x,maxHeight:R,arrowOffsetLeft:z.left,arrowOffsetTop:z.top,placement:s.placement}}function we(t){let{placement:e,targetNode:l,overlayNode:o,scrollNode:n,padding:r,shouldFlip:f,boundaryElement:i,offset:h,crossOffset:c,maxHeight:u,arrowSize:$=0,arrowBoundaryOffset:p=0}=t,a=o instanceof HTMLElement?Ee(o):document.documentElement,d=a===document.documentElement;const b=window.getComputedStyle(a).position;let s=!!b&&b!=="static",m=d?B(l):ee(l,a);if(!d){let{marginTop:z,marginLeft:k}=window.getComputedStyle(l);m.top+=parseInt(z,10)||0,m.left+=parseInt(k,10)||0}let g=B(o),E=be(o);var T,P;g.width+=((T=E.left)!==null&&T!==void 0?T:0)+((P=E.right)!==null&&P!==void 0?P:0);var x,_;g.height+=((x=E.top)!==null&&x!==void 0?x:0)+((_=E.bottom)!==null&&_!==void 0?_:0);let A=he(n),H=Q(i),w=Q(a),R=i.tagName==="BODY"?B(a):ee(a,i);return a.tagName==="HTML"&&i.tagName==="BODY"&&(w.scroll.top=0,w.scroll.left=0),ve(e,m,g,A,E,r,f,H,w,R,h,c,s,u,$,p)}function B(t){let{top:e,left:l,width:o,height:n}=t.getBoundingClientRect(),{scrollTop:r,scrollLeft:f,clientTop:i,clientLeft:h}=document.documentElement;return{top:e+r-i,left:l+f-h,width:o,height:n}}function ee(t,e){let l=window.getComputedStyle(t),o;if(l.position==="fixed"){let{top:n,left:r,width:f,height:i}=t.getBoundingClientRect();o={top:n,left:r,width:f,height:i}}else{o=B(t);let n=B(e),r=window.getComputedStyle(e);n.top+=(parseInt(r.borderTopWidth,10)||0)-e.scrollTop,n.left+=(parseInt(r.borderLeftWidth,10)||0)-e.scrollLeft,o.top-=n.top,o.left-=n.left}return o.top-=parseInt(l.marginTop,10)||0,o.left-=parseInt(l.marginLeft,10)||0,o}function Ee(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!te(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!te(e);)e=e.parentElement;return e||document.documentElement}function te(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const Ce=new WeakMap;function Pe(t){let{triggerRef:e,isOpen:l,onClose:o}=t;L.useEffect(()=>{if(!l||o===null)return;let n=r=>{let f=r.target;if(!e.current||f instanceof Node&&!f.contains(e.current)||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;let i=o||Ce.get(e.current);i&&i()};return window.addEventListener("scroll",n,!0),()=>{window.removeEventListener("scroll",n,!0)}},[l,o,e])}let v=typeof document<"u"?window.visualViewport:null;function Fe(t){let{direction:e}=de(),{arrowSize:l=0,targetRef:o,overlayRef:n,scrollRef:r=n,placement:f="bottom",containerPadding:i=12,shouldFlip:h=!0,boundaryElement:c=typeof document<"u"?document.body:null,offset:u=0,crossOffset:$=0,shouldUpdatePosition:p=!0,isOpen:a=!0,onClose:d,maxHeight:b,arrowBoundaryOffset:s=0}=t,[m,g]=L.useState(null),E=[p,f,n.current,o.current,r.current,i,h,c,u,$,a,e,b,s,l],T=L.useRef(v==null?void 0:v.scale);L.useEffect(()=>{a&&(T.current=v==null?void 0:v.scale)},[a]);let P=L.useCallback(()=>{if(p===!1||!a||!n.current||!o.current||!c||(v==null?void 0:v.scale)!==T.current)return;let w=null;if(r.current&&r.current.contains(document.activeElement)){var R;let S=(R=document.activeElement)===null||R===void 0?void 0:R.getBoundingClientRect(),F=r.current.getBoundingClientRect();var z;if(w={type:"top",offset:((z=S==null?void 0:S.top)!==null&&z!==void 0?z:0)-F.top},w.offset>F.height/2){w.type="bottom";var k;w.offset=((k=S==null?void 0:S.bottom)!==null&&k!==void 0?k:0)-F.bottom}}let y=n.current;if(!b&&n.current){var O;y.style.top="0px",y.style.bottom="";var N;y.style.maxHeight=((N=(O=window.visualViewport)===null||O===void 0?void 0:O.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let I=we({placement:Se(f,e),overlayNode:n.current,targetNode:o.current,scrollNode:r.current||n.current,padding:i,shouldFlip:h,boundaryElement:c,offset:u,crossOffset:$,maxHeight:b,arrowSize:l,arrowBoundaryOffset:s});if(I.position){if(y.style.top="",y.style.bottom="",y.style.left="",y.style.right="",Object.keys(I.position).forEach(S=>y.style[S]=I.position[S]+"px"),y.style.maxHeight=I.maxHeight!=null?I.maxHeight+"px":"",w&&document.activeElement&&r.current){let S=document.activeElement.getBoundingClientRect(),F=r.current.getBoundingClientRect(),j=S[w.type]-F[w.type];r.current.scrollTop+=j-w.offset}g(I)}},E);Y(P,E),Le(P),K({ref:n,onResize:P}),K({ref:o,onResize:P});let x=L.useRef(!1);Y(()=>{let w,R=()=>{x.current=!0,clearTimeout(w),w=setTimeout(()=>{x.current=!1},500),P()},z=()=>{x.current&&R()};return v==null||v.addEventListener("resize",R),v==null||v.addEventListener("scroll",z),()=>{v==null||v.removeEventListener("resize",R),v==null||v.removeEventListener("scroll",z)}},[P]);let _=L.useCallback(()=>{x.current||d==null||d()},[d,x]);Pe({triggerRef:o,isOpen:a,onClose:d&&_});var A,H;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...m==null?void 0:m.position,maxHeight:(A=m==null?void 0:m.maxHeight)!==null&&A!==void 0?A:"100vh"}},placement:(H=m==null?void 0:m.placement)!==null&&H!==void 0?H:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:m==null?void 0:m.arrowOffsetLeft,top:m==null?void 0:m.arrowOffsetTop}},updatePosition:P}}function Le(t){Y(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function Se(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function Be(t){let[e,l]=ue(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const o=L.useCallback(()=>{l(!0)},[l]),n=L.useCallback(()=>{l(!1)},[l]),r=L.useCallback(()=>{l(!e)},[l,e]);return{isOpen:e,setOpen:l,open:o,close:n,toggle:r}}const Re=L.createContext({placement:"bottom"}),Ye=L.forwardRef(function(e,l){[e,l]=pe(e,l,Re);let o=e.placement,n={position:"absolute",transform:o==="top"||o==="bottom"?"translateX(-50%)":"translateY(-50%)"};o!=null&&(n[o]="100%");let r=me({...e,defaultClassName:"react-aria-OverlayArrow",values:{placement:o}});return r.style&&Object.keys(r.style).forEach(f=>r.style[f]===void 0&&delete r.style[f]),se.createElement("div",{...e,...r,style:{...n,...r.style},ref:l,"data-placement":o})});export{Ye as $,Oe as a,Be as b,Ne as c,Fe as d,Re as e,K as f,Ce as g};
