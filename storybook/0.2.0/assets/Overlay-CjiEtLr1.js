import{j as m}from"./jsx-runtime-CLpGMVip.js";import{r as s,R as $}from"./index-Cf9XvIV_.js";import{c as T}from"./clsx-B-dksMZM.js";import{u as L,a as N}from"./OverlayTrigger-CfWlolrA.js";import{b as j,c as E,a as O,$ as z,g as I}from"./utils-CVMEqJeI.js";import{e as B,f as W,g as _,h as q,i as b,j as A,k as F,b as U}from"./Dialog-CmviSIn_.js";import{$ as C,a as p}from"./index-CoqFY4cC.js";import{$ as w}from"./filterDOMProps-BSfnXAP7.js";import{a as R,b as H,c as v}from"./OverlayArrow-CGwtiaMv.js";let d=typeof document<"u"&&window.visualViewport;function K(){let t=C(),[e,a]=s.useState(()=>t?{width:0,height:0}:g());return s.useEffect(()=>{let i=()=>{a(n=>{let r=g();return r.width===n.width&&r.height===n.height?n:r})};return d?d.addEventListener("resize",i):window.addEventListener("resize",i),()=>{d?d.removeEventListener("resize",i):window.removeEventListener("resize",i)}},[]),e}function g(){return{width:d&&(d==null?void 0:d.width)||window.innerWidth,height:d&&(d==null?void 0:d.height)||window.innerHeight}}function V(t,e,a){let{overlayProps:i,underlayProps:n}=B({...t,isOpen:e.isOpen,onClose:e.close},a);return W({isDisabled:!e.isOpen}),_(),s.useEffect(()=>{if(e.isOpen&&a.current)return q([a.current])},[e.isOpen,a]),{modalProps:p(i),underlayProps:n}}const k=s.createContext(null),h=s.createContext(null),G=s.forwardRef(function(e,a){if(s.useContext(h))return $.createElement(y,{...e,modalRef:a},e.children);let{isDismissable:n,isKeyboardDismissDisabled:r,isOpen:f,defaultOpen:l,onOpenChange:o,children:c,isEntering:u,isExiting:x,UNSTABLE_portalContainer:D,shouldCloseOnInteractOutside:M,...S}=e;return $.createElement(P,{isDismissable:n,isKeyboardDismissDisabled:r,isOpen:f,defaultOpen:l,onOpenChange:o,isEntering:u,isExiting:x,UNSTABLE_portalContainer:D,shouldCloseOnInteractOutside:M},$.createElement(y,{...S,modalRef:a},c))});function J(t,e){[t,e]=z(t,e,k);let a=s.useContext(b),i=H(t),n=t.isOpen!=null||t.defaultOpen!=null||!a?i:a,r=E(e),f=s.useRef(null),l=v(r,n.isOpen),o=v(f,n.isOpen),c=l||o||t.isExiting||!1,u=C();return!n.isOpen&&!c||u?null:$.createElement(Q,{...t,state:n,isExiting:c,overlayRef:r,modalRef:f})}const P=s.forwardRef(J);function Q({UNSTABLE_portalContainer:t,...e}){let a=e.modalRef,{state:i}=e,{modalProps:n,underlayProps:r}=V(e,i,a),f=R(e.overlayRef)||e.isEntering||!1,l=O({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:f,isExiting:e.isExiting,state:i}}),o=K(),c={...l.style,"--visual-viewport-height":o.height+"px"};return $.createElement(F,{isExiting:e.isExiting,portalContainer:t},$.createElement("div",{...p(w(e),r),...l,style:c,ref:e.overlayRef,"data-entering":f||void 0,"data-exiting":e.isExiting||void 0},$.createElement(I,{values:[[h,{modalProps:n,modalRef:a,isExiting:e.isExiting,isDismissable:e.isDismissable}],[b,i]]},l.children)))}function y(t){let{modalProps:e,modalRef:a,isExiting:i,isDismissable:n}=s.useContext(h),r=s.useContext(b),f=s.useMemo(()=>j(t.modalRef,a),[t.modalRef,a]),l=E(f),o=R(l),c=O({...t,defaultClassName:"react-aria-Modal",values:{isEntering:o,isExiting:i,state:r}});return $.createElement("div",{...p(w(t),e),...c,ref:l,"data-entering":o||void 0,"data-exiting":i||void 0},n&&$.createElement(A,{onDismiss:r.close}),c.children)}const X="flow--overlay",Y={overlay:X,"overlay-fade":"flow--overlay--overlay-fade"},Z=t=>{const{controller:e,children:a,isDismissable:i=!0,className:n,overlayType:r="Modal",ref:f}=t,l=L(r,{reuseControllerFromContext:!0}),o=e??l,c=o.useIsOpen(),u=T(Y.overlay,n);return m.jsx(P,{className:u,isDismissable:i,isOpen:c,onOpenChange:x=>o.setOpen(x),ref:f,children:m.jsx(G,{children:m.jsx(U,{children:m.jsx(N,{type:"Modal",controller:o,children:a})})})})};Z.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},controller:{required:!1,tsType:{name:"OverlayController"},description:"The controller to control the overlay state."},isDismissable:{required:!1,tsType:{name:"boolean"},description:"Whether the overlay can be closed by clicking outside of it."},overlayType:{required:!1,tsType:{name:"union",raw:'"Modal" | "LightBox"',elements:[{name:"literal",value:'"Modal"'},{name:"literal",value:'"LightBox"'}]},description:"Whether the overlay is a modal or a light box."}},composes:["PropsWithChildren","PropsWithClassName"]};export{Z as O};
