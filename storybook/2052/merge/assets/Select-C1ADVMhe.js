import{r as i,R,j as F}from"./iframe-CwuqIU3i.js";import{f as G,N as J,P as Q,R as Y}from"./flowComponent-CW5hnf4o.js";import{$ as Z,u as _,f as ee}from"./useFieldComponent-eP2W8yne.js";import{c as j}from"./clsx-B-dksMZM.js";import{c as le}from"./IconWarning-DfuZN-Hc.js";import{$ as te,a as ae,b as oe}from"./Option-BYrCMwV0.js";import{u as re}from"./useOverlayController-B8XIYbgT.js";import{$ as N,c as z,a as H,f as ie,g as ne,d as se,b as de}from"./utils-BNUN6Z86.js";import{u as ce}from"./useMakeFocusable-ChwytvWt.js";import{$ as W,a as ue}from"./Button-BUhZq-tB.js";import{a as fe,$ as me}from"./Form-C1wZYKgN.js";import{$ as be}from"./intlStrings-ZMTSFH_M.js";import{b as L}from"./Label-Ds7Yihzi.js";import{l as $e,h as ve,m as pe}from"./Dialog-BB45Hyg5.js";import{a as O}from"./Text-WRK6H0Wn.js";import{e as ge}from"./CollectionBuilder-BkgyTACG.js";import{b as ye}from"./Hidden-AzgHkXqa.js";import{$ as w,f as xe,e as he}from"./index-DCuX0QuH.js";import{$ as k}from"./filterDOMProps-CghfNOdR.js";import{c as Pe,g as Ce}from"./OverlayArrow-DPamNpoY.js";import{$ as Se}from"./context-Cr--o0Ww.js";import{$ as Re}from"./useLocalizedStringFormatter-CenpEZM_.js";import{b as Fe,$ as Me}from"./useFormValidation-DK6PIssV.js";import{$ as De}from"./useListState-C9JuUq7T.js";import{$ as Ie}from"./useControlledState-B3_Egg2G.js";import{a as Ve}from"./useFocusRing-Csjn1IfN.js";import{a as Ee,i as Ke}from"./SelectionManager-Cunz5w8r.js";import{E as Be}from"./useFocus-JEz06IDi.js";import{b as we}from"./useCollator-Vvi4fPh5.js";import{$ as Oe}from"./useFormReset-BLDFw02N.js";import{a as ke}from"./VisuallyHidden-DO5WoARG.js";function qe(e={}){let{locale:l}=Se();return i.useMemo(()=>new Intl.ListFormat(l,e),[l,e])}const q=new WeakMap;function Ae(e,l,d){let{keyboardDelegate:f,isDisabled:o,isRequired:b,name:p,form:t,validationBehavior:u="aria"}=e,m=we({usage:"search",sensitivity:"base"}),r=i.useMemo(()=>f||new Ee(l.collection,l.disabledKeys,d,m),[f,l.collection,l.disabledKeys,m,d]),{menuTriggerProps:n,menuProps:g}=$e({isDisabled:o,type:"listbox"},l,d),y=x=>{if(l.selectionManager.selectionMode!=="multiple")switch(x.key){case"ArrowLeft":{var D,I;x.preventDefault();let V=l.selectedKey!=null?(D=r.getKeyAbove)===null||D===void 0?void 0:D.call(r,l.selectedKey):(I=r.getFirstKey)===null||I===void 0?void 0:I.call(r);V&&l.setSelectedKey(V);break}case"ArrowRight":{var K,B;x.preventDefault();let V=l.selectedKey!=null?(K=r.getKeyBelow)===null||K===void 0?void 0:K.call(r,l.selectedKey):(B=r.getFirstKey)===null||B===void 0?void 0:B.call(r);V&&l.setSelectedKey(V);break}}},{typeSelectProps:c}=Ke({keyboardDelegate:r,selectionManager:l.selectionManager,onTypeSelect(x){l.setSelectedKey(x)}}),{isInvalid:C,validationErrors:S,validationDetails:s}=l.displayValidation,{labelProps:$,fieldProps:v,descriptionProps:a,errorMessageProps:h}=fe({...e,labelElementType:"span",isInvalid:C,errorMessage:e.errorMessage||S});c.onKeyDown=c.onKeyDownCapture,delete c.onKeyDownCapture,l.selectionManager.selectionMode==="multiple"&&(c={});let M=k(e,{labelable:!0}),P=w(c,n,v),E=xe();return q.set(l,{isDisabled:o,isRequired:b,name:p,form:t,validationBehavior:u}),{labelProps:{...$,onClick:()=>{if(!e.isDisabled){var x;(x=d.current)===null||x===void 0||x.focus(),Be("keyboard")}}},triggerProps:w(M,{...P,isDisabled:o,onKeyDown:he(P.onKeyDown,y,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[E,P["aria-labelledby"],P["aria-label"]&&!P["aria-labelledby"]?P.id:null].filter(Boolean).join(" "),onFocus(x){l.isFocused||(e.onFocus&&e.onFocus(x),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(x){l.isOpen||(e.onBlur&&e.onBlur(x),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:E},menuProps:{...g,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:x=>{x.currentTarget.contains(x.relatedTarget)||(e.onBlur&&e.onBlur(x),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[v["aria-labelledby"],P["aria-label"]&&!v["aria-labelledby"]?P.id:null].filter(Boolean).join(" ")},descriptionProps:a,errorMessageProps:h,isInvalid:C,validationErrors:S,validationDetails:s,hiddenSelectProps:{isDisabled:o,name:p,label:e.label,state:l,triggerRef:d,form:t}}}function je(e,l,d){let f=q.get(l)||{},{autoComplete:o,name:b=f.name,form:p=f.form,isDisabled:t=f.isDisabled}=e,{validationBehavior:u,isRequired:m}=f,{visuallyHiddenProps:r}=ke({style:{position:"fixed",top:0,left:0}});Oe(e.selectRef,l.defaultValue,l.setValue),Fe({validationBehavior:u,focus:()=>{var c;return(c=d.current)===null||c===void 0?void 0:c.focus()}},l,e.selectRef);let n=l.setValue,g=i.useCallback(c=>{c.target.multiple?n(Array.from(c.target.selectedOptions,C=>C.value)):n(c.currentTarget.value)},[n]);var y;return{containerProps:{...r,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:t,multiple:l.selectionManager.selectionMode==="multiple",required:u==="native"&&m,name:b,form:p,value:(y=l.value)!==null&&y!==void 0?y:"",onChange:g,onInput:g}}}function Te(e){let{state:l,triggerRef:d,label:f,name:o,form:b,isDisabled:p}=e,t=i.useRef(null),u=i.useRef(null),{containerProps:m,selectProps:r}=je({...e,selectRef:l.collection.size<=300?t:u},l,d);if(l.collection.size<=300)return R.createElement("div",{...m,"data-testid":"hidden-select-container"},R.createElement("label",null,f,R.createElement("select",{...r,ref:t},R.createElement("option",null),[...l.collection.getKeys()].map(n=>{let g=l.collection.getItem(n);if(g&&g.type==="item")return R.createElement("option",{key:g.key,value:g.key},g.textValue)}))));if(o){let n=q.get(l)||{},{validationBehavior:g}=n,y=Array.isArray(l.value)?l.value:[l.value];y.length===0&&(y=[null]);let c=y.map((C,S)=>{let s={type:"hidden",autoComplete:r.autoComplete,name:o,form:b,disabled:p,value:C??""};return g==="native"?R.createElement("input",{key:S,...s,ref:S===0?u:null,style:{display:"none"},type:"text",required:S===0?r.required:!1,onChange:()=>{}}):R.createElement("input",{key:S,...s,ref:S===0?u:null})});return R.createElement(R.Fragment,null,c)}return null}function Ne(e){let{selectionMode:l="single"}=e,d=Pe(e),[f,o]=i.useState(null),b=i.useMemo(()=>{var a;return e.defaultValue!==void 0?e.defaultValue:l==="single"?(a=e.defaultSelectedKey)!==null&&a!==void 0?a:null:[]},[e.defaultValue,e.defaultSelectedKey,l]),p=i.useMemo(()=>e.value!==void 0?e.value:l==="single"?e.selectedKey:void 0,[e.value,e.selectedKey,l]),[t,u]=Ie(p,b,e.onChange),m=l==="single"&&Array.isArray(t)?t[0]:t,r=a=>{if(l==="single"){var h,M;let P=Array.isArray(a)?(M=a[0])!==null&&M!==void 0?M:null:a;u(P),P!==m&&((h=e.onSelectionChange)===null||h===void 0||h.call(e,P))}else{let P=[];Array.isArray(a)?P=a:a!=null&&(P=[a]),u(P)}},n=De({...e,selectionMode:l,disallowEmptySelection:l==="single",allowDuplicateSelectionEvents:!0,selectedKeys:i.useMemo(()=>ze(m),[m]),onSelectionChange:a=>{if(a!=="all"){if(l==="single"){var h;let M=(h=a.values().next().value)!==null&&h!==void 0?h:null;r(M),d.close()}else r([...a]);c.commitValidation()}}}),g=n.selectionManager.firstSelectedKey,y=i.useMemo(()=>[...n.selectionManager.selectedKeys].map(a=>n.collection.getItem(a)).filter(a=>a!=null),[n.selectionManager.selectedKeys,n.collection]),c=Me({...e,value:Array.isArray(m)&&m.length===0?null:m}),[C,S]=i.useState(!1),[s]=i.useState(m);var $,v;return{...c,...n,...d,value:m,defaultValue:b??s,setValue:r,selectedKey:g,setSelectedKey:r,selectedItem:($=y[0])!==null&&$!==void 0?$:null,selectedItems:y,defaultSelectedKey:(v=e.defaultSelectedKey)!==null&&v!==void 0?v:e.selectionMode==="single"?s:null,focusStrategy:f,open(a=null){n.collection.size!==0&&(o(a),d.open())},toggle(a=null){n.collection.size!==0&&(o(a),d.toggle())},isFocused:C,setFocused:S}}function ze(e){if(e!==void 0)return e===null?[]:Array.isArray(e)?e:[e]}function He(e){return e&&e.__esModule?e.default:e}const A=i.createContext(null),U=i.createContext(null),We=i.forwardRef(function(l,d){[l,d]=N(l,d,A);let{children:f,isDisabled:o=!1,isInvalid:b=!1,isRequired:p=!1}=l,t=i.useMemo(()=>typeof f=="function"?f({isOpen:!1,isDisabled:o,isInvalid:b,isRequired:p,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):f,[f,o,b,p]);return R.createElement(ge,{content:t},u=>R.createElement(Ue,{props:l,collection:u,selectRef:d}))}),Le=[L,W,O];function Ue({props:e,selectRef:l,collection:d}){let{validationBehavior:f}=z(me)||{};var o,b;let p=(b=(o=e.validationBehavior)!==null&&o!==void 0?o:f)!==null&&b!==void 0?b:"native",t=Ne({...e,collection:d,children:void 0,validationBehavior:p}),{isFocusVisible:u,focusProps:m}=Ve({within:!0}),r=i.useRef(null),[n,g]=ie(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:y,triggerProps:c,valueProps:C,menuProps:S,descriptionProps:s,errorMessageProps:$,hiddenSelectProps:v,...a}=Ae({...ne(e),label:g,validationBehavior:p},t,r),[h,M]=i.useState(null),P=i.useCallback(()=>{r.current&&M(r.current.offsetWidth+"px")},[r]);Ce({ref:r,onResize:P});let E=i.useMemo(()=>({isOpen:t.isOpen,isFocused:t.isFocused,isFocusVisible:u,isDisabled:e.isDisabled||!1,isInvalid:a.isInvalid||!1,isRequired:e.isRequired||!1}),[t.isOpen,t.isFocused,u,e.isDisabled,a.isInvalid,e.isRequired]),x=H({...e,values:E,defaultClassName:"react-aria-Select"}),D=k(e,{global:!0});delete D.id;let I=i.useRef(null);return R.createElement(se,{values:[[A,e],[U,t],[X,C],[L,{...y,ref:n,elementType:"span"}],[W,{...c,ref:r,isPressed:t.isOpen,autoFocus:e.autoFocus}],[ve,t],[pe,{trigger:"Select",triggerRef:r,scrollRef:I,placement:"bottom start",style:{"--trigger-width":h},"aria-labelledby":S["aria-labelledby"],clearContexts:Le}],[te,{...S,ref:I}],[ae,t],[O,{slots:{description:s,errorMessage:$}}],[Z,a]]},R.createElement("div",{...w(D,x,m),ref:l,slot:e.slot||void 0,"data-focused":t.isFocused||void 0,"data-focus-visible":u||void 0,"data-open":t.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":a.isInvalid||void 0,"data-required":e.isRequired||void 0},x.children,R.createElement(Te,{...v,autoComplete:e.autoComplete})))}const X=i.createContext(null),Xe=ye(function(l,d){var f;[l,d]=N(l,d,X);let o=i.useContext(U),{placeholder:b}=z(A),p=o.selectedItems.map(s=>{var $;let v=($=s.props)===null||$===void 0?void 0:$.children;return typeof v=="function"&&(v=v({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"})),v}),t=qe(),u=i.useMemo(()=>o.selectedItems.map(s=>s==null?void 0:s.textValue),[o.selectedItems]),m=o.selectionManager.selectionMode,r=i.useMemo(()=>{var s;return m==="single"?(s=u[0])!==null&&s!==void 0?s:"":t.format(u)},[m,t,u]),n=i.useMemo(()=>{if(m==="single")return p[0];let s=t.formatToParts(u);if(s.length===0)return null;let $=0;return s.map(v=>v.type==="element"?R.createElement(i.Fragment,{key:$},p[$++]):v.value)},[m,t,u,p]),g=Re(He(be),"react-aria-components");var y,c;let C=H({...l,defaultChildren:(y=n??b)!==null&&y!==void 0?y:g.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(c=(f=o.selectedItems[0])===null||f===void 0?void 0:f.value)!==null&&c!==void 0?c:null,selectedItems:i.useMemo(()=>o.selectedItems.map(s=>{var $;return($=s.value)!==null&&$!==void 0?$:null}),[o.selectedItems]),selectedText:r,isPlaceholder:o.selectedItems.length===0,state:o}}),S=k(l,{global:!0});return R.createElement("span",{ref:d,...S,...C,"data-placeholder":o.selectedItems.length===0||void 0},R.createElement(O.Provider,{value:void 0},C.children))}),Ge="flow--select",Je="flow--select--toggle",T={select:Ge,toggle:Je},Qe=G("Select",e=>{const{children:l,className:d,onChange:f=()=>{},onSelectionChange:o=()=>{},controller:b,ref:p,isReadOnly:t,...u}=e,{FieldErrorView:m,fieldPropsContext:r,fieldProps:n,FieldErrorResetContext:g}=_(e),y=j(T.select,ee.formField,d),c={Option:{tunnelId:"options"},...r},C=h=>{f(h),o(h)},S=re("Select",{reuseControllerFromContext:!0}),s=de(p),$=i.useRef(null);ce(s,()=>{var h;(h=$.current)==null||h.focus()});const v=b??S,a=v.useIsOpen();return F.jsx(We,{...u,...n,className:j(y,n.className),ref:s,onSelectionChange:t?void 0:C,onOpenChange:h=>!t&&v.setOpen(h),isOpen:a,"data-readonly":t,children:F.jsxs(J,{children:[F.jsx(g,{children:F.jsxs(Q,{props:c,children:[F.jsxs(ue,{ref:$,"data-readonly":t,className:T.toggle,children:[F.jsx(Xe,{}),F.jsx(le,{})]}),l,F.jsx(oe,{controller:v,children:F.jsx(Y,{id:"options"})})]})}),F.jsx(m,{})]})})});Qe.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Select"};export{Qe as S};
