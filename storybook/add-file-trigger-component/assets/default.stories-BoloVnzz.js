var k=Object.defineProperty;var L=(l,e,t)=>e in l?k(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var E=(l,e,t)=>L(l,typeof e!="symbol"?e+"":e,t);import{r as B,R as r}from"./index-Cs7sjTYM.js";import{T as j}from"./Text-DZmFXo-e.js";import{L as I}from"./LabeledValue-DY3Z86ut.js";import{L as q}from"./Label-3TwhOvTI.js";import{S}from"./Section-BIykth8T.js";import{$ as O}from"./Input-Bgn03Bkw.js";import{$ as P}from"./filterDOMProps-CeZl_uWj.js";import{a as U}from"./utils-GKDLJ2vO.js";import{$ as V}from"./PressResponder-Bhz1UQIJ.js";import{m as z,o as G,b as m}from"./flowComponent-Bg40pdZw.js";import{u as H}from"./useSelector-DiJHxpbu.js";import{B as b}from"./Button-Bq7y9BIZ.js";import"./_commonjsHelpers-BosuxZz1.js";import"./PropsContextProvider-DXo7lD_U.js";import"./index-j_f0pOtZ.js";import"./clsx-B-dksMZM.js";import"./EmulatedBoldText-Dmze-Iwg.js";import"./Wrap-DQq6jo70.js";import"./Text-DP1y2Dk0.js";import"./useLocalizedStringFormatter-TZkCr3Qr.js";import"./Label-qcDNDzhS.js";import"./Hidden-C2kgQquV.js";import"./index-Cf-03bMR.js";import"./ContextMenu.module-68N5lvfm.js";import"./Collection-BdcdgcY_.js";import"./CollectionBuilder-B4BE-ZOx.js";import"./Header-BWLNclCp.js";import"./useFocusRing-Cx5sZpw_.js";import"./usePress-IYK5Xs6I.js";import"./IconApp-CKfGrMYq.js";import"./IconWarning-DoqSRZU1.js";import"./LoadingSpinner-9k8jsvZY.js";import"./Button-CB57Q0FS.js";import"./ProgressBar-CpzbYRLN.js";import"./useLabel-BA8WH6BO.js";import"./NumberFormatter-DNR9MAW-.js";import"./LiveAnnouncer-CeCcBDbP.js";import"./useFocusable-BZB42ELj.js";function J(l,e){let{onSelect:t,acceptedFileTypes:o,allowsMultiple:i,defaultCamera:n,children:g,acceptDirectory:s,...D}=l,p=U(e),N=P(D);return r.createElement(r.Fragment,null,r.createElement(V,{onPress:()=>{var c,F;!((c=p.current)===null||c===void 0)&&c.value&&(p.current.value=""),(F=p.current)===null||F===void 0||F.click()}},g),r.createElement(O,{...N,type:"file",ref:p,style:{display:"none"},accept:o==null?void 0:o.toString(),onChange:c=>t==null?void 0:t(c.target.files),capture:n,multiple:i,webkitdirectory:s?"":void 0}))}const K=B.forwardRef(J),a=l=>{const{controller:e,children:t,...o}=l;return r.createElement(K,{...o,onSelect:i=>e.selectFile(i,l.allowsMultiple)},t)};a.__docgenInfo={description:"",methods:[],displayName:"FileTrigger",props:{className:{required:!1,tsType:{name:"string"},description:""},controller:{required:!0,tsType:{name:"FileController"},description:""}}};class ${constructor(){E(this,"files",new Map);E(this,"id",0);z(this,{files:G.shallow,add:m.bound,clear:m.bound,dropFile:m.bound,selectFile:m.bound})}static useNew(){return B.useRef(new $).current}useFiles(){return H(()=>Array.from(this.files.values()))}add(e){const t=this.id++;this.files.set(t,e)}clear(){this.files.clear()}async dropFile(e,t,o){e.items.filter(n=>n.kind==="file").map(async(n,g)=>{const s=await n.getFile();if(t&&!t.includes(s.type))throw new Error("invalid file type");if(!o&&g>0)throw new Error("invalid file count");o||this.clear(),this.add(s)})}selectFile(e,t){(e?Array.from(e):[]).map(i=>{t||this.clear(),this.add(i)})}}const y=()=>$.useNew(),h=l=>{const e=l.controller.useFiles();return r.createElement(I,null,r.createElement(q,null,"Selected files"),r.createElement(j,null,e.length>0?e.map(t=>t.name).join(", "):"-"))},Ne={title:"Upload/FileTrigger",component:a,parameters:{controls:{exclude:["className","controller"]}},render:l=>{const e=y();return r.createElement(S,null,r.createElement(a,{...l,controller:e},r.createElement(b,null,"Select file")),r.createElement(h,{controller:e}))}},u={},d={render:l=>{const e=y();return r.createElement(S,null,r.createElement(a,{...l,controller:e,allowsMultiple:!0},r.createElement(b,null,"Select multiple files")),r.createElement(h,{controller:e}))}},f={render:l=>{const e=y();return r.createElement(S,null,r.createElement(a,{...l,controller:e,acceptedFileTypes:["image/png","image/jpeg"]},r.createElement(b,null,"Select image")),r.createElement(h,{controller:e}))}};var w,v,T;u.parameters={...u.parameters,docs:{...(w=u.parameters)==null?void 0:w.docs,source:{originalSource:"{}",...(T=(v=u.parameters)==null?void 0:v.docs)==null?void 0:T.source}}};var x,C,M;d.parameters={...d.parameters,docs:{...(x=d.parameters)==null?void 0:x.docs,source:{originalSource:`{
  render: props => {
    const controller = useFileController();
    return <Section>
        <FileTrigger {...props} controller={controller} allowsMultiple>
          <Button>Select multiple files</Button>
        </FileTrigger>
        <SelectedFiles controller={controller} />
      </Section>;
  }
}`,...(M=(C=d.parameters)==null?void 0:C.docs)==null?void 0:M.source}}};var R,_,A;f.parameters={...f.parameters,docs:{...(R=f.parameters)==null?void 0:R.docs,source:{originalSource:`{
  render: props => {
    const controller = useFileController();
    return <Section>
        <FileTrigger {...props} controller={controller} acceptedFileTypes={["image/png", "image/jpeg"]}>
          <Button>Select image</Button>
        </FileTrigger>
        <SelectedFiles controller={controller} />
      </Section>;
  }
}`,...(A=(_=f.parameters)==null?void 0:_.docs)==null?void 0:A.source}}};const ke=["Default","AllowsMultiple","AcceptedFileTypes"];export{f as AcceptedFileTypes,d as AllowsMultiple,u as Default,ke as __namedExportsOrder,Ne as default};
