import{j as r,r as E}from"./iframe-B9WJ5iKj.js";import{M as R}from"./Markdown-BDiRTXlW.js";import{T as B}from"./TextArea-BbillsSQ.js";import{O as k,K as T,P as O,Q as C,R as F}from"./IconWarning-iA3abBs4.js";import{B as S}from"./Button-D_a9cGts.js";import{$ as I}from"./useLocalizedStringFormatter-DFSg5pkm.js";import{c as H}from"./clsx-B-dksMZM.js";import{f as z}from"./PropsContextProvider-CGbAkxa2.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],U=k("outline","bold","Bold",P);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],Q=k("outline","italic","Italic",K);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],V=k("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],G=k("outline","strikethrough","Strikethrough",Z);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],X=k("filled","quote-filled","QuoteFilled",J),Y="flow--markdown-editor",ee="flow--markdown-editor--toolbar",te="flow--markdown-editor--toolbar-buttons",ne="flow--markdown-editor--mode-button",se="flow--markdown-editor--markdown",w={markdownEditor:Y,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:ee,toolbarButtons:te,modeButton:ne,markdown:se},oe={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},q=(e,p)=>{const i=e.lastIndexOf(`
`,p-1);return i===-1?0:i+1},$=(e,p)=>{const i=e.indexOf(`
`,p);return i===-1?e.length:i},re=(e,p,i,m,c)=>{const h=i.current;if(!h)return;const{before:a,after:b="",toggleable:x=!1}=oe[m],t=h.selectionStart,u=h.selectionEnd,o=e.substring(t,u),y=o.split(`
`);let l=e,n=t,d=u;if(m==="code"&&o.includes(`
`))l=e.substring(0,t)+"```\n"+o+"\n```\n"+e.substring(u),n=t+4,d=n+o.length;else if(m==="orderedList")if(o){const s=y.map((g,f)=>`${f+1}. ${g}`).join(`
`);l=e.substring(0,t)+s+e.substring(u),n=t,d=t+s.length}else{const s=q(e,t),g=$(e,t),f=`1. ${e.substring(s,g)}`;l=e.substring(0,s)+a+e.substring(s),n=s+f.length,d=n}else if(m==="unorderedList")if(o){const s=y.map(g=>`${a}${g}`).join(`
`);l=e.substring(0,t)+s+e.substring(u),n=t,d=t+s.length}else{const s=q(e,t),g=$(e,t),f=`- ${e.substring(s,g)}`;l=e.substring(0,s)+a+e.substring(s),n=s+f.length,d=n}else if(m==="quote")if(o){const s=y.map(g=>`${a}${g}`).join(`
`);l=e.substring(0,t)+s+e.substring(u),n=t,d=t+s.length}else{const s=`
${a} `;l=e.substring(0,t)+s+e.substring(u),n=t+s.length,d=n}else if(x){const s=e.substring(t-a.length,t),g=e.substring(u,u+b.length),f=s===a&&g===b,M=o.startsWith(a)&&o.endsWith(b);if(f)l=e.substring(0,t-a.length)+o+e.substring(u+b.length),n=t-a.length,d=n+o.length;else if(M){const j=o.slice(a.length,o.length-b.length);l=e.substring(0,t)+j+e.substring(u),n=t,d=t+j.length}else l=e.substring(0,t)+a+o+b+e.substring(u),o.length===0?(n=t+a.length,d=n):(n=t+a.length,d=n+o.length)}else if(m==="link"){let s="",g="",f="",M=0;o?(A=>{try{return new URL(A),!0}catch{return!1}})(o)?(g=o,f=`[](${g})`,M=t+1):(s=o,f=`[${s}]()`,M=t+f.indexOf("](")+2):(f="[](https://)",M=t+1),l=e.substring(0,t)+f+e.substring(u),n=d=M}else l=e.substring(0,t)+a+o+b+e.substring(u),o.length===0?(n=t+a.length,d=n):(n=t+a.length,d=n+o.length);p(l),c&&c(l),requestAnimationFrame(()=>{h.setSelectionRange(n,d),h.focus()})},N={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},v=e=>{const{markdown:p,setMarkdown:i,textAreaRef:m,children:c,isDisabled:h,type:a,onChange:b,mode:x}=e,t=I(N);return r.jsx(S,{isDisabled:h||x==="preview","aria-label":t.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>re(p,i,m,a,b),children:c})};v.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!0,tsType:{name:"InsertType"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""}},composes:["PropsWithChildren"]};const _=e=>{const{setMode:p,mode:i,isDisabled:m}=e,c=I(N),h=i==="editor"?"preview":"editor";return r.jsx(S,{isDisabled:m,className:w.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>p(h),children:c.format(`mode.${h}`)})};_.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}};const D=e=>{const{setMode:p,...i}=e;return r.jsxs("header",{className:w.toolbar,role:"toolbar",children:[r.jsxs("div",{className:w.toolbarButtons,children:[r.jsx(v,{...i,type:"bold",children:r.jsx(T,{children:r.jsx(U,{})})}),r.jsx(v,{...i,type:"italic",children:r.jsx(T,{children:r.jsx(Q,{})})}),r.jsx(v,{...i,type:"strikeThrough",children:r.jsx(T,{children:r.jsx(G,{})})}),r.jsx(v,{...i,type:"quote",children:r.jsx(T,{children:r.jsx(X,{})})}),r.jsx(v,{...i,type:"code",children:r.jsx(O,{})}),r.jsx(v,{...i,type:"link",children:r.jsx(C,{})}),r.jsx(v,{...i,type:"unorderedList",children:r.jsx(T,{children:r.jsx(F,{})})}),r.jsx(v,{...i,type:"orderedList",children:r.jsx(T,{children:r.jsx(V,{})})})]}),r.jsx(_,{setMode:p,mode:e.mode,isDisabled:e.isDisabled})]})};D.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}}};const L=e=>{const{selectionStart:p}=e,i=parseInt(getComputedStyle(e).lineHeight||"20",10),m=e.value.slice(0,p).split(`
`).length;e.scrollTop=(m-1)*i},ie=(e,p,i,m)=>{if(e.key!=="Enter")return;const c=p.current;if(!c)return;const h=c.selectionStart,a=c.selectionEnd,b=c.value,x=b.slice(0,h),t=b.slice(a),u=x.lastIndexOf(`
`)+1,o=x.slice(u),y=o.match(/^(\s*)(\d+)\.\s+/),l=o.match(/^(\s*)([-*+])\s+/);if((y||l)&&o.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const n=b.slice(0,u)+`
`+t;i(n),m&&m(n),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=u+1,L(c)});return}if(y){e.preventDefault();const n=y[1],d=parseInt(y[2]??"",10)+1,s=`
${n}${d}. `,g=x+s+t;i(g),m&&m(g),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=h+s.length,L(c)})}else if(l){e.preventDefault();const n=l[1],d=l[2],s=`
${n}${d} `,g=x+s+t;i(g),m&&m(g),requestAnimationFrame(()=>{c.selectionStart=c.selectionEnd=h+s.length,L(c)})}},ae=z("MarkdownEditor",e=>{const{isDisabled:p,children:i,className:m,value:c,onChange:h,rows:a,autoResizeMaxRows:b,...x}=e,[t,u]=E.useState(c??""),[o,y]=E.useState("editor"),l=E.useRef(null),n=H(w.markdownEditor,m,w[`mode-${o}`]);return r.jsxs(B,{...x,isDisabled:p||o==="preview",className:n,ref:l,value:t,rows:a,autoResizeMaxRows:b,onChange:d=>u(d),onKeyDown:d=>ie(d,l,u,h),children:[r.jsx(D,{markdown:t,setMarkdown:u,textAreaRef:l,setMode:y,mode:o,isDisabled:p,onChange:h}),r.jsx(R,{className:w.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${b??a} + (var(--form-control--padding-y) * 2))`},children:t}),i]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
