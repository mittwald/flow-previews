import{$ as z,a as ae}from"./Collection-BlKc58PT.js";import{b as q,a as I,d as G,e as le,$ as J,f as re}from"./utils-CTzaLK4l.js";import{$ as T,a as ie,b as Q,c as de,d as ne}from"./DragAndDrop-B00As7Yo.js";import{m as se,n as ce,o as ue}from"./Dialog-C6Hf8kgU.js";import{a as fe}from"./RSPContexts-k_uvwm8O.js";import{$ as $e,a as be}from"./SelectionIndicator-ey4emqqq.js";import{$ as ve}from"./Separator-xctm41Qr.js";import{a as pe}from"./Text-Cbq-V_qs.js";import{$ as X,c as ge,e as me,f as xe,i as he}from"./CollectionBuilder-C9MyseWf.js";import{b as Y,$ as C,g as K,e as Pe}from"./index-CcQr3Ju_.js";import{$ as k}from"./filterDOMProps-i7L6S0l1.js";import{$ as De}from"./inertValue-Ly9xhoQC.js";import{r as s,R as d}from"./iframe-B-_izELn.js";import{b as Se}from"./usePress-CDCEcfQ2.js";import{r as ye,p as Ee,e as j}from"./useFocus-BKzgn786.js";import{b as Be,$ as Z,a as Ce}from"./useFocusRing-DHjGYA3Q.js";import{e as Me,a as Fe}from"./SelectionManager-Bstf7-gd.js";import{a as ke}from"./useLabel-DZiDffWU.js";import{a as Le,$ as we}from"./useListState-fKZq3HfY.js";import{$ as Ie}from"./context-CP_ivtNk.js";import{b as _e}from"./useCollator-Sj9w00om.js";import{a as Ae}from"./FocusScope-BQUCV4aX.js";const R=new WeakMap;function Ue(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function Ve(t,e){let l=R.get(t);if(!l)throw new Error("Unknown list");return`${l.id}-option-${Ue(e)}`}function Oe(t,e,l){let o=k(t,{labelable:!0}),r=t.selectionBehavior||"toggle",i=t.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&i==="action"&&(i="override");let{listProps:a}=se({...t,ref:l,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:i}),{focusWithinProps:n}=Be({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),c=Y(t.id);R.set(e,{id:c,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction,linkBehavior:i,UNSTABLE_itemBehavior:t.UNSTABLE_itemBehavior});let{labelProps:$,fieldProps:b}=ke({...t,id:c,labelElementType:"span"});return{labelProps:$,listBoxProps:C(o,n,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...C(b,a)})}}function Te(t,e,l){var o,r;let{key:i}=t,a=R.get(e);var n;let c=(n=t.isDisabled)!==null&&n!==void 0?n:e.selectionManager.isDisabled(i);var $;let b=($=t.isSelected)!==null&&$!==void 0?$:e.selectionManager.isSelected(i);var v;let u=(v=t.shouldSelectOnPressUp)!==null&&v!==void 0?v:a?.shouldSelectOnPressUp;var x;let g=(x=t.shouldFocusOnHover)!==null&&x!==void 0?x:a?.shouldFocusOnHover;var m;let p=(m=t.shouldUseVirtualFocus)!==null&&m!==void 0?m:a?.shouldUseVirtualFocus;var h;let E=(h=t.isVirtualized)!==null&&h!==void 0?h:a?.isVirtualized,M=K(),P=K(),S={role:"option","aria-disabled":c||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?b:void 0};ye()&&Ee()||(S["aria-label"]=t["aria-label"],S["aria-labelledby"]=M,S["aria-describedby"]=P);let f=e.collection.getItem(i);if(E){let y=Number(f?.index);S["aria-posinset"]=Number.isNaN(y)?void 0:y+1,S["aria-setsize"]=ce(e.collection)}let D=a?.onAction?()=>{var y;return a==null||(y=a.onAction)===null||y===void 0?void 0:y.call(a,i)}:void 0,B=Ve(e,i),{itemProps:L,isPressed:A,isFocused:w,hasAction:H,allowsSelection:U}=Me({selectionManager:e.selectionManager,key:i,ref:l,shouldSelectOnPressUp:u,allowsDifferentPressOrigin:u&&g,isVirtualized:E,shouldUseVirtualFocus:p,isDisabled:c,onAction:D||!(f==null||(o=f.props)===null||o===void 0)&&o.onAction?Pe(f==null||(r=f.props)===null||r===void 0?void 0:r.onAction,D):void 0,linkBehavior:a?.linkBehavior,UNSTABLE_itemBehavior:a?.UNSTABLE_itemBehavior,id:B}),{hoverProps:V}=Z({isDisabled:c||!g,onHoverStart(){j()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(i))}}),F=k(f?.props);delete F.id;let O=Se(f?.props);return{optionProps:{...S,...C(F,L,V,O),id:B},labelProps:{id:M},descriptionProps:{id:P},isFocused:w,isFocusVisible:w&&e.selectionManager.isFocused&&j(),isSelected:b,isDisabled:c,isPressed:A,allowsSelection:U,hasAction:H}}function He(t){let{heading:e,"aria-label":l}=t,o=Y();return{itemProps:{role:"presentation"},headingProps:e?{id:o,role:"presentation"}:{},groupProps:{role:"group","aria-label":l,"aria-labelledby":e?o:void 0}}}const ee=s.createContext(null),_=s.createContext(null),vo=s.forwardRef(function(e,l){[e,l]=J(e,l,ee);let o=s.useContext(_);return o?d.createElement(oe,{state:o,props:e,listBoxRef:l}):d.createElement(me,{content:d.createElement(xe,e)},r=>d.createElement(Ne,{props:e,listBoxRef:l,collection:r}))});function Ne({props:t,listBoxRef:e,collection:l}){t={...t,collection:l,children:null,items:null};let{layoutDelegate:o}=s.useContext(z),r=we({...t,layoutDelegate:o});return d.createElement(oe,{state:r,props:t,listBoxRef:e})}function oe({state:t,props:e,listBoxRef:l}){[e,l]=J(e,l,fe);let{dragAndDropHooks:o,layout:r="stack",orientation:i="vertical",filter:a}=e,n=Le(t,a),{collection:c,selectionManager:$}=n,b=!!o?.useDraggableCollectionState,v=!!o?.useDroppableCollectionState,{direction:u}=Ie(),{disabledBehavior:x,disabledKeys:g}=$,m=_e({usage:"search",sensitivity:"base"}),{isVirtualized:p,layoutDelegate:h,dropTargetDelegate:E,CollectionRoot:M}=s.useContext(z),P=s.useMemo(()=>e.keyboardDelegate||new Fe({collection:c,collator:m,ref:l,disabledKeys:g,disabledBehavior:x,layout:r,orientation:i,direction:u,layoutDelegate:h}),[c,m,l,x,g,i,u,e.keyboardDelegate,r,h]),{listBoxProps:S}=Oe({...e,shouldSelectOnPressUp:b||e.shouldSelectOnPressUp,keyboardDelegate:P,isVirtualized:p},n,l);s.useRef(b),s.useRef(v),s.useEffect(()=>{},[b,v]);let f,D,B,L=!1,A=null,w=s.useRef(null);if(b&&o){f=o.useDraggableCollectionState({collection:c,selectionManager:$,preview:o.renderDragPreview?w:void 0}),o.useDraggableCollection({},f,l);let N=o.DragPreview;A=o.renderDragPreview?d.createElement(N,{ref:w},o.renderDragPreview):null}if(v&&o){D=o.useDroppableCollectionState({collection:c,selectionManager:$});let N=o.dropTargetDelegate||E||new o.ListDropTargetDelegate(c,l,{orientation:i,layout:r,direction:u});B=o.useDroppableCollection({keyboardDelegate:P,dropTargetDelegate:N},D,l),L=D.isDropTarget({type:"root"})}let{focusProps:H,isFocused:U,isFocusVisible:V}=Ce(),F=n.collection.size===0,O={isDropTarget:L,isEmpty:F,isFocused:U,isFocusVisible:V,layout:e.layout||"stack",state:n},y=I({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:O}),W=null;F&&e.renderEmptyState&&(W=d.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(O)));let te=k(e,{global:!0});return d.createElement(Ae,null,d.createElement("div",{...C(te,y,S,H,B?.collectionProps),ref:l,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":L||void 0,"data-empty":F||void 0,"data-focused":U||void 0,"data-focus-visible":V||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},d.createElement(G,{values:[[ee,e],[_,n],[T,{dragAndDropHooks:o,dragState:f,dropState:D}],[ve,{elementType:"div"}],[ie,{render:Re}],[ae,{name:"ListBoxSection",render:ze}]]},d.createElement(be,null,d.createElement(M,{collection:c,scrollRef:l,persistedKeys:de($,o,D),renderDropIndicator:Q(o,D)}))),W,A))}function ze(t,e,l,o="react-aria-ListBoxSection"){let r=s.useContext(_),{dragAndDropHooks:i,dropState:a}=s.useContext(T),{CollectionBranch:n}=s.useContext(z),[c,$]=re();var b;let{headingProps:v,groupProps:u}=He({heading:$,"aria-label":(b=t["aria-label"])!==null&&b!==void 0?b:void 0}),x=I({defaultClassName:o,className:t.className,style:t.style,values:{}}),g=k(t,{global:!0});return delete g.id,d.createElement("section",{...C(g,x,u),ref:e},d.createElement(ue.Provider,{value:{...v,ref:c}},d.createElement(n,{collection:r.collection,parent:l,renderDropIndicator:Q(i,a)})))}const po=X(ge,function(e,l,o){let r=q(l),i=s.useContext(_),{dragAndDropHooks:a,dragState:n,dropState:c}=s.useContext(T),{optionProps:$,labelProps:b,descriptionProps:v,...u}=Te({key:o.key,"aria-label":e?.["aria-label"]},i,r),{hoverProps:x,isHovered:g}=Z({isDisabled:!u.allowsSelection&&!u.hasAction,onHoverStart:o.props.onHoverStart,onHoverChange:o.props.onHoverChange,onHoverEnd:o.props.onHoverEnd}),m=null;n&&a&&(m=a.useDraggableItem({key:o.key},n));let p=null;c&&a&&(p=a.useDroppableItem({target:{type:"item",key:o.key,dropPosition:"on"}},c,r));let h=n&&n.isDragging(o.key),E=I({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...u,isHovered:g,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!n,isDragging:h,isDropTarget:p?.isDropTarget}});s.useEffect(()=>{o.textValue},[o.textValue]);let M=e.href?"a":"div",P=k(e,{global:!0});return delete P.id,delete P.onClick,d.createElement(M,{...C(P,E,$,x,m?.dragProps,p?.dropProps),ref:r,"data-allows-dragging":!!n||void 0,"data-selected":u.isSelected||void 0,"data-disabled":u.isDisabled||void 0,"data-hovered":g||void 0,"data-focused":u.isFocused||void 0,"data-focus-visible":u.isFocusVisible||void 0,"data-pressed":u.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":p?.isDropTarget||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},d.createElement(G,{values:[[pe,{slots:{[le]:b,label:b,description:v}}],[$e,{isSelected:u.isSelected}]]},E.children))});function Re(t,e){e=q(e);let{dragAndDropHooks:l,dropState:o}=s.useContext(T),{dropIndicatorProps:r,isHidden:i,isDropTarget:a}=l.useDropIndicator(t,o,e);return i?null:d.createElement(Ke,{...t,dropIndicatorProps:r,isDropTarget:a,ref:e})}function We(t,e){let{dropIndicatorProps:l,isDropTarget:o,...r}=t,i=I({...r,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:o}});return d.createElement("div",{...l,...i,role:"option",ref:e,"data-drop-target":o||void 0})}const Ke=s.forwardRef(We);X(he,function(e,l,o){let r=s.useContext(_),{isLoading:i,onLoadMore:a,scrollOffset:n,...c}=e,$=s.useRef(null),b=s.useMemo(()=>({onLoadMore:a,collection:r?.collection,sentinelRef:$,scrollOffset:n}),[a,n,r?.collection]);ne(b,$);let v=I({...c,id:void 0,children:o.rendered,defaultClassName:"react-aria-ListBoxLoadingIndicator",values:null}),u={tabIndex:-1};return d.createElement(d.Fragment,null,d.createElement("div",{style:{position:"relative",width:0,height:0},inert:De(!0)},d.createElement("div",{"data-testid":"loadMoreSentinel",ref:$,style:{position:"absolute",height:1,width:1}})),i&&v.children&&d.createElement("div",{...C(k(e,{global:!0}),u),...v,role:"option",ref:l},v.children))});export{_ as $,ee as a,vo as b,po as c,R as d,Ve as e};
