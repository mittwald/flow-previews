import{r as o,R as s}from"./index-B-o1Wr-g.js";import{c as S}from"./clsx-B-dksMZM.js";import{d as M,e as N,f as L,g as T,h as m,i as z,j as I,u as B,c as _,b as q}from"./OverlayTrigger-DHdiavxl.js";import{$ as A,c as E,h as p,i as y,a as h,g as F,b as U}from"./utils-CCebJm36.js";import{$ as O,a as x}from"./index-ynQ6n1pc.js";import{$ as C}from"./filterDOMProps-CeZl_uWj.js";import{a as K}from"./OverlayArrow-BMY-498z.js";let d=typeof document<"u"&&window.visualViewport;function V(){let t=O(),[e,i]=o.useState(()=>t?{width:0,height:0}:v());return o.useEffect(()=>{let a=()=>{i(n=>{let r=v();return r.width===n.width&&r.height===n.height?n:r})};return d?d.addEventListener("resize",a):window.addEventListener("resize",a),()=>{d?d.removeEventListener("resize",a):window.removeEventListener("resize",a)}},[]),e}function v(){return{width:d&&(d==null?void 0:d.width)||window.innerWidth,height:d&&(d==null?void 0:d.height)||window.innerHeight}}function W(t,e,i){let{overlayProps:a,underlayProps:n}=M({...t,isOpen:e.isOpen,onClose:e.close},i);return N({isDisabled:!e.isOpen}),L(),o.useEffect(()=>{if(e.isOpen&&i.current)return T([i.current])},[e.isOpen,i]),{modalProps:x(a),underlayProps:n}}const j=o.createContext(null),b=o.createContext(null);function H(t,e){if(o.useContext(b))return s.createElement(g,{...t,modalRef:e},t.children);let{isDismissable:a,isKeyboardDismissDisabled:n,isOpen:r,defaultOpen:f,onOpenChange:l,children:$,isEntering:c,isExiting:u,UNSTABLE_portalContainer:R,shouldCloseOnInteractOutside:P,...D}=t;return s.createElement(w,{isDismissable:a,isKeyboardDismissDisabled:n,isOpen:r,defaultOpen:f,onOpenChange:l,isEntering:c,isExiting:u,UNSTABLE_portalContainer:R,shouldCloseOnInteractOutside:P},s.createElement(g,{...D,modalRef:e},$))}const k=o.forwardRef(H);function G(t,e){[t,e]=A(t,e,j);let i=o.useContext(m),a=K(t),n=t.isOpen!=null||t.defaultOpen!=null||!i?a:i,r=E(e),f=o.useRef(null),l=p(r,n.isOpen),$=p(f,n.isOpen),c=l||$||t.isExiting||!1,u=O();return!n.isOpen&&!c||u?null:s.createElement(J,{...t,state:n,isExiting:c,overlayRef:r,modalRef:f})}const w=o.forwardRef(G);function J({UNSTABLE_portalContainer:t,...e}){let i=e.modalRef,{state:a}=e,{modalProps:n,underlayProps:r}=W(e,a,i),f=y(e.overlayRef)||e.isEntering||!1,l=h({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:f,isExiting:e.isExiting,state:a}}),$=V(),c={...l.style,"--visual-viewport-height":$.height+"px"};return s.createElement(z,{isExiting:e.isExiting,portalContainer:t},s.createElement("div",{...x(C(e),r),...l,style:c,ref:e.overlayRef,"data-entering":f||void 0,"data-exiting":e.isExiting||void 0},s.createElement(F,{values:[[b,{modalProps:n,modalRef:i,isExiting:e.isExiting,isDismissable:e.isDismissable}],[m,a]]},l.children)))}function g(t){let{modalProps:e,modalRef:i,isExiting:a,isDismissable:n}=o.useContext(b),r=o.useContext(m),f=o.useMemo(()=>U(t.modalRef,i),[t.modalRef,i]),l=E(f),$=y(l),c=h({...t,defaultClassName:"react-aria-Modal",values:{isEntering:$,isExiting:a,state:r}});return s.createElement("div",{...x(C(t),e),...c,ref:l,"data-entering":$||void 0,"data-exiting":a||void 0},n&&s.createElement(I,{onDismiss:r.close}),c.children)}const Q="flow--overlay",X={overlay:Q,"overlay-fade":"flow--overlay--overlay-fade"},Y=t=>{const{controller:e,children:i,isDismissable:a=!0,className:n,overlayType:r="Modal"}=t,f=B(r,{reuseControllerFromContext:!0}),l=e??f,$=l.useIsOpen(),c=S(X.overlay,n);return s.createElement(w,{className:c,isDismissable:a,isOpen:$,onOpenChange:u=>l.setOpen(u)},s.createElement(k,null,s.createElement(_,null,s.createElement(q,{type:"Modal",controller:l},i))))};Y.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{controller:{required:!1,tsType:{name:"OverlayController"},description:""},isDismissable:{required:!1,tsType:{name:"boolean"},description:""},className:{required:!1,tsType:{name:"string"},description:""},overlayType:{required:!1,tsType:{name:"union",raw:'"Modal" | "LightBox"',elements:[{name:"literal",value:'"Modal"'},{name:"literal",value:'"LightBox"'}]},description:""}},composes:["PropsWithChildren"]};export{Y as O};
