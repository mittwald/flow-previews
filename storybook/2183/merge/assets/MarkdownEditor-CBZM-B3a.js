import{j as n,r as O}from"./iframe-CN4G8qqm.js";import{M as R}from"./Markdown-DH1jHG0B.js";import{T as F}from"./TextArea-W8LH9v11.js";import{c as M,b as B,d as w}from"./IconChevronDown-oGa76fM6.js";import{B as P}from"./Button-Bq80dFyw.js";import{$ as _}from"./useLocalizedStringFormatter-B9Hz40nN.js";import{I as U}from"./IconList-Ds7-sRtV.js";import{c as z}from"./clsx-B-dksMZM.js";import{f as H,N as K,P as W}from"./PropsContextProvider-4OAE62jj.js";import{c as A}from"./utils-DbmEdXKf.js";import{u as Q}from"./useControlledHostValueProps-D4EY9U9i.js";const Z=[["path",{d:"M6 15h15",key:"svg-0"}],["path",{d:"M21 19h-15",key:"svg-1"}],["path",{d:"M15 11h6",key:"svg-2"}],["path",{d:"M21 7h-6",key:"svg-3"}],["path",{d:"M9 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-4"}],["path",{d:"M3 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-5"}]],G=M("outline","blockquote","Blockquote",Z);const J=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],X=M("outline","bold","Bold",J);const Y=[["path",{d:"M7 8l-4 4l4 4",key:"svg-0"}],["path",{d:"M17 8l4 4l-4 4",key:"svg-1"}],["path",{d:"M14 4l-4 16",key:"svg-2"}]],ee=M("outline","code","Code",Y);const te=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],oe=M("outline","italic","Italic",te);const ne=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],se=M("outline","link","Link",ne);const re=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],ie=M("outline","list-numbers","ListNumbers",re);const le=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],ce=M("outline","strikethrough","Strikethrough",le),E=e=>n.jsx(B,{...e,children:n.jsx(ee,{})});E.__docgenInfo={description:"",methods:[],displayName:"IconCode"};const N=e=>n.jsx(B,{...e,children:n.jsx(se,{})});N.__docgenInfo={description:"",methods:[],displayName:"IconLink"};const de="flow--markdown-editor",ae="flow--markdown-editor--toolbar",ue="flow--markdown-editor--toolbar-buttons",he="flow--markdown-editor--mode-button",ge="flow--markdown-editor--markdown",k={markdownEditor:de,toolbar:ae,toolbarButtons:ue,modeButton:he,markdown:ge,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview"},pe={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},I=(e,s)=>{const a=e.lastIndexOf(`
`,s-1);return a===-1?0:a+1},L=(e,s)=>{const a=e.indexOf(`
`,s);return a===-1?e.length:a},be=(e="",s,a)=>{if(!a.current)return{newValue:e,newSelectionStart:null,newSelectionEnd:null};const g=a.current,{before:c,after:h="",toggleable:x=!1}=pe[s],t=g.selectionStart,d=g.selectionEnd,r=e.substring(t,d),f=r.split(`
`);let u=e,o=t,i=d;if(s==="code"&&r.includes(`
`))u=e.substring(0,t)+"```\n"+r+"\n```\n"+e.substring(d),o=t+4,i=o+r.length;else if(s==="orderedList")if(r){const l=f.map((p,b)=>`${b+1}. ${p}`).join(`
`);u=e.substring(0,t)+l+e.substring(d),o=t,i=t+l.length}else{const l=I(e,t),p=L(e,t),b=`1. ${e.substring(l,p)}`;u=e.substring(0,l)+c+e.substring(l),o=l+b.length,i=o}else if(s==="unorderedList")if(r){const l=f.map(p=>`${c}${p}`).join(`
`);u=e.substring(0,t)+l+e.substring(d),o=t,i=t+l.length}else{const l=I(e,t),p=L(e,t),b=`- ${e.substring(l,p)}`;u=e.substring(0,l)+c+e.substring(l),o=l+b.length,i=o}else if(s==="quote")if(r){const l=f.map(p=>`${c}${p}`).join(`
`);u=e.substring(0,t)+l+e.substring(d),o=t,i=t+l.length}else{const l=`
${c} `;u=e.substring(0,t)+l+e.substring(d),o=t+l.length,i=o}else if(x){const l=e.substring(t-c.length,t),p=e.substring(d,d+h.length),b=l===c&&p===h,y=r.startsWith(c)&&r.endsWith(h);if(b)u=e.substring(0,t-c.length)+r+e.substring(d+h.length),o=t-c.length,i=o+r.length;else if(y){const j=r.slice(c.length,r.length-h.length);u=e.substring(0,t)+j+e.substring(d),o=t,i=t+j.length}else u=e.substring(0,t)+c+r+h+e.substring(d),r.length===0?(o=t+c.length,i=o):(o=t+c.length,i=o+r.length)}else if(s==="link"){let l="",p="",b="",y=0;r?(v=>{try{return new URL(v),!0}catch{return!1}})(r)?(p=r,b=`[](${p})`,y=t+1):(l=r,b=`[${l}]()`,y=t+b.indexOf("](")+2):(b="[](https://)",y=t+1),u=e.substring(0,t)+b+e.substring(d),o=i=y}else u=e.substring(0,t)+c+r+h+e.substring(d),r.length===0?(o=t+c.length,i=o):(o=t+c.length,i=o+r.length);return{newValue:u,newSelectionStart:o,newSelectionEnd:i}},C={"de-DE":{"mode.editor":"Vorschau beenden","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Exit Preview","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},m=e=>{const{children:s,type:a,onPress:g,...c}=e,h=_(C);return n.jsx(P,{...c,"data-button-type":a,"aria-label":h.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>g?.(a),children:s})};m.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onPress:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const q=e=>{const{currentMode:s,onChange:a,...g}=e,c=_(C),h=s==="editor"?"preview":"editor";return n.jsx(P,{className:k.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{a?.(h)},...g,children:c.format(`mode.${h}`)})};q.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const V=e=>{const s={onPress:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return n.jsxs("header",{className:k.toolbar,role:"toolbar",children:[n.jsxs("div",{className:k.toolbarButtons,children:[n.jsx(m,{...s,type:"bold",children:n.jsx(w,{children:n.jsx(X,{})})}),n.jsx(m,{...s,type:"italic",children:n.jsx(w,{children:n.jsx(oe,{})})}),n.jsx(m,{...s,type:"strikeThrough",children:n.jsx(w,{children:n.jsx(ce,{})})}),n.jsx(m,{...s,type:"quote",children:n.jsx(w,{children:n.jsx(G,{})})}),n.jsx(m,{...s,type:"code",children:n.jsx(E,{})}),n.jsx(m,{...s,type:"link",children:n.jsx(N,{})}),n.jsx(m,{...s,type:"unorderedList",children:n.jsx(w,{children:n.jsx(U,{})})}),n.jsx(m,{...s,type:"orderedList",children:n.jsx(w,{children:n.jsx(ie,{})})})]}),n.jsx(q,{onChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};V.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{currentMode:{required:!0,tsType:{name:'ModeButtonProps["currentMode"]',raw:'ModeButtonProps["currentMode"]'},description:""},onModeChange:{required:!0,tsType:{name:'ModeButtonProps["onChange"]',raw:'ModeButtonProps["onChange"]'},description:""},onToolPressed:{required:!0,tsType:{name:'ToolBarButtonProps["onPress"]',raw:'ToolBarButtonProps["onPress"]'},description:""}},composes:["Pick"]};const fe=(e="",s)=>{const{selectionStart:a}=s,g=parseInt(getComputedStyle(s).lineHeight||"20",10),c=e.slice(0,a).split(`
`).length;s.scrollTop=(c-1)*g},me=(e="",s)=>{const a=s.current;if(!a)return;const g=a.selectionStart,c=a.selectionEnd,h=e.slice(0,g),x=e.slice(c),t=h.lastIndexOf(`
`)+1,d=h.slice(t),r=d.match(/^(\s*)(\d+)\.\s+/),f=d.match(/^(\s*)([-*+])\s+/);if((r||f)&&d.trim().match(/^([-*+]|\d+\.)$/))return{newValue:e.slice(0,t)+`
`+x,newSelectionStart:t+1,newSelectionEnd:t+1};if(r){const u=r[1],o=parseInt(r[2]??"",10)+1,i=`
${u}${o}. `;return{newValue:h+i+x,newSelectionStart:g+i.length,newSelectionEnd:g+i.length}}else if(f){const u=f[1],o=f[2],i=`
${u}${o} `;return{newValue:h+i+x,newSelectionStart:g+i.length,newSelectionEnd:g+i.length}}},ye=H("MarkdownEditor",e=>{const{isDisabled:s,isReadOnly:a,children:g,className:c,rows:h=5,autoResizeMaxRows:x,headingOffset:t,value:d,onChange:r,ref:f,...u}=Q(e),o=A(f),[i,l]=O.useState("editor"),p=z(k.markdownEditor,c,k[`mode-${i}`]),b=v=>{if(v.key!=="Enter")return;const S=me(d,o);if(!S)return;const{newValue:T,newSelectionStart:$,newSelectionEnd:D}=S;requestAnimationFrame(()=>{o.current&&(o.current.value=T,o.current?.setSelectionRange($,D),fe(T,o.current))}),v.preventDefault(),r(T)},y=v=>{const{newValue:S,newSelectionStart:T,newSelectionEnd:$}=be(d,v,o);requestAnimationFrame(()=>{o.current&&(o.current.value=S,o.current.setSelectionRange(T,$),o.current.focus())}),r(S)},j={Label:{}};return n.jsx("div",{className:p,children:n.jsx(K,{children:n.jsxs(F,{...u,"aria-hidden":i==="preview",isReadOnly:a||i==="preview",isDisabled:s,ref:o,value:d,rows:h,autoResizeMaxRows:x,onChange:r,onKeyDown:b,children:[i==="preview"&&n.jsx(R,{headingOffset:t,className:k.markdown,style:{height:o.current?.offsetHeight},children:d}),n.jsx(W,{props:j,children:g}),n.jsx(V,{currentMode:i,isDisabled:s,onModeChange:l,onToolPressed:y})]})})})});ye.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ye as M};
