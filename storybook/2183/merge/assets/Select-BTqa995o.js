import{r as n,R as S,j as R}from"./iframe-C0Xzz6Xl.js";import{f as G,N as J,P as Q,R as Y}from"./flowComponent-Ds2Zpckn.js";import{u as Z,f as _}from"./useFieldComponent-BRIXb0CQ.js";import{c as j}from"./clsx-B-dksMZM.js";import{a as ee}from"./IconChevronDown-CArgk7t7.js";import{a as le}from"./Option-DHZcafF5.js";import{u as te}from"./useOverlayController-Cc0Bt_a1.js";import{a as N,$ as ae}from"./Button-6QRSCQME.js";import{$ as z,a as H,b as W,f as oe,g as re,c as ie}from"./utils-DFqauJju.js";import{$ as ne}from"./FieldError-D1TN1uH_.js";import{a as se,$ as de}from"./Form-DJAYx_sb.js";import{$ as ce}from"./intlStrings-ZMTSFH_M.js";import{$ as L}from"./Label-CKDZcwiZ.js";import{$ as ue,a as fe}from"./ListBox-CAhXV0ir.js";import{l as me,i as be,m as $e}from"./Dialog-DXKvHJZX.js";import{a as O}from"./Text-DHURGNQD.js";import{$ as ve}from"./CollectionBuilder-D_O-sn_C.js";import{$ as pe}from"./Hidden-C5gaELfT.js";import{$ as w,b as ge,f as ye}from"./index-BvD-rn0f.js";import{$ as k}from"./filterDOMProps-i7L6S0l1.js";import{b as xe,h as he}from"./OverlayArrow-CpBfJzRQ.js";import{$ as Pe}from"./context-D7OeR9su.js";import{$ as Ce}from"./useLocalizedStringFormatter-JxxzEpeY.js";import{b as Se,$ as Me}from"./useFormValidation-D4H7vgpB.js";import{$ as Re}from"./useListState-CoAVWkLI.js";import{$ as Fe}from"./useControlledState-DnOVZzTA.js";import{a as De}from"./useFocusRing-Bftxxd_V.js";import{a as Ie,i as Ve}from"./SelectionManager-B3HFpuo-.js";import{E as Ee}from"./useFocus-B1cKxXv-.js";import{b as Ke}from"./useCollator-BDv8d74S.js";import{$ as Be}from"./useFormReset-BXb8b3rI.js";import{a as we}from"./VisuallyHidden-DF-QcwIB.js";function Oe(e={}){let{locale:l}=Pe();return n.useMemo(()=>new Intl.ListFormat(l,e),[l,e])}const q=new WeakMap;function ke(e,l,s){let{keyboardDelegate:u,isDisabled:a,isRequired:f,name:$,form:o,validationBehavior:c="aria"}=e,m=Ke({usage:"search",sensitivity:"base"}),t=n.useMemo(()=>u||new Ie(l.collection,l.disabledKeys,s,m),[u,l.collection,l.disabledKeys,m,s]),{menuTriggerProps:d,menuProps:v}=me({isDisabled:a,type:"listbox"},l,s),p=y=>{if(l.selectionManager.selectionMode!=="multiple")switch(y.key){case"ArrowLeft":{var D,I;y.preventDefault();let V=l.selectedKey!=null?(D=t.getKeyAbove)===null||D===void 0?void 0:D.call(t,l.selectedKey):(I=t.getFirstKey)===null||I===void 0?void 0:I.call(t);V&&l.setSelectedKey(V);break}case"ArrowRight":{var K,B;y.preventDefault();let V=l.selectedKey!=null?(K=t.getKeyBelow)===null||K===void 0?void 0:K.call(t,l.selectedKey):(B=t.getFirstKey)===null||B===void 0?void 0:B.call(t);V&&l.setSelectedKey(V);break}}},{typeSelectProps:i}=Ve({keyboardDelegate:t,selectionManager:l.selectionManager,onTypeSelect(y){l.setSelectedKey(y)}}),{isInvalid:P,validationErrors:g,validationDetails:b}=l.displayValidation,{labelProps:x,fieldProps:C,descriptionProps:r,errorMessageProps:M}=se({...e,labelElementType:"span",isInvalid:P,errorMessage:e.errorMessage||g});i.onKeyDown=i.onKeyDownCapture,delete i.onKeyDownCapture,l.selectionManager.selectionMode==="multiple"&&(i={});let F=k(e,{labelable:!0}),h=w(i,d,C),E=ge();return q.set(l,{isDisabled:a,isRequired:f,name:$,form:o,validationBehavior:c}),{labelProps:{...x,onClick:()=>{if(!e.isDisabled){var y;(y=s.current)===null||y===void 0||y.focus(),Ee("keyboard")}}},triggerProps:w(F,{...h,isDisabled:a,onKeyDown:ye(h.onKeyDown,p,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[E,h["aria-labelledby"],h["aria-label"]&&!h["aria-labelledby"]?h.id:null].filter(Boolean).join(" "),onFocus(y){l.isFocused||(e.onFocus&&e.onFocus(y),e.onFocusChange&&e.onFocusChange(!0),l.setFocused(!0))},onBlur(y){l.isOpen||(e.onBlur&&e.onBlur(y),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))}}),valueProps:{id:E},menuProps:{...v,autoFocus:l.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:y=>{y.currentTarget.contains(y.relatedTarget)||(e.onBlur&&e.onBlur(y),e.onFocusChange&&e.onFocusChange(!1),l.setFocused(!1))},"aria-labelledby":[C["aria-labelledby"],h["aria-label"]&&!C["aria-labelledby"]?h.id:null].filter(Boolean).join(" ")},descriptionProps:r,errorMessageProps:M,isInvalid:P,validationErrors:g,validationDetails:b,hiddenSelectProps:{isDisabled:a,name:$,label:e.label,state:l,triggerRef:s,form:o}}}function qe(e,l,s){let u=q.get(l)||{},{autoComplete:a,name:f=u.name,form:$=u.form,isDisabled:o=u.isDisabled}=e,{validationBehavior:c,isRequired:m}=u,{visuallyHiddenProps:t}=we({style:{position:"fixed",top:0,left:0}});Be(e.selectRef,l.defaultValue,l.setValue),Se({validationBehavior:c,focus:()=>{var i;return(i=s.current)===null||i===void 0?void 0:i.focus()}},l,e.selectRef);let d=l.setValue,v=n.useCallback(i=>{i.target.multiple?d(Array.from(i.target.selectedOptions,P=>P.value)):d(i.currentTarget.value)},[d]);var p;return{containerProps:{...t,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:a,disabled:o,multiple:l.selectionManager.selectionMode==="multiple",required:c==="native"&&m,name:f,form:$,value:(p=l.value)!==null&&p!==void 0?p:"",onChange:v,onInput:v}}}function Ae(e){let{state:l,triggerRef:s,label:u,name:a,form:f,isDisabled:$}=e,o=n.useRef(null),c=n.useRef(null),{containerProps:m,selectProps:t}=qe({...e,selectRef:l.collection.size<=300?o:c},l,s);if(l.collection.size<=300)return S.createElement("div",{...m,"data-testid":"hidden-select-container"},S.createElement("label",null,u,S.createElement("select",{...t,ref:o},S.createElement("option",null),[...l.collection.getKeys()].map(d=>{let v=l.collection.getItem(d);if(v&&v.type==="item")return S.createElement("option",{key:v.key,value:v.key},v.textValue)}))));if(a){let d=q.get(l)||{},{validationBehavior:v}=d,p=Array.isArray(l.value)?l.value:[l.value];p.length===0&&(p=[null]);let i=p.map((P,g)=>{let b={type:"hidden",autoComplete:t.autoComplete,name:a,form:f,disabled:$,value:P??""};return v==="native"?S.createElement("input",{key:g,...b,ref:g===0?c:null,style:{display:"none"},type:"text",required:g===0?t.required:!1,onChange:()=>{}}):S.createElement("input",{key:g,...b,ref:g===0?c:null})});return S.createElement(S.Fragment,null,i)}return null}function je(e){let{selectionMode:l="single"}=e,s=xe(e),[u,a]=n.useState(null),f=n.useMemo(()=>{var r;return e.defaultValue!==void 0?e.defaultValue:l==="single"?(r=e.defaultSelectedKey)!==null&&r!==void 0?r:null:[]},[e.defaultValue,e.defaultSelectedKey,l]),$=n.useMemo(()=>e.value!==void 0?e.value:l==="single"?e.selectedKey:void 0,[e.value,e.selectedKey,l]),[o,c]=Fe($,f,e.onChange),m=l==="single"&&Array.isArray(o)?o[0]:o,t=r=>{if(l==="single"){var M,F;let h=Array.isArray(r)?(F=r[0])!==null&&F!==void 0?F:null:r;c(h),h!==m&&((M=e.onSelectionChange)===null||M===void 0||M.call(e,h))}else{let h=[];Array.isArray(r)?h=r:r!=null&&(h=[r]),c(h)}},d=Re({...e,selectionMode:l,disallowEmptySelection:l==="single",allowDuplicateSelectionEvents:!0,selectedKeys:n.useMemo(()=>Te(m),[m]),onSelectionChange:r=>{if(r!=="all"){if(l==="single"){var M;let F=(M=r.values().next().value)!==null&&M!==void 0?M:null;t(F),s.close()}else t([...r]);i.commitValidation()}}}),v=d.selectionManager.firstSelectedKey,p=n.useMemo(()=>[...d.selectionManager.selectedKeys].map(r=>d.collection.getItem(r)).filter(r=>r!=null),[d.selectionManager.selectedKeys,d.collection]),i=Me({...e,value:Array.isArray(m)&&m.length===0?null:m}),[P,g]=n.useState(!1),[b]=n.useState(m);var x,C;return{...i,...d,...s,value:m,defaultValue:f??b,setValue:t,selectedKey:v,setSelectedKey:t,selectedItem:(x=p[0])!==null&&x!==void 0?x:null,selectedItems:p,defaultSelectedKey:(C=e.defaultSelectedKey)!==null&&C!==void 0?C:e.selectionMode==="single"?b:null,focusStrategy:u,open(r=null){d.collection.size!==0&&(a(r),s.open())},toggle(r=null){d.collection.size!==0&&(a(r),s.toggle())},isFocused:P,setFocused:g}}function Te(e){if(e!==void 0)return e===null?[]:Array.isArray(e)?e:[e]}function Ne(e){return e&&e.__esModule?e.default:e}const A=n.createContext(null),U=n.createContext(null),ze=n.forwardRef(function(l,s){[l,s]=z(l,s,A);let{children:u,isDisabled:a=!1,isInvalid:f=!1,isRequired:$=!1}=l,o=n.useMemo(()=>typeof u=="function"?u({isOpen:!1,isDisabled:a,isInvalid:f,isRequired:$,isFocused:!1,isFocusVisible:!1,defaultChildren:null}):u,[u,a,f,$]);return S.createElement(ve,{content:o},c=>S.createElement(We,{props:l,collection:c,selectRef:s}))}),He=[L,N,O];function We({props:e,selectRef:l,collection:s}){let{validationBehavior:u}=H(de)||{};var a,f;let $=(f=(a=e.validationBehavior)!==null&&a!==void 0?a:u)!==null&&f!==void 0?f:"native",o=je({...e,collection:s,children:void 0,validationBehavior:$}),{isFocusVisible:c,focusProps:m}=De({within:!0}),t=n.useRef(null),[d,v]=oe(!e["aria-label"]&&!e["aria-labelledby"]),{labelProps:p,triggerProps:i,valueProps:P,menuProps:g,descriptionProps:b,errorMessageProps:x,hiddenSelectProps:C,...r}=ke({...re(e),label:v,validationBehavior:$},o,t),[M,F]=n.useState(null),h=n.useCallback(()=>{t.current&&F(t.current.offsetWidth+"px")},[t]);he({ref:t,onResize:h});let E=n.useMemo(()=>({isOpen:o.isOpen,isFocused:o.isFocused,isFocusVisible:c,isDisabled:e.isDisabled||!1,isInvalid:r.isInvalid||!1,isRequired:e.isRequired||!1}),[o.isOpen,o.isFocused,c,e.isDisabled,r.isInvalid,e.isRequired]),y=W({...e,values:E,defaultClassName:"react-aria-Select"}),D=k(e,{global:!0});delete D.id;let I=n.useRef(null);return S.createElement(ie,{values:[[A,e],[U,o],[X,P],[L,{...p,ref:d,elementType:"span"}],[N,{...i,ref:t,isPressed:o.isOpen,autoFocus:e.autoFocus}],[be,o],[$e,{trigger:"Select",triggerRef:t,scrollRef:I,placement:"bottom start",style:{"--trigger-width":M},"aria-labelledby":g["aria-labelledby"],clearContexts:He}],[ue,{...g,ref:I}],[fe,o],[O,{slots:{description:b,errorMessage:x}}],[ne,r]]},S.createElement("div",{...w(D,y,m),ref:l,slot:e.slot||void 0,"data-focused":o.isFocused||void 0,"data-focus-visible":c||void 0,"data-open":o.isOpen||void 0,"data-disabled":e.isDisabled||void 0,"data-invalid":r.isInvalid||void 0,"data-required":e.isRequired||void 0},y.children,S.createElement(Ae,{...C,autoComplete:e.autoComplete})))}const X=n.createContext(null),Le=pe(function(l,s){var u;[l,s]=z(l,s,X);let a=n.useContext(U),{placeholder:f}=H(A),$=a.selectedItems.map(b=>{var x;let C=(x=b.props)===null||x===void 0?void 0:x.children;return typeof C=="function"&&(C=C({isHovered:!1,isPressed:!1,isSelected:!1,isFocused:!1,isFocusVisible:!1,isDisabled:!1,selectionMode:"single",selectionBehavior:"toggle"})),C}),o=Oe(),c=n.useMemo(()=>a.selectedItems.map(b=>b?.textValue),[a.selectedItems]),m=a.selectionManager.selectionMode,t=n.useMemo(()=>{var b;return m==="single"?(b=c[0])!==null&&b!==void 0?b:"":o.format(c)},[m,o,c]),d=n.useMemo(()=>{if(m==="single")return $[0];let b=o.formatToParts(c);if(b.length===0)return null;let x=0;return b.map(C=>C.type==="element"?S.createElement(n.Fragment,{key:x},$[x++]):C.value)},[m,o,c,$]),v=Ce(Ne(ce),"react-aria-components");var p,i;let P=W({...l,defaultChildren:(p=d??f)!==null&&p!==void 0?p:v.format("selectPlaceholder"),defaultClassName:"react-aria-SelectValue",values:{selectedItem:(i=(u=a.selectedItems[0])===null||u===void 0?void 0:u.value)!==null&&i!==void 0?i:null,selectedItems:n.useMemo(()=>a.selectedItems.map(b=>{var x;return(x=b.value)!==null&&x!==void 0?x:null}),[a.selectedItems]),selectedText:t,isPlaceholder:a.selectedItems.length===0,state:a}}),g=k(l,{global:!0});return S.createElement("span",{ref:s,...g,...P,"data-placeholder":a.selectedItems.length===0||void 0},S.createElement(O.Provider,{value:void 0},P.children))}),Ue="flow--select",Xe="flow--select--toggle",T={select:Ue,toggle:Xe},Ge=G("Select",e=>{const{children:l,className:s,onChange:u,onSelectionChange:a,isReadOnly:f,ref:$,...o}=e,{FieldErrorView:c,fieldPropsContext:m,fieldProps:t,FieldErrorCaptureContext:d}=Z(e),v=j(T.select,_.formField,s),p={Option:{tunnelId:"options"},...m},i=te("Select",{reuseControllerFromContext:!1}),P=i.useIsOpen();return R.jsx(ze,{...o,...t,className:j(v,t.className),onChange:g=>{f||(u?.(g),a?.(g))},onOpenChange:g=>!f&&i.setOpen(g),isOpen:P,"data-readonly":f,children:R.jsxs(J,{children:[R.jsx(d,{children:R.jsxs(Q,{props:p,children:[R.jsxs(ae,{"data-readonly":f,className:T.toggle,ref:$,children:[R.jsx(Le,{}),R.jsx(ee,{})]}),l,R.jsx(le,{controller:i,children:R.jsx(Y,{id:"options"})})]})}),R.jsx(c,{})]})})});Ge.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"Select"};export{Ge as S};
