import{$ as z,a as Z}from"./Collection-BUbbDiz9.js";import{c as j,a as A,g as q,$ as ee,d as oe}from"./utils-D4Vol65q.js";import{$ as T,a as te,b as ae,c as G}from"./DragAndDrop-B4RJ-jxl.js";import{l as ne,m as re,n as de}from"./Dialog-BQ_biHhV.js";import{a as ie}from"./Separator-CpmRlxds.js";import{a as le}from"./Text-oWh285ma.js";import{a as se,b as ce,c as ue}from"./CollectionBuilder-DOwRmyqO.js";import{d as J,a as E,e as K,f as fe}from"./index-CPTjWdH1.js";import{$ as _}from"./filterDOMProps-BSfnXAP7.js";import{r as s,R as u}from"./index-BbMBc-iG.js";import{a as pe}from"./usePress-DotMbixf.js";import{$ as be,i as $e,j as ge,a as Q,k as W,b as me}from"./useFocusRing-DA2rHHrb.js";import{c as ve,d as he}from"./SelectionManager-DnQnei6w.js";import{$ as xe}from"./useLabel-C5NcpKQ2.js";import{$ as De}from"./useListState-CvnwkDin.js";import{a as Pe}from"./useLocalizedStringFormatter-DYdTqA_9.js";import{$ as ye}from"./useCollator-CzQekWjs.js";import{a as Se}from"./FocusScope-TaiHum7E.js";const N=new WeakMap;function ke(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function Fe(e,o){let n=N.get(e);if(!n)throw new Error("Unknown list");return`${n.id}-option-${ke(o)}`}function Be(e,o,n){let t=_(e,{labelable:!0}),d=e.selectionBehavior||"toggle",r=e.linkBehavior||(d==="replace"?"action":"override");d==="toggle"&&r==="action"&&(r="override");let{listProps:a}=ne({...e,ref:n,selectionManager:o.selectionManager,collection:o.collection,disabledKeys:o.disabledKeys,linkBehavior:r}),{focusWithinProps:i}=be({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),c=J(e.id);N.set(o,{id:c,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:r});let{labelProps:p,fieldProps:b}=xe({...e,id:c,labelElementType:"span"});return{labelProps:p,listBoxProps:E(t,i,o.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...E(b,a)})}}function we(e,o,n){var t,d;let{key:r}=e,a=N.get(o);var i;let c=(i=e.isDisabled)!==null&&i!==void 0?i:o.selectionManager.isDisabled(r);var p;let b=(p=e.isSelected)!==null&&p!==void 0?p:o.selectionManager.isSelected(r);var m;let f=(m=e.shouldSelectOnPressUp)!==null&&m!==void 0?m:a==null?void 0:a.shouldSelectOnPressUp;var v;let S=(v=e.shouldFocusOnHover)!==null&&v!==void 0?v:a==null?void 0:a.shouldFocusOnHover;var g;let $=(g=e.shouldUseVirtualFocus)!==null&&g!==void 0?g:a==null?void 0:a.shouldUseVirtualFocus;var x;let D=(x=e.isVirtualized)!==null&&x!==void 0?x:a==null?void 0:a.isVirtualized,k=K(),H=K(),P={role:"option","aria-disabled":c||void 0,"aria-selected":o.selectionManager.selectionMode!=="none"?b:void 0};$e()&&ge()||(P["aria-label"]=e["aria-label"],P["aria-labelledby"]=k,P["aria-describedby"]=H);let l=o.collection.getItem(r);if(D){let y=Number(l==null?void 0:l.index);P["aria-posinset"]=Number.isNaN(y)?void 0:y+1,P["aria-setsize"]=re(o.collection)}let h=a!=null&&a.onAction?()=>{var y;return a==null||(y=a.onAction)===null||y===void 0?void 0:y.call(a,r)}:void 0,{itemProps:F,isPressed:B,isFocused:w,hasAction:M,allowsSelection:U}=ve({selectionManager:o.selectionManager,key:r,ref:n,shouldSelectOnPressUp:f,allowsDifferentPressOrigin:f&&S,isVirtualized:D,shouldUseVirtualFocus:$,isDisabled:c,onAction:h||!(l==null||(t=l.props)===null||t===void 0)&&t.onAction?fe(l==null||(d=l.props)===null||d===void 0?void 0:d.onAction,h):void 0,linkBehavior:a==null?void 0:a.linkBehavior}),{hoverProps:V}=Q({isDisabled:c||!S,onHoverStart(){W()||(o.selectionManager.setFocused(!0),o.selectionManager.setFocusedKey(r))}}),C=_(l==null?void 0:l.props);delete C.id;let I=pe(l==null?void 0:l.props);return{optionProps:{...P,...E(C,F,V,I),id:Fe(o,r)},labelProps:{id:k},descriptionProps:{id:H},isFocused:w,isFocusVisible:w&&W(),isSelected:b,isDisabled:c,isPressed:B,allowsSelection:U,hasAction:M}}function Ce(e){let{heading:o,"aria-label":n}=e,t=J();return{itemProps:{role:"presentation"},headingProps:o?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":o?t:void 0}}}const X=s.createContext(null),L=s.createContext(null);function Ee(e,o){[e,o]=ee(e,o,X);let n=s.useContext(L);return n?u.createElement(Y,{state:n,props:e,listBoxRef:o}):u.createElement(ce,{content:u.createElement(ue,e)},t=>u.createElement(He,{props:e,listBoxRef:o,collection:t}))}function He({props:e,listBoxRef:o,collection:n}){e={...e,collection:n,children:null,items:null};let{layoutDelegate:t}=s.useContext(z),d=De({...e,layoutDelegate:t});return u.createElement(Y,{state:d,props:e,listBoxRef:o})}const eo=s.forwardRef(Ee);function Y({state:e,props:o,listBoxRef:n}){let{dragAndDropHooks:t,layout:d="stack",orientation:r="vertical"}=o,{collection:a,selectionManager:i}=e,c=!!(t!=null&&t.useDraggableCollectionState),p=!!(t!=null&&t.useDroppableCollectionState),{direction:b}=Pe(),{disabledBehavior:m,disabledKeys:f}=i,v=ye({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:g,dropTargetDelegate:$,CollectionRoot:x}=s.useContext(z),D=s.useMemo(()=>o.keyboardDelegate||new he({collection:a,collator:v,ref:n,disabledKeys:f,disabledBehavior:m,layout:d,orientation:r,direction:b,layoutDelegate:g}),[a,v,n,m,f,r,b,o.keyboardDelegate,d,g]),{listBoxProps:k}=Be({...o,shouldSelectOnPressUp:c||o.shouldSelectOnPressUp,keyboardDelegate:D,isVirtualized:S},e,n),H=s.useRef(c),P=s.useRef(p);s.useEffect(()=>{H.current!==c&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),P.current!==p&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[c,p]);let l,h,F,B=!1,w=null,M=s.useRef(null);if(c&&t){l=t.useDraggableCollectionState({collection:a,selectionManager:i,preview:t.renderDragPreview?M:void 0}),t.useDraggableCollection({},l,n);let O=t.DragPreview;w=t.renderDragPreview?u.createElement(O,{ref:M},t.renderDragPreview):null}if(p&&t){h=t.useDroppableCollectionState({collection:a,selectionManager:i});let O=t.dropTargetDelegate||$||new t.ListDropTargetDelegate(a,n,{orientation:r,layout:d,direction:b});F=t.useDroppableCollection({keyboardDelegate:D,dropTargetDelegate:O},h,n),B=h.isDropTarget({type:"root"})}let{focusProps:U,isFocused:V,isFocusVisible:C}=me(),I={isDropTarget:B,isEmpty:e.collection.size===0,isFocused:V,isFocusVisible:C,layout:o.layout||"stack",state:e},y=A({className:o.className,style:o.style,defaultClassName:"react-aria-ListBox",values:I}),R=null;return e.collection.size===0&&o.renderEmptyState&&(R=u.createElement("div",{role:"option",style:{display:"contents"}},o.renderEmptyState(I))),u.createElement(Se,null,u.createElement("div",{..._(o),...E(k,U,F==null?void 0:F.collectionProps),...y,ref:n,slot:o.slot||void 0,onScroll:o.onScroll,"data-drop-target":B||void 0,"data-empty":e.collection.size===0||void 0,"data-focused":V||void 0,"data-focus-visible":C||void 0,"data-layout":o.layout||"stack","data-orientation":o.orientation||"vertical"},u.createElement(q,{values:[[X,o],[L,e],[T,{dragAndDropHooks:t,dragState:l,dropState:h}],[ie,{elementType:"div"}],[te,{render:Ve}],[Z,{name:"ListBoxSection",render:Me}]]},u.createElement(x,{collection:a,scrollRef:n,persistedKeys:ae(i,t,h),renderDropIndicator:G(t,h)})),R,w))}function Me(e,o,n,t="react-aria-ListBoxSection"){let d=s.useContext(L),{dragAndDropHooks:r,dropState:a}=s.useContext(T),{CollectionBranch:i}=s.useContext(z),[c,p]=oe();var b;let{headingProps:m,groupProps:f}=Ce({heading:p,"aria-label":(b=e["aria-label"])!==null&&b!==void 0?b:void 0}),v=A({defaultClassName:t,className:e.className,style:e.style,values:{}});return u.createElement("section",{..._(e),...f,...v,ref:o},u.createElement(de.Provider,{value:{...m,ref:c}},u.createElement(i,{collection:d.collection,parent:n,renderDropIndicator:G(r,a)})))}const oo=se("item",function(o,n,t){let d=j(n),r=s.useContext(L),{dragAndDropHooks:a,dragState:i,dropState:c}=s.useContext(T),{optionProps:p,labelProps:b,descriptionProps:m,...f}=we({key:t.key,"aria-label":o==null?void 0:o["aria-label"]},r,d),{hoverProps:v,isHovered:S}=Q({isDisabled:!f.allowsSelection&&!f.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),g=null;i&&a&&(g=a.useDraggableItem({key:t.key},i));let $=null;c&&a&&($=a.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},c,d));let x=i&&i.isDragging(t.key),D=A({...o,id:void 0,children:o.children,defaultClassName:"react-aria-ListBoxItem",values:{...f,isHovered:S,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!i,isDragging:x,isDropTarget:$==null?void 0:$.isDropTarget}});s.useEffect(()=>{t.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[t.textValue]);let k=o.href?"a":"div";return u.createElement(k,{...E(p,v,g==null?void 0:g.dragProps,$==null?void 0:$.dropProps),...D,ref:d,"data-allows-dragging":!!i||void 0,"data-selected":f.isSelected||void 0,"data-disabled":f.isDisabled||void 0,"data-hovered":S||void 0,"data-focused":f.isFocused||void 0,"data-focus-visible":f.isFocusVisible||void 0,"data-pressed":f.isPressed||void 0,"data-dragging":x||void 0,"data-drop-target":($==null?void 0:$.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},u.createElement(q,{values:[[le,{slots:{label:b,description:m}}]]},D.children))});function Ve(e,o){o=j(o);let{dragAndDropHooks:n,dropState:t}=s.useContext(T),{dropIndicatorProps:d,isHidden:r,isDropTarget:a}=n.useDropIndicator(e,t,o);return r?null:u.createElement(Ae,{...e,dropIndicatorProps:d,isDropTarget:a,ref:o})}function Ie(e,o){let{dropIndicatorProps:n,isDropTarget:t,...d}=e,r=A({...d,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return u.createElement("div",{...n,...r,role:"option",ref:o,"data-drop-target":t||void 0})}const Ae=s.forwardRef(Ie);export{X as $,L as a,eo as b,oo as c};
