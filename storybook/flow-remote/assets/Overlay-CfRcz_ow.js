import{r as s,R as l}from"./index-BbMBc-iG.js";import{c as M}from"./clsx-B-dksMZM.js";import{u as T,a as S}from"./OverlayTrigger-CO8vF-4q.js";import{$ as L,c as E,h as v,i as y,a as O,g as N,b as z}from"./utils-D4Vol65q.js";import{e as I,f as B,g as _,h as q,i as b,j as W,k as A,b as F}from"./Dialog-BQ_biHhV.js";import{$ as C,a as x}from"./index-CPTjWdH1.js";import{$ as w}from"./filterDOMProps-BSfnXAP7.js";import{a as U}from"./OverlayArrow-CrZGdHWF.js";let f=typeof document<"u"&&window.visualViewport;function H(){let t=C(),[e,n]=s.useState(()=>t?{width:0,height:0}:h());return s.useEffect(()=>{let a=()=>{n(i=>{let r=h();return r.width===i.width&&r.height===i.height?i:r})};return f?f.addEventListener("resize",a):window.addEventListener("resize",a),()=>{f?f.removeEventListener("resize",a):window.removeEventListener("resize",a)}},[]),e}function h(){return{width:f&&(f==null?void 0:f.width)||window.innerWidth,height:f&&(f==null?void 0:f.height)||window.innerHeight}}function K(t,e,n){let{overlayProps:a,underlayProps:i}=I({...t,isOpen:e.isOpen,onClose:e.close},n);return B({isDisabled:!e.isOpen}),_(),s.useEffect(()=>{if(e.isOpen&&n.current)return q([n.current])},[e.isOpen,n]),{modalProps:x(a),underlayProps:i}}const V=s.createContext(null),p=s.createContext(null);function j(t,e){if(s.useContext(p))return l.createElement(g,{...t,modalRef:e},t.children);let{isDismissable:a,isKeyboardDismissDisabled:i,isOpen:r,defaultOpen:c,onOpenChange:o,children:d,isEntering:$,isExiting:m,UNSTABLE_portalContainer:u,shouldCloseOnInteractOutside:D,...P}=t;return l.createElement(R,{isDismissable:a,isKeyboardDismissDisabled:i,isOpen:r,defaultOpen:c,onOpenChange:o,isEntering:$,isExiting:m,UNSTABLE_portalContainer:u,shouldCloseOnInteractOutside:D},l.createElement(g,{...P,modalRef:e},d))}const k=s.forwardRef(j);function G(t,e){[t,e]=L(t,e,V);let n=s.useContext(b),a=U(t),i=t.isOpen!=null||t.defaultOpen!=null||!n?a:n,r=E(e),c=s.useRef(null),o=v(r,i.isOpen),d=v(c,i.isOpen),$=o||d||t.isExiting||!1,m=C();return!i.isOpen&&!$||m?null:l.createElement(J,{...t,state:i,isExiting:$,overlayRef:r,modalRef:c})}const R=s.forwardRef(G);function J({UNSTABLE_portalContainer:t,...e}){let n=e.modalRef,{state:a}=e,{modalProps:i,underlayProps:r}=K(e,a,n),c=y(e.overlayRef)||e.isEntering||!1,o=O({...e,defaultClassName:"react-aria-ModalOverlay",values:{isEntering:c,isExiting:e.isExiting,state:a}}),d=H(),$={...o.style,"--visual-viewport-height":d.height+"px"};return l.createElement(W,{isExiting:e.isExiting,portalContainer:t},l.createElement("div",{...x(w(e),r),...o,style:$,ref:e.overlayRef,"data-entering":c||void 0,"data-exiting":e.isExiting||void 0},l.createElement(N,{values:[[p,{modalProps:i,modalRef:n,isExiting:e.isExiting,isDismissable:e.isDismissable}],[b,a]]},o.children)))}function g(t){let{modalProps:e,modalRef:n,isExiting:a,isDismissable:i}=s.useContext(p),r=s.useContext(b),c=s.useMemo(()=>z(t.modalRef,n),[t.modalRef,n]),o=E(c),d=y(o),$=O({...t,defaultClassName:"react-aria-Modal",values:{isEntering:d,isExiting:a,state:r}});return l.createElement("div",{...x(w(t),e),...$,ref:o,"data-entering":d||void 0,"data-exiting":a||void 0},i&&l.createElement(A,{onDismiss:r.close}),$.children)}const Q="flow--overlay",X={overlay:Q,"overlay-fade":"flow--overlay--overlay-fade"},Y=t=>{const{controller:e,children:n,isDismissable:a=!0,className:i,overlayType:r="Modal",ref:c}=t,o=T(r,{reuseControllerFromContext:!0}),d=e??o,$=d.useIsOpen(),m=M(X.overlay,i);return l.createElement(R,{className:m,isDismissable:a,isOpen:$,onOpenChange:u=>d.setOpen(u),ref:c},l.createElement(k,null,l.createElement(F,null,l.createElement(S,{type:"Modal",controller:d},n))))};Y.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{className:{required:!1,tsType:{name:"string"},description:"The elements class name."},ref:{required:!1,tsType:{name:"Ref",elements:[{name:"HTMLDivElement"}],raw:"Ref<HTMLDivElement>"},description:""},controller:{required:!1,tsType:{name:"OverlayController"},description:"The controller to control the overlay state."},isDismissable:{required:!1,tsType:{name:"boolean"},description:"Whether the overlay can be closed by clicking outside of it."},overlayType:{required:!1,tsType:{name:"union",raw:'"Modal" | "LightBox"',elements:[{name:"literal",value:'"Modal"'},{name:"literal",value:'"LightBox"'}]},description:"Whether the overlay is a modal or a light box."}},composes:["PropsWithChildren"]};export{Y as O};
