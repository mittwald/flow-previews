import{r as k}from"./index-BMdlDBjA.js";import{r,R as u}from"./index-Cs7sjTYM.js";import{$ as S,s as w}from"./index-C8LjR2Bd.js";class m{get childNodes(){throw new Error("childNodes is not supported")}clone(){let e=new m(this.type,this.key);return e.value=this.value,e.level=this.level,e.hasChildNodes=this.hasChildNodes,e.rendered=this.rendered,e.textValue=this.textValue,e["aria-label"]=this["aria-label"],e.index=this.index,e.parentKey=this.parentKey,e.prevKey=this.prevKey,e.nextKey=this.nextKey,e.firstChildKey=this.firstChildKey,e.lastChildKey=this.lastChildKey,e.props=this.props,e}constructor(e,t){this.value=null,this.level=0,this.hasChildNodes=!1,this.rendered=null,this.textValue="",this["aria-label"]=void 0,this.index=0,this.parentKey=null,this.prevKey=null,this.nextKey=null,this.firstChildKey=null,this.lastChildKey=null,this.props={},this.type=e,this.key=t}}class C{*[Symbol.iterator](){let e=this.firstChild;for(;e;)yield e,e=e.nextSibling}get firstChild(){return this._firstChild}set firstChild(e){this._firstChild=e,this.ownerDocument.markDirty(this)}get lastChild(){return this._lastChild}set lastChild(e){this._lastChild=e,this.ownerDocument.markDirty(this)}get previousSibling(){return this._previousSibling}set previousSibling(e){this._previousSibling=e,this.ownerDocument.markDirty(this)}get nextSibling(){return this._nextSibling}set nextSibling(e){this._nextSibling=e,this.ownerDocument.markDirty(this)}get parentNode(){return this._parentNode}set parentNode(e){this._parentNode=e,this.ownerDocument.markDirty(this)}get isConnected(){var e;return((e=this.parentNode)===null||e===void 0?void 0:e.isConnected)||!1}appendChild(e){this.ownerDocument.startTransaction(),e.parentNode&&e.parentNode.removeChild(e),this.firstChild==null&&(this.firstChild=e),this.lastChild?(this.lastChild.nextSibling=e,e.index=this.lastChild.index+1,e.previousSibling=this.lastChild):(e.previousSibling=null,e.index=0),e.parentNode=this,e.nextSibling=null,this.lastChild=e,this.ownerDocument.markDirty(this),e.hasSetProps&&this.ownerDocument.addNode(e),this.ownerDocument.endTransaction(),this.ownerDocument.queueUpdate()}insertBefore(e,t){if(t==null)return this.appendChild(e);this.ownerDocument.startTransaction(),e.parentNode&&e.parentNode.removeChild(e),e.nextSibling=t,e.previousSibling=t.previousSibling,e.index=t.index,this.firstChild===t?this.firstChild=e:t.previousSibling&&(t.previousSibling.nextSibling=e),t.previousSibling=e,e.parentNode=t.parentNode;let i=t;for(;i;)i.index++,i=i.nextSibling;e.hasSetProps&&this.ownerDocument.addNode(e),this.ownerDocument.endTransaction(),this.ownerDocument.queueUpdate()}removeChild(e){if(e.parentNode!==this)return;this.ownerDocument.startTransaction();let t=e.nextSibling;for(;t;)t.index--,t=t.nextSibling;e.nextSibling&&(e.nextSibling.previousSibling=e.previousSibling),e.previousSibling&&(e.previousSibling.nextSibling=e.nextSibling),this.firstChild===e&&(this.firstChild=e.nextSibling),this.lastChild===e&&(this.lastChild=e.previousSibling),e.parentNode=null,e.nextSibling=null,e.previousSibling=null,e.index=0,this.ownerDocument.removeNode(e),this.ownerDocument.endTransaction(),this.ownerDocument.queueUpdate()}addEventListener(){}removeEventListener(){}constructor(e){this._firstChild=null,this._lastChild=null,this._previousSibling=null,this._nextSibling=null,this._parentNode=null,this.ownerDocument=e}}class y extends C{get index(){return this._index}set index(e){this._index=e,this.ownerDocument.markDirty(this)}get level(){return this.parentNode instanceof y?this.parentNode.level+(this.node.type==="item"?1:0):0}updateNode(){var e,t,i,n;let s=this.ownerDocument.getMutableNode(this);s.index=this.index,s.level=this.level,s.parentKey=this.parentNode instanceof y?this.parentNode.node.key:null;var o;s.prevKey=(o=(e=this.previousSibling)===null||e===void 0?void 0:e.node.key)!==null&&o!==void 0?o:null;var a;s.nextKey=(a=(t=this.nextSibling)===null||t===void 0?void 0:t.node.key)!==null&&a!==void 0?a:null,s.hasChildNodes=!!this.firstChild;var d;s.firstChildKey=(d=(i=this.firstChild)===null||i===void 0?void 0:i.node.key)!==null&&d!==void 0?d:null;var c;s.lastChildKey=(c=(n=this.lastChild)===null||n===void 0?void 0:n.node.key)!==null&&c!==void 0?c:null}setProps(e,t,i){let n=this.ownerDocument.getMutableNode(this),{value:s,textValue:o,id:a,...d}=e;if(d.ref=t,n.props=d,n.rendered=i,n.value=s,n.textValue=o||(typeof i=="string"?i:"")||e["aria-label"]||"",a!=null&&a!==n.key){if(this.hasSetProps)throw new Error("Cannot change the id of an item");n.key=a}this.hasSetProps||(this.ownerDocument.addNode(this),this.ownerDocument.endTransaction(),this.hasSetProps=!0),this.ownerDocument.queueUpdate()}get style(){return{}}hasAttribute(){}setAttribute(){}setAttributeNS(){}removeAttribute(){}constructor(e,t){super(t),this.nodeType=8,this._index=0,this.hasSetProps=!1,this.node=new m(e,`react-aria-${++t.nodeId}`),this.ownerDocument.startTransaction()}}class K{get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}*[Symbol.iterator](){let e=this.firstKey!=null?this.keyMap.get(this.firstKey):void 0;for(;e;)yield e,e=e.nextKey!=null?this.keyMap.get(e.nextKey):void 0}getChildren(e){let t=this.keyMap;return{*[Symbol.iterator](){let i=t.get(e),n=(i==null?void 0:i.firstChildKey)!=null?t.get(i.firstChildKey):null;for(;n;)yield n,n=n.nextKey!=null?t.get(n.nextKey):void 0}}}getKeyBefore(e){let t=this.keyMap.get(e);if(!t)return null;if(t.prevKey!=null){for(t=this.keyMap.get(t.prevKey);t&&t.type!=="item"&&t.lastChildKey!=null;)t=this.keyMap.get(t.lastChildKey);var i;return(i=t==null?void 0:t.key)!==null&&i!==void 0?i:null}return t.parentKey}getKeyAfter(e){let t=this.keyMap.get(e);if(!t)return null;if(t.type!=="item"&&t.firstChildKey!=null)return t.firstChildKey;for(;t;){if(t.nextKey!=null)return t.nextKey;if(t.parentKey!=null)t=this.keyMap.get(t.parentKey);else return null}return null}getFirstKey(){return this.firstKey}getLastKey(){let e=this.lastKey!=null?this.keyMap.get(this.lastKey):null;for(;(e==null?void 0:e.lastChildKey)!=null;)e=this.keyMap.get(e.lastChildKey);var t;return(t=e==null?void 0:e.key)!==null&&t!==void 0?t:null}getItem(e){var t;return(t=this.keyMap.get(e))!==null&&t!==void 0?t:null}at(){throw new Error("Not implemented")}clone(){let e=this.constructor,t=new e;return t.keyMap=new Map(this.keyMap),t.firstKey=this.firstKey,t.lastKey=this.lastKey,t}addNode(e){if(this.frozen)throw new Error("Cannot add a node to a frozen collection");this.keyMap.set(e.key,e)}removeNode(e){if(this.frozen)throw new Error("Cannot remove a node to a frozen collection");this.keyMap.delete(e)}commit(e,t,i=!1){if(this.frozen)throw new Error("Cannot commit a frozen collection");this.firstKey=e,this.lastKey=t,this.frozen=!i}constructor(){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.frozen=!1}}class D extends C{get isConnected(){return!0}createElement(e){return new y(e,this)}getMutableNode(e){let t=e.node;return this.mutatedNodes.has(e)||(t=e.node.clone(),this.mutatedNodes.add(e),e.node=t),this.markDirty(e),t}getMutableCollection(){return!this.isSSR&&!this.collectionMutated&&(this.collection=this.collection.clone(),this.collectionMutated=!0),this.collection}markDirty(e){this.dirtyNodes.add(e)}startTransaction(){this.transactionCount++}endTransaction(){this.transactionCount--}addNode(e){let t=this.getMutableCollection();if(!t.getItem(e.node.key)){t.addNode(e.node);for(let i of e)this.addNode(i)}this.markDirty(e)}removeNode(e){for(let i of e)this.removeNode(i);this.getMutableCollection().removeNode(e.node.key),this.markDirty(e)}getCollection(){return this.transactionCount>0?this.collection:(this.updateCollection(),this.collection)}updateCollection(){for(let s of this.dirtyNodes)s instanceof y&&s.isConnected&&s.updateNode();if(this.dirtyNodes.clear(),this.mutatedNodes.size||this.collectionMutated){var e,t;let s=this.getMutableCollection();for(let o of this.mutatedNodes)o.isConnected&&s.addNode(o.node);var i,n;s.commit((i=(e=this.firstChild)===null||e===void 0?void 0:e.node.key)!==null&&i!==void 0?i:null,(n=(t=this.lastChild)===null||t===void 0?void 0:t.node.key)!==null&&n!==void 0?n:null,this.isSSR),this.mutatedNodes.clear()}this.collectionMutated=!1}queueUpdate(){if(!(this.dirtyNodes.size===0||this.transactionCount>0))for(let e of this.subscriptions)e()}subscribe(e){return this.subscriptions.add(e),()=>this.subscriptions.delete(e)}resetAfterSSR(){this.isSSR&&(this.isSSR=!1,this.firstChild=null,this.lastChild=null,this.nodeId=0)}constructor(e){super(null),this.nodeType=11,this.ownerDocument=this,this.dirtyNodes=new Set,this.isSSR=!1,this.nodeId=0,this.nodesByProps=new WeakMap,this.mutatedNodes=new Set,this.subscriptions=new Set,this.transactionCount=0,this.collection=e,this.collectionMutated=!0}}function M(l){let{children:e,items:t,idScope:i,addIdAndValue:n,dependencies:s=[]}=l,o=r.useMemo(()=>new WeakMap,s);return r.useMemo(()=>{if(t&&typeof e=="function"){let c=[];for(let f of t){let h=o.get(f);if(!h){h=e(f);var a,d;let p=(d=(a=h.props.id)!==null&&a!==void 0?a:f.key)!==null&&d!==void 0?d:f.id;if(p==null)throw new Error("Could not determine key for item");i&&(p=i+":"+p),h=r.cloneElement(h,n?{key:p,id:p,value:f}:{key:p}),o.set(f,h)}c.push(h)}return c}else if(typeof e!="function")return e},[e,t,o,i,n])}function b(l){return M({...l,addIdAndValue:!0})}const g=r.createContext(!1);function I(l,e){let{collection:t,document:i}=R(e);return{portal:x(l,i),collection:t}}function N(l,e,t){let i=S(),n=r.useRef(i);n.current=i;let s=r.useCallback(()=>n.current?t():e(),[e,t]);return w.useSyncExternalStore(l,s)}const E=typeof u.useSyncExternalStore=="function"?u.useSyncExternalStore:N;function R(l){let e=r.useMemo(()=>new D(l||new K),[l]),t=r.useCallback(o=>e.subscribe(o),[e]),i=r.useCallback(()=>{let o=e.getCollection();return e.isSSR&&e.resetAfterSSR(),o},[e]),n=r.useCallback(()=>(e.isSSR=!0,e.getCollection()),[e]);return{collection:E(t,i,n),document:e}}const v=r.createContext(null),P=r.createContext(null);function x(l,e){let t=r.useContext(P),i=e??t,n=b(l),s=r.useMemo(()=>u.createElement(g.Provider,{value:!0},n),[n]);return S()?u.createElement(v.Provider,{value:i},s):k.createPortal(s,i)}function B(l){return u.createElement(u.Fragment,null,x(l))}function q(l,e,t){let i=r.useContext(g);var n;return i?(n=$(l,e,t,"children"in e?e.children:null))!==null&&n!==void 0?n:u.createElement(u.Fragment,null):null}function z(l,e,t){return r.useCallback(i=>{i==null||i.setProps(l,e,t)},[l,e,t])}function $(l,e,t,i,n){let s=z(e,t,i),o=r.useContext(v);if(o){let a=o.ownerDocument.nodesByProps.get(e);return a||(a=o.ownerDocument.createElement(l),a.setProps(e,t,i),o.appendChild(a),o.ownerDocument.updateCollection(),o.ownerDocument.nodesByProps.set(e,a)),n?u.createElement(v.Provider,{value:a},n):null}return u.createElement(l,{ref:s},n)}function T(l,e){let t=b(l);return $("section",l,e,null,t)}const U=r.forwardRef(T),F=r.createContext(null),L=r.createContext(null);export{q as $,U as a,I as b,$ as c,P as d,B as e,M as f,R as g,b as h,L as i,F as j,K as k,m as l};
