import{a as W,b as Z}from"./Collection-D5YsYnk7.js";import{f as j,a as A,e as q,$ as ee,c as oe}from"./utils-CgpzwoFP.js";import{$ as T,a as te,b as ae,c as G}from"./DragAndDrop-Bssnb-st.js";import{a as re}from"./Header-8TqMsGve.js";import{a as ie}from"./Separator-BGQky6UT.js";import{a as le}from"./Text-BgIWd_-0.js";import{b as de,c as ne,d as se}from"./CollectionBuilder-bH4u-dJi.js";import{a as J,b as E,e as R,f as ce}from"./index-C8LjR2Bd.js";import{$ as _}from"./filterDOMProps-CeZl_uWj.js";import{r as c,R as u}from"./index-Cs7sjTYM.js";import{b as ue}from"./usePress-C9_maMb0.js";import{$ as fe,h as pe,i as be,a as Q,j as K,b as $e}from"./useFocusable-DdFCD-YN.js";import{$ as ve,a as ge}from"./useMenuTrigger-CqhFYZZN.js";import{c as me,d as he}from"./SelectionManager-DV2VTso8.js";import{$ as xe}from"./useLabel-D8UVq-XF.js";import{$ as Pe}from"./useListState-BEdF7Q_Y.js";import{$ as De}from"./useLocalizedStringFormatter-BSNlGq_b.js";import{$ as ye}from"./useCollator-BmGy_8lF.js";import{a as Se}from"./FocusScope-jwB0dEBj.js";const L=new WeakMap;function ke(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function Fe(e,o){let r=L.get(e);if(!r)throw new Error("Unknown list");return`${r.id}-option-${ke(o)}`}function we(e,o,r){let t=_(e,{labelable:!0}),l=e.selectionBehavior||"toggle",i=e.linkBehavior||(l==="replace"?"action":"override");l==="toggle"&&i==="action"&&(i="override");let{listProps:a}=ve({...e,ref:r,selectionManager:o.selectionManager,collection:o.collection,disabledKeys:o.disabledKeys,linkBehavior:i}),{focusWithinProps:d}=fe({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),s=J(e.id);L.set(o,{id:s,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:i});let{labelProps:f,fieldProps:$}=xe({...e,id:s,labelElementType:"span"});return{labelProps:f,listBoxProps:E(t,d,o.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...E($,a)})}}function Be(e,o,r){var t,l;let{key:i}=e,a=L.get(o);var d;let s=(d=e.isDisabled)!==null&&d!==void 0?d:o.selectionManager.isDisabled(i);var f;let $=(f=e.isSelected)!==null&&f!==void 0?f:o.selectionManager.isSelected(i);var g;let p=(g=e.shouldSelectOnPressUp)!==null&&g!==void 0?g:a==null?void 0:a.shouldSelectOnPressUp;var h;let S=(h=e.shouldFocusOnHover)!==null&&h!==void 0?h:a==null?void 0:a.shouldFocusOnHover;var v;let b=(v=e.shouldUseVirtualFocus)!==null&&v!==void 0?v:a==null?void 0:a.shouldUseVirtualFocus;var x;let P=(x=e.isVirtualized)!==null&&x!==void 0?x:a==null?void 0:a.isVirtualized,k=R(),H=R(),D={role:"option","aria-disabled":s||void 0,"aria-selected":o.selectionManager.selectionMode!=="none"?$:void 0};pe()&&be()||(D["aria-label"]=e["aria-label"],D["aria-labelledby"]=k,D["aria-describedby"]=H);let n=o.collection.getItem(i);if(P){let y=Number(n==null?void 0:n.index);D["aria-posinset"]=Number.isNaN(y)?void 0:y+1,D["aria-setsize"]=ge(o.collection)}let m=a!=null&&a.onAction?()=>{var y;return a==null||(y=a.onAction)===null||y===void 0?void 0:y.call(a,i)}:void 0,{itemProps:F,isPressed:w,isFocused:B,hasAction:M,allowsSelection:O}=me({selectionManager:o.selectionManager,key:i,ref:r,shouldSelectOnPressUp:p,allowsDifferentPressOrigin:p&&S,isVirtualized:P,shouldUseVirtualFocus:b,isDisabled:s,onAction:m||!(n==null||(t=n.props)===null||t===void 0)&&t.onAction?ce(n==null||(l=n.props)===null||l===void 0?void 0:l.onAction,m):void 0,linkBehavior:a==null?void 0:a.linkBehavior}),{hoverProps:V}=Q({isDisabled:s||!S,onHoverStart(){K()||(o.selectionManager.setFocused(!0),o.selectionManager.setFocusedKey(i))}}),C=_(n==null?void 0:n.props);delete C.id;let I=ue(n==null?void 0:n.props);return{optionProps:{...D,...E(C,F,V,I),id:Fe(o,i)},labelProps:{id:k},descriptionProps:{id:H},isFocused:B,isFocusVisible:B&&K(),isSelected:$,isDisabled:s,isPressed:w,allowsSelection:O,hasAction:M}}function Ce(e){let{heading:o,"aria-label":r}=e,t=J();return{itemProps:{role:"presentation"},headingProps:o?{id:t,role:"presentation"}:{},groupProps:{role:"group","aria-label":r,"aria-labelledby":o?t:void 0}}}const X=c.createContext(null),U=c.createContext(null);function Ee(e,o){[e,o]=ee(e,o,X);let r=c.useContext(U);return r?u.createElement(Y,{state:r,props:e,listBoxRef:o}):u.createElement(ne,{content:u.createElement(se,e)},t=>u.createElement(He,{props:e,listBoxRef:o,collection:t}))}function He({props:e,listBoxRef:o,collection:r}){e={...e,collection:r,children:null,items:null};let t=Pe(e);return u.createElement(Y,{state:t,props:e,listBoxRef:o})}const oo=c.forwardRef(Ee);function Y({state:e,props:o,listBoxRef:r}){let{dragAndDropHooks:t,layout:l="stack",orientation:i="vertical"}=o,{collection:a,selectionManager:d}=e,s=!!(t!=null&&t.useDraggableCollectionState),f=!!(t!=null&&t.useDroppableCollectionState),{direction:$}=De(),{disabledBehavior:g,disabledKeys:p}=d,h=ye({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:v,dropTargetDelegate:b,CollectionRoot:x}=c.useContext(W),P=c.useMemo(()=>o.keyboardDelegate||new he({collection:a,collator:h,ref:r,disabledKeys:p,disabledBehavior:g,layout:l,orientation:i,direction:$,layoutDelegate:v}),[a,h,r,g,p,i,$,o.keyboardDelegate,l,v]),{listBoxProps:k}=we({...o,shouldSelectOnPressUp:s||o.shouldSelectOnPressUp,keyboardDelegate:P,isVirtualized:S},e,r),H=c.useRef(s),D=c.useRef(f);c.useEffect(()=>{H.current!==s&&console.warn("Drag hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior."),D.current!==f&&console.warn("Drop hooks were provided during one render, but not another. This should be avoided as it may produce unexpected behavior.")},[s,f]);let n,m,F,w=!1,B=null,M=c.useRef(null);if(s&&t){n=t.useDraggableCollectionState({collection:a,selectionManager:d,preview:t.renderDragPreview?M:void 0}),t.useDraggableCollection({},n,r);let z=t.DragPreview;B=t.renderDragPreview?u.createElement(z,{ref:M},t.renderDragPreview):null}if(f&&t){m=t.useDroppableCollectionState({collection:a,selectionManager:d});let z=t.dropTargetDelegate||b||new t.ListDropTargetDelegate(a,r,{orientation:i,layout:l,direction:$});F=t.useDroppableCollection({keyboardDelegate:P,dropTargetDelegate:z},m,r),w=m.isDropTarget({type:"root"})}let{focusProps:O,isFocused:V,isFocusVisible:C}=$e(),I={isDropTarget:w,isEmpty:e.collection.size===0,isFocused:V,isFocusVisible:C,layout:o.layout||"stack",state:e},y=A({className:o.className,style:o.style,defaultClassName:"react-aria-ListBox",values:I}),N=null;return e.collection.size===0&&o.renderEmptyState&&(N=u.createElement("div",{role:"option",style:{display:"contents"}},o.renderEmptyState(I))),u.createElement(Se,null,u.createElement("div",{..._(o),...E(k,O,F==null?void 0:F.collectionProps),...y,ref:r,slot:o.slot||void 0,onScroll:o.onScroll,"data-drop-target":w||void 0,"data-empty":e.collection.size===0||void 0,"data-focused":V||void 0,"data-focus-visible":C||void 0,"data-layout":o.layout||"stack","data-orientation":o.orientation||"vertical"},u.createElement(q,{values:[[X,o],[U,e],[T,{dragAndDropHooks:t,dragState:n,dropState:m}],[ie,{elementType:"div"}],[te,{render:Ve}],[Z,{render:Me}]]},u.createElement(x,{collection:a,scrollRef:r,persistedKeys:ae(d,t,m),renderDropIndicator:G(t,m)})),N,B))}function Me(e,o,r){let t=c.useContext(U),{dragAndDropHooks:l,dropState:i}=c.useContext(T),{CollectionBranch:a}=c.useContext(W),[d,s]=oe();var f;let{headingProps:$,groupProps:g}=Ce({heading:s,"aria-label":(f=e["aria-label"])!==null&&f!==void 0?f:void 0}),p=A({defaultClassName:"react-aria-Section",className:e.className,style:e.style,values:{}});return u.createElement("section",{..._(e),...g,...p,ref:o},u.createElement(re.Provider,{value:{...$,ref:d}},u.createElement(a,{collection:t.collection,parent:r,renderDropIndicator:G(l,i)})))}const to=de("item",function(o,r,t){let l=j(r),i=c.useContext(U),{dragAndDropHooks:a,dragState:d,dropState:s}=c.useContext(T),{optionProps:f,labelProps:$,descriptionProps:g,...p}=Be({key:t.key,"aria-label":o==null?void 0:o["aria-label"]},i,l),{hoverProps:h,isHovered:S}=Q({isDisabled:!p.allowsSelection&&!p.hasAction,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),v=null;d&&a&&(v=a.useDraggableItem({key:t.key},d));let b=null;s&&a&&(b=a.useDroppableItem({target:{type:"item",key:t.key,dropPosition:"on"}},s,l));let x=d&&d.isDragging(t.key),P=A({...o,id:void 0,children:o.children,defaultClassName:"react-aria-ListBoxItem",values:{...p,isHovered:S,selectionMode:i.selectionManager.selectionMode,selectionBehavior:i.selectionManager.selectionBehavior,allowsDragging:!!d,isDragging:x,isDropTarget:b==null?void 0:b.isDropTarget}});c.useEffect(()=>{t.textValue||console.warn("A `textValue` prop is required for <ListBoxItem> elements with non-plain text children in order to support accessibility features such as type to select.")},[t.textValue]);let k=o.href?"a":"div";return u.createElement(k,{...E(f,h,v==null?void 0:v.dragProps,b==null?void 0:b.dropProps),...P,ref:l,"data-allows-dragging":!!d||void 0,"data-selected":p.isSelected||void 0,"data-disabled":p.isDisabled||void 0,"data-hovered":S||void 0,"data-focused":p.isFocused||void 0,"data-focus-visible":p.isFocusVisible||void 0,"data-pressed":p.isPressed||void 0,"data-dragging":x||void 0,"data-drop-target":(b==null?void 0:b.isDropTarget)||void 0,"data-selection-mode":i.selectionManager.selectionMode==="none"?void 0:i.selectionManager.selectionMode},u.createElement(q,{values:[[le,{slots:{label:$,description:g}}]]},P.children))});function Ve(e,o){o=j(o);let{dragAndDropHooks:r,dropState:t}=c.useContext(T),{dropIndicatorProps:l,isHidden:i,isDropTarget:a}=r.useDropIndicator(e,t,o);return i?null:u.createElement(Ae,{...e,dropIndicatorProps:l,isDropTarget:a,ref:o})}function Ie(e,o){let{dropIndicatorProps:r,isDropTarget:t,...l}=e,i=A({...l,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:t}});return u.createElement("div",{...r,...i,role:"option",ref:o,"data-drop-target":t||void 0})}const Ae=c.forwardRef(Ie);export{X as $,U as a,oo as b,to as c};
