import{r as d,R as s}from"./index-Cs7sjTYM.js";import{s as Q}from"./ContextMenu.module-68N5lvfm.js";import{f as B}from"./flowComponent-aK1NJH1f.js";import{P as ve}from"./Popover-BHhrYwo0.js";import{C as he,P as D}from"./PropsContextProvider-CRusYdr1.js";import{h as Pe,k as O,l as Ce,m as Me,u as Ke,b as Se,O as Ee}from"./OverlayTrigger-gwEYNro4.js";import{A as ke}from"./Action-C08M7-Wx.js";import{c as Z}from"./clsx-B-dksMZM.js";import"./IconApp-Cq7w81Gv.js";import{C as Ie,D as we,E as Fe,G as Te}from"./IconWarning-CeqG-fC-.js";import{T as X}from"./Text-34Ntf1C-.js";import{d as Ne}from"./deepFindOfType-BylCc5Xi.js";import{W as _e}from"./Wrap-DQq6jo70.js";import{A as Ae}from"./Avatar-BJvRINaC.js";import{a as ee,b as De,c as Oe}from"./Collection-BdcdgcY_.js";import{g as H,$ as te,e as Re,c as Be,a as U,d as He}from"./utils-Cd8r7pc9.js";import{a as Ue}from"./Header-3zDVqz72.js";import{a as Ve}from"./Separator-ZOqStrt8.js";import{a as ze}from"./Text-Bnjm0IRl.js";import{b as We,c as Le,d as qe}from"./CollectionBuilder-B4BE-ZOx.js";import{a as V,e as A,d as je}from"./index-j_f0pOtZ.js";import{$ as k}from"./filterDOMProps-CeZl_uWj.js";import{a as Ge,d as Je}from"./OverlayArrow-BrbzJDKz.js";import{a as oe,k as Qe,f as Xe,b as Ye}from"./useFocusRing-CqFdZJbR.js";import{$ as Ze,a as et,b as tt}from"./useMenuTrigger-VDhsuUiF.js";import{b as ot,$ as nt,a as at}from"./usePress-Dcn7RY69.js";import{b as rt}from"./useFocusable-CKybZYMg.js";import{c as st,$ as lt,a as it,b as ct}from"./SelectionManager-BkcLa_O0.js";import{a as dt}from"./FocusScope-DxaEUeh1.js";import{$ as ut}from"./useControlledState-B7K2eYzO.js";const ne=new WeakMap;function ft(o,e,t){let{shouldFocusWrap:r=!0,onKeyDown:n,onKeyUp:i,...a}=o;!o["aria-label"]&&!o["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let c=k(o,{labelable:!0}),{listProps:u}=Ze({...a,ref:t,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:r,linkBehavior:"override"});return ne.set(e,{onClose:o.onClose,onAction:o.onAction}),{menuProps:V(c,{onKeyDown:n,onKeyUp:i},{role:"menu",...u,onKeyDown:l=>{l.key!=="Escape"&&u.onKeyDown(l)}})}}function pt(o,e,t){let{id:r,key:n,closeOnSelect:i,isVirtualized:a,"aria-haspopup":c,onPressStart:u,onPressUp:l,onPress:p,onPressChange:b,onPressEnd:m,onHoverStart:$,onHoverChange:x,onHoverEnd:h,onKeyDown:y,onKeyUp:K,onFocus:I,onFocusChange:le,onBlur:ie}=o,v=!!c;var w;let P=(w=o.isDisabled)!==null&&w!==void 0?w:e.selectionManager.isDisabled(n);var F;let W=(F=o.isSelected)!==null&&F!==void 0?F:e.selectionManager.isSelected(n),T=ne.get(e),g=e.collection.getItem(n),C=o.onClose||T.onClose,ce=ot(),L=f=>{var _;if(!v){if(!(g==null||(_=g.props)===null||_===void 0)&&_.onAction?g.props.onAction():o.onAction&&o.onAction(n),T.onAction){let xe=T.onAction;xe(n)}f.target instanceof HTMLAnchorElement&&ce.open(f.target,f,g.props.href,g.props.routerOptions)}},N="menuitem";v||(e.selectionManager.selectionMode==="single"?N="menuitemradio":e.selectionManager.selectionMode==="multiple"&&(N="menuitemcheckbox"));let q=A(),j=A(),G=A(),S={id:r,"aria-disabled":P||void 0,role:N,"aria-label":o["aria-label"],"aria-labelledby":q,"aria-describedby":[j,G].filter(Boolean).join(" ")||void 0,"aria-controls":o["aria-controls"],"aria-haspopup":c,"aria-expanded":o["aria-expanded"]};e.selectionManager.selectionMode!=="none"&&!v&&(S["aria-checked"]=W),a&&(S["aria-posinset"]=g==null?void 0:g.index,S["aria-setsize"]=et(e.collection));let de=f=>{f.pointerType==="keyboard"&&L(f),u==null||u(f)},ue=f=>{f.pointerType!=="keyboard"&&(L(f),!v&&C&&(i??(e.selectionManager.selectionMode!=="multiple"||e.selectionManager.isLink(n)))&&C()),l==null||l(f)},{itemProps:E,isFocused:fe}=st({selectionManager:e.selectionManager,key:n,ref:t,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none"}),{pressProps:pe,isPressed:be}=nt({onPressStart:de,onPress:p,onPressUp:ue,onPressChange:b,onPressEnd:m,isDisabled:P}),{hoverProps:me}=oe({isDisabled:P,onHoverStart(f){Qe()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(n)),$==null||$(f)},onHoverChange:x,onHoverEnd:h}),{keyboardProps:$e}=rt({onKeyDown:f=>{if(f.repeat){f.continuePropagation();return}switch(f.key){case" ":!P&&e.selectionManager.selectionMode==="none"&&!v&&i!==!1&&C&&C();break;case"Enter":!P&&i!==!1&&!v&&C&&C();break;default:v||f.continuePropagation(),y==null||y(f);break}},onKeyUp:K}),{focusProps:ye}=Xe({onBlur:ie,onFocus:I,onFocusChange:le}),J=k(g.props);delete J.id;let ge=at(g.props);return{menuItemProps:{...S,...V(J,ge,v?{onFocus:E.onFocus,"data-key":E["data-key"]}:E,pe,me,$e,ye),tabIndex:E.tabIndex!=null?-1:void 0},labelProps:{id:q},descriptionProps:{id:j},keyboardShortcutProps:{id:G},isFocused:fe,isSelected:W,isPressed:be,isDisabled:P}}function bt(o){let{heading:e,"aria-label":t}=o,r=je();return{itemProps:{role:"presentation"},headingProps:e?{id:r,role:"presentation"}:{},groupProps:{role:"group","aria-label":t,"aria-labelledby":e?r:void 0}}}function mt(o){let e=Ge(o),[t,r]=d.useState(null),[n,i]=d.useState([]),a=()=>{i([]),e.close()};return{focusStrategy:t,...e,open(l=null){r(l),e.open()},toggle(l=null){r(l),e.toggle()},close(){a()},expandedKeysStack:n,openSubmenu:(l,p)=>{i(b=>p>b.length?b:[...b.slice(0,p),l])},closeSubmenu:(l,p)=>{i(b=>b[p]===l?b.slice(0,p):b)}}}class $t{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);return t?t.prevKey:null}getKeyAfter(e){let t=this.keyMap.get(e);return t?t.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const t=[...this.getKeys()];return this.getItem(t[e])}constructor(e,{expandedKeys:t}={}){this.keyMap=new Map,this.iterable=e,t=t||new Set;let r=a=>{if(this.keyMap.set(a.key,a),a.childNodes&&(a.type==="section"||t.has(a.key)))for(let c of a.childNodes)r(c)};for(let a of e)r(a);let n,i=0;for(let[a,c]of this.keyMap)n?(n.nextKey=a,c.prevKey=n.key):(this.firstKey=a,c.prevKey=void 0),c.type==="item"&&(c.index=i++),n=c,n.nextKey=void 0;this.lastKey=n==null?void 0:n.key}}function yt(o){let{onExpandedChange:e}=o,[t,r]=ut(o.expandedKeys?new Set(o.expandedKeys):void 0,o.defaultExpandedKeys?new Set(o.defaultExpandedKeys):new Set,e),n=lt(o),i=d.useMemo(()=>o.disabledKeys?new Set(o.disabledKeys):new Set,[o.disabledKeys]),a=it(o,d.useCallback(u=>new $t(u,{expandedKeys:t}),[t]),null);return d.useEffect(()=>{n.focusedKey!=null&&!a.getItem(n.focusedKey)&&n.setFocusedKey(null)},[a,n.focusedKey]),{collection:a,expandedKeys:t,disabledKeys:i,toggleKey:u=>{r(gt(t,u))},setExpandedKeys:r,selectionManager:new ct(a,n)}}function gt(o,e){let t=new Set(o);return t.has(e)?t.delete(e):t.add(e),t}const xt=d.createContext({}),ae=d.createContext(null),z=d.createContext(null),re=d.createContext(null);function vt(o){let e=mt(o),t=d.useRef(null),{menuTriggerProps:r,menuProps:n}=tt({...o,type:"menu"},e,t),[i,a]=d.useState(null),c=d.useCallback(()=>{t.current&&a(t.current.offsetWidth+"px")},[t]);Je({ref:t,onResize:c});let u=d.useRef(null);return s.createElement(H,{values:[[ae,{...n,ref:u}],[Pe,e],[re,e],[O,{trigger:"MenuTrigger",triggerRef:t,scrollRef:u,placement:"bottom start",style:{"--trigger-width":i}}]]},s.createElement(Ce,{...r,ref:t,isPressed:e.isOpen},o.children))}const ht=d.createContext(null);function Pt(o,e){return[o,e]=te(o,e,ae),s.createElement(Le,{content:s.createElement(qe,o)},t=>t.size>0&&s.createElement(Ct,{props:o,collection:t,menuRef:e}))}function Ct({props:o,collection:e,menuRef:t}){let r=yt({...o,collection:e,children:void 0}),[n,i]=d.useState(null),{isVirtualized:a,CollectionRoot:c}=d.useContext(ee),{menuProps:u}=ft({...o,isVirtualized:a},r,t),l=d.useContext(re),p=d.useContext(O),b=(p==null?void 0:p.trigger)==="SubmenuTrigger";Me({ref:t,onInteractOutside:y=>{l&&!(n!=null&&n.contains(y.target))&&l.close()},isDisabled:b||(l==null?void 0:l.expandedKeysStack.length)===0});let m=d.useRef(null),[$,x]=d.useState({left:0});d.useEffect(()=>{if(n&&m.current!==n&&$.left===0){m.current=n;let{left:y}=n.getBoundingClientRect();x({left:-1*y})}},[$,n]);let h=U({defaultClassName:"react-aria-Menu",className:o.className,style:o.style,values:{}});return s.createElement(dt,null,s.createElement("div",{...k(o),...u,...h,ref:t,slot:o.slot||void 0,onScroll:o.onScroll},s.createElement(H,{values:[[z,r],[Ve,{elementType:"div"}],[O,{UNSTABLE_portalContainer:n||void 0}],[De,{render:Kt}],[ht,{parentMenuRef:t}],[R,null]]},s.createElement(c,{collection:e,persistedKeys:Oe(r.selectionManager.focusedKey),scrollRef:t}))),s.createElement("div",{ref:i,style:{width:"100vw",position:"absolute",top:0,...$}}))}const Mt=d.forwardRef(Pt);function Kt(o,e,t){var r,n;let i=d.useContext(z),{CollectionBranch:a}=d.useContext(ee),[c,u]=He();var l;let{headingProps:p,groupProps:b}=bt({heading:u,"aria-label":(l=t.props["aria-label"])!==null&&l!==void 0?l:void 0}),m=U({defaultClassName:"react-aria-Section",className:(r=t.props)===null||r===void 0?void 0:r.className,style:(n=t.props)===null||n===void 0?void 0:n.style,values:{}});return s.createElement("section",{...k(o),...b,...m,ref:e},s.createElement(Ue.Provider,{value:{...p,ref:c}},s.createElement(a,{collection:i.collection,parent:t})))}const R=d.createContext(null),St=We("item",function(e,t,r){var n;[e,t]=te(e,t,R);let i=(n=Re(R))===null||n===void 0?void 0:n.id,a=d.useContext(z),c=Be(t),{menuItemProps:u,labelProps:l,descriptionProps:p,keyboardShortcutProps:b,...m}=pt({...e,id:i,key:r.key},a,c),{isFocusVisible:$,focusProps:x}=Ye(),{hoverProps:h,isHovered:y}=oe({isDisabled:m.isDisabled}),K=U({...e,id:void 0,children:r.rendered,defaultClassName:"react-aria-MenuItem",values:{...m,isHovered:y,isFocusVisible:$,selectionMode:a.selectionManager.selectionMode,selectionBehavior:a.selectionManager.selectionBehavior,hasSubmenu:!!e["aria-haspopup"],isOpen:e["aria-expanded"]==="true"}}),I=e.href?"a":"div";return s.createElement(I,{...V(u,x,h),...K,ref:c,"data-disabled":m.isDisabled||void 0,"data-hovered":y||void 0,"data-focused":m.isFocused||void 0,"data-focus-visible":$||void 0,"data-pressed":m.isPressed||void 0,"data-selected":m.isSelected||void 0,"data-selection-mode":a.selectionManager.selectionMode==="none"?void 0:a.selectionManager.selectionMode,"data-has-submenu":!!e["aria-haspopup"]||void 0,"data-open":e["aria-expanded"]==="true"||void 0},s.createElement(H,{values:[[ze,{slots:{label:l,description:p}}],[xt,b]]},K.children))}),Et=B("ContextMenu",o=>{const{children:e,onAction:t,selectionMode:r,selectedKeys:n,defaultSelectedKeys:i,disabledKeys:a,onSelectionChange:c,refProp:u,controller:l,...p}=o,b=Ke("ContextMenu",{reuseControllerFromContext:!0}),m=l??b,$=r==="navigation"?"none":r,x=r==="navigation"?"navigation":"control",h={MenuItem:{selectionVariant:x},Section:{MenuItem:{selectionVariant:x},renderContextMenuSection:!0}},y=r==="single"||r==="navigation"?"ContextMenu":void 0;return s.createElement(he,null,s.createElement(ve,{...p,contentClassName:Q.popoverContent,controller:m,isDialogContent:!1},s.createElement(Se,{type:"ContextMenu",controller:m},s.createElement(Mt,{className:Q.contextMenu,onAction:t,selectionMode:$,selectedKeys:n,defaultSelectedKeys:i,disabledKeys:a,onSelectionChange:c,ref:u},s.createElement(D,{props:h},s.createElement(ke,{closeOverlay:y},e))))))});Et.__docgenInfo={description:"",methods:[],displayName:"ContextMenu"};const kt="flow--menu-item",It="flow--menu-item--icon",wt="flow--menu-item--text",Ft="flow--menu-item--control-icon",Tt="flow--menu-item--avatar",M={menuItem:kt,icon:It,text:wt,controlIcon:Ft,avatar:Tt},Y=(o,e)=>!!Ne(o,e),se=o=>{const{selectionMode:e,isSelected:t,selectionVariant:r="control",children:n}=o,i={Icon:{className:M.icon},Text:{className:M.text},Avatar:{className:M.avatar}},a={Icon:{className:Z(M.controlIcon,M.icon)}},c=e==="none"||r==="navigation"?null:e==="single"&&t?s.createElement(Ie,null):e==="single"&&!t?s.createElement(we,null):e==="multiple"&&t?s.createElement(Fe,null):s.createElement(Te,null),u=Y(n,X),l=Y(n,Ae);return s.createElement(s.Fragment,null,s.createElement(D,{props:a},c),s.createElement(D,{props:i},s.createElement(_e,{if:!u&&!l},s.createElement(X,null,n))))};se.__docgenInfo={description:"",methods:[],displayName:"MenuItemContent",props:{selectionVariant:{required:!1,tsType:{name:"union",raw:'"control" | "navigation"',elements:[{name:"literal",value:'"control"'},{name:"literal",value:'"navigation"'}]},description:""}},composes:["PropsWithChildren"]};const Nt=B("MenuItem",o=>{const{children:e,className:t,selectionVariant:r,refProp:n,...i}=o,a=Z(M.menuItem,t);return s.createElement(St,{...i,className:a,ref:n},c=>s.createElement(se,{...c,selectionVariant:r},e))});Nt.__docgenInfo={description:"",methods:[],displayName:"MenuItem"};const _t=B("ContextMenuTrigger",o=>{const{children:e,...t}=o;return s.createElement(Ee,{overlayType:"ContextMenu",...t,component:vt},e)});_t.__docgenInfo={description:"",methods:[],displayName:"ContextMenuTrigger"};export{Et as C,Nt as M,_t as a};
