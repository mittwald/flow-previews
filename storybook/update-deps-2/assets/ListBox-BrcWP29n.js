import{$ as N,a as oe}from"./Collection-DH8MVYRU.js";import{$ as ae,c as W,a as A,b as G,d as te,g as le}from"./utils-D9H5ZYVa.js";import{$ as U,a as re,b as J,c as ie}from"./DragAndDrop-D7p6EfW_.js";import{d as de,e as ne,f as se,g as ce}from"./Dialog-B0vEu32W.js";import{a as ue}from"./Separator-CJYrkcAH.js";import{a as fe}from"./Text-RYc5i20l.js";import{b as $e,c as be,a as ve}from"./CollectionBuilder-B62dxoFp.js";import{e as Q,$ as w,f as j,g as pe,d as ge}from"./mergeRefs-CQveTfyF.js";import{$ as L}from"./filterDOMProps-CeZl_uWj.js";import{r as d,R as f}from"./index-CgfFrydU.js";import{a as me,$ as xe}from"./useListState-kJuQCSos.js";import{a as he}from"./useLocalizedStringFormatter-2OBKXYKe.js";import{$ as Pe}from"./useCollator-B5zTmuon.js";import{c as De,d as ye}from"./SelectionManager-Clajy7Q-.js";import{$ as Se,a as X,b as Ce}from"./useFocusRing-VURPolDQ.js";import{$ as Ee}from"./useLabel-CVdsQLKm.js";import{a as Fe}from"./usePress--lgM-7rV.js";import{t as ke,u as Me,r as q}from"./useFocus-Dz5Sgz6F.js";import{a as we}from"./FocusScope-me2WFoLK.js";const K=new WeakMap;function Ie(a){return typeof a=="string"?a.replace(/\s*/g,""):""+a}function Ve(a,e){let t=K.get(a);if(!t)throw new Error("Unknown list");return`${t.id}-option-${Ie(e)}`}function Be(a,e,t){let l=L(a,{labelable:!0}),i=a.selectionBehavior||"toggle",r=a.linkBehavior||(i==="replace"?"action":"override");i==="toggle"&&r==="action"&&(r="override");let{listProps:o}=de({...a,ref:t,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,linkBehavior:r}),{focusWithinProps:n}=Se({onFocusWithin:a.onFocus,onBlurWithin:a.onBlur,onFocusWithinChange:a.onFocusChange}),b=Q(a.id);K.set(e,{id:b,shouldUseVirtualFocus:a.shouldUseVirtualFocus,shouldSelectOnPressUp:a.shouldSelectOnPressUp,shouldFocusOnHover:a.shouldFocusOnHover,isVirtualized:a.isVirtualized,onAction:a.onAction,linkBehavior:r});let{labelProps:$,fieldProps:s}=Ee({...a,id:b,labelElementType:"span"});return{labelProps:$,listBoxProps:w(l,n,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...w(s,o)})}}function _e(a,e,t){var l,i;let{key:r}=a,o=K.get(e);var n;let b=(n=a.isDisabled)!==null&&n!==void 0?n:e.selectionManager.isDisabled(r);var $;let s=($=a.isSelected)!==null&&$!==void 0?$:e.selectionManager.isSelected(r);var p;let c=(p=a.shouldSelectOnPressUp)!==null&&p!==void 0?p:o==null?void 0:o.shouldSelectOnPressUp;var g;let x=(g=a.shouldFocusOnHover)!==null&&g!==void 0?g:o==null?void 0:o.shouldFocusOnHover;var m;let v=(m=a.shouldUseVirtualFocus)!==null&&m!==void 0?m:o==null?void 0:o.shouldUseVirtualFocus;var h;let S=(h=a.isVirtualized)!==null&&h!==void 0?h:o==null?void 0:o.isVirtualized,C=j(),I=j(),D={role:"option","aria-disabled":b||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?s:void 0};ke()&&Me()||(D["aria-label"]=a["aria-label"],D["aria-labelledby"]=C,D["aria-describedby"]=I);let u=e.collection.getItem(r);if(S){let P=Number(u==null?void 0:u.index);D["aria-posinset"]=Number.isNaN(P)?void 0:P+1,D["aria-setsize"]=ne(e.collection)}let V=o!=null&&o.onAction?()=>{var P;return o==null||(P=o.onAction)===null||P===void 0?void 0:P.call(o,r)}:void 0,E=Ve(e,r),{itemProps:y,isPressed:F,isFocused:k,hasAction:B,allowsSelection:_}=De({selectionManager:e.selectionManager,key:r,ref:t,shouldSelectOnPressUp:c,allowsDifferentPressOrigin:c&&x,isVirtualized:S,shouldUseVirtualFocus:v,isDisabled:b,onAction:V||!(u==null||(l=u.props)===null||l===void 0)&&l.onAction?pe(u==null||(i=u.props)===null||i===void 0?void 0:i.onAction,V):void 0,linkBehavior:o==null?void 0:o.linkBehavior,id:E}),{hoverProps:T}=X({isDisabled:b||!x,onHoverStart(){q()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}}),M=L(u==null?void 0:u.props);delete M.id;let H=Fe(u==null?void 0:u.props);return{optionProps:{...D,...w(M,y,T,H),id:E},labelProps:{id:C},descriptionProps:{id:I},isFocused:k,isFocusVisible:k&&e.selectionManager.isFocused&&q(),isSelected:s,isDisabled:b,isPressed:F,allowsSelection:_,hasAction:B}}function He(a){let{heading:e,"aria-label":t}=a,l=Q();return{itemProps:{role:"presentation"},headingProps:e?{id:l,role:"presentation"}:{},groupProps:{role:"group","aria-label":t,"aria-labelledby":e?l:void 0}}}const Y=d.createContext(null),O=d.createContext(null),io=d.forwardRef(function(e,t){[e,t]=ae(e,t,Y);let l=d.useContext(O);return l?f.createElement(Z,{state:l,props:e,listBoxRef:t}):f.createElement($e,{content:f.createElement(be,e)},i=>f.createElement(Ae,{props:e,listBoxRef:t,collection:i}))});function Ae({props:a,listBoxRef:e,collection:t}){a={...a,collection:t,children:null,items:null};let{layoutDelegate:l}=d.useContext(N),i=xe({...a,layoutDelegate:l});return f.createElement(Z,{state:i,props:a,listBoxRef:e})}function Z({state:a,props:e,listBoxRef:t}){let{filter:l,collectionProps:i,collectionRef:r}=d.useContext(se)||{};e=d.useMemo(()=>i?{...e,...i}:e,[e,i]);let{dragAndDropHooks:o,layout:n="stack",orientation:b="vertical"}=e;t=W(d.useMemo(()=>ge(t,r!==void 0?r:null),[r,t]));let $=me(a,l),{collection:s,selectionManager:p}=$,c=!!(o!=null&&o.useDraggableCollectionState),g=!!(o!=null&&o.useDroppableCollectionState),{direction:x}=he(),{disabledBehavior:m,disabledKeys:v}=p,h=Pe({usage:"search",sensitivity:"base"}),{isVirtualized:S,layoutDelegate:C,dropTargetDelegate:I,CollectionRoot:D}=d.useContext(N),u=d.useMemo(()=>e.keyboardDelegate||new ye({collection:s,collator:h,ref:t,disabledKeys:v,disabledBehavior:m,layout:n,orientation:b,direction:x,layoutDelegate:C}),[s,h,t,m,v,b,x,e.keyboardDelegate,n,C]),{listBoxProps:V}=Be({...e,shouldSelectOnPressUp:c||e.shouldSelectOnPressUp,keyboardDelegate:u,isVirtualized:S},$,t);d.useRef(c),d.useRef(g),d.useEffect(()=>{},[c,g]);let E,y,F,k=!1,B=null,_=d.useRef(null);if(c&&o){E=o.useDraggableCollectionState({collection:s,selectionManager:p,preview:o.renderDragPreview?_:void 0}),o.useDraggableCollection({},E,t);let z=o.DragPreview;B=o.renderDragPreview?f.createElement(z,{ref:_},o.renderDragPreview):null}if(g&&o){y=o.useDroppableCollectionState({collection:s,selectionManager:p});let z=o.dropTargetDelegate||I||new o.ListDropTargetDelegate(s,t,{orientation:b,layout:n,direction:x});F=o.useDroppableCollection({keyboardDelegate:u,dropTargetDelegate:z},y,t),k=y.isDropTarget({type:"root"})}let{focusProps:T,isFocused:M,isFocusVisible:H}=Ce(),P={isDropTarget:k,isEmpty:$.collection.size===0,isFocused:M,isFocusVisible:H,layout:e.layout||"stack",state:$},ee=A({className:e.className,style:e.style,defaultClassName:"react-aria-ListBox",values:P}),R=null;return $.collection.size===0&&e.renderEmptyState&&(R=f.createElement("div",{role:"option",style:{display:"contents"}},e.renderEmptyState(P))),f.createElement(we,null,f.createElement("div",{...L(e),...w(V,T,F==null?void 0:F.collectionProps),...ee,ref:t,slot:e.slot||void 0,onScroll:e.onScroll,"data-drop-target":k||void 0,"data-empty":$.collection.size===0||void 0,"data-focused":M||void 0,"data-focus-visible":H||void 0,"data-layout":e.layout||"stack","data-orientation":e.orientation||"vertical"},f.createElement(G,{values:[[Y,e],[O,$],[U,{dragAndDropHooks:o,dragState:E,dropState:y}],[ue,{elementType:"div"}],[re,{render:Le}],[oe,{name:"ListBoxSection",render:Ue}]]},f.createElement(D,{collection:s,scrollRef:t,persistedKeys:ie(p,o,y),renderDropIndicator:J(o,y)})),R,B))}function Ue(a,e,t,l="react-aria-ListBoxSection"){let i=d.useContext(O),{dragAndDropHooks:r,dropState:o}=d.useContext(U),{CollectionBranch:n}=d.useContext(N),[b,$]=te();var s;let{headingProps:p,groupProps:c}=He({heading:$,"aria-label":(s=a["aria-label"])!==null&&s!==void 0?s:void 0}),g=A({defaultClassName:l,className:a.className,style:a.style,values:{}});return f.createElement("section",{...L(a),...c,...g,ref:e},f.createElement(ce.Provider,{value:{...p,ref:b}},f.createElement(n,{collection:i.collection,parent:t,renderDropIndicator:J(r,o)})))}const no=ve("item",function(e,t,l){let i=W(t),r=d.useContext(O),{dragAndDropHooks:o,dragState:n,dropState:b}=d.useContext(U),{optionProps:$,labelProps:s,descriptionProps:p,...c}=_e({key:l.key,"aria-label":e==null?void 0:e["aria-label"]},r,i),{hoverProps:g,isHovered:x}=X({isDisabled:!c.allowsSelection&&!c.hasAction,onHoverStart:l.props.onHoverStart,onHoverChange:l.props.onHoverChange,onHoverEnd:l.props.onHoverEnd}),m=null;n&&o&&(m=o.useDraggableItem({key:l.key},n));let v=null;b&&o&&(v=o.useDroppableItem({target:{type:"item",key:l.key,dropPosition:"on"}},b,i));let h=n&&n.isDragging(l.key),S=A({...e,id:void 0,children:e.children,defaultClassName:"react-aria-ListBoxItem",values:{...c,isHovered:x,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,allowsDragging:!!n,isDragging:h,isDropTarget:v==null?void 0:v.isDropTarget}});d.useEffect(()=>{l.textValue},[l.textValue]);let C=e.href?"a":"div";return f.createElement(C,{...w($,g,m==null?void 0:m.dragProps,v==null?void 0:v.dropProps),...S,ref:i,"data-allows-dragging":!!n||void 0,"data-selected":c.isSelected||void 0,"data-disabled":c.isDisabled||void 0,"data-hovered":x||void 0,"data-focused":c.isFocused||void 0,"data-focus-visible":c.isFocusVisible||void 0,"data-pressed":c.isPressed||void 0,"data-dragging":h||void 0,"data-drop-target":(v==null?void 0:v.isDropTarget)||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode},f.createElement(G,{values:[[fe,{slots:{[le]:s,label:s,description:p}}]]},S.children))});function Le(a,e){e=W(e);let{dragAndDropHooks:t,dropState:l}=d.useContext(U),{dropIndicatorProps:i,isHidden:r,isDropTarget:o}=t.useDropIndicator(a,l,e);return r?null:f.createElement(Te,{...a,dropIndicatorProps:i,isDropTarget:o,ref:e})}function Oe(a,e){let{dropIndicatorProps:t,isDropTarget:l,...i}=a,r=A({...i,defaultClassName:"react-aria-DropIndicator",values:{isDropTarget:l}});return f.createElement("div",{...t,...r,role:"option",ref:e,"data-drop-target":l||void 0})}const Te=d.forwardRef(Oe);export{io as $,no as a,Y as b,O as c,K as d,Ve as e};
