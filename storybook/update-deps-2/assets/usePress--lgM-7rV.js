import{w as fe,u as ce,t as z,x as de,v as Z,y as ee,h as O,z as ue,p as pe,q as ve,f as y,i as b,A as be,B as $e,$ as R,d as ye,C as ge}from"./useFocus-Dz5Sgz6F.js";import{r as m,R as he}from"./index-CgfFrydU.js";import{a as x,$ as te,g as Pe}from"./mergeRefs-CQveTfyF.js";import{c as Te}from"./useFocusRing-VURPolDQ.js";import"./index-Brqd7pHr.js";const me=m.createContext({isNative:!0,open:xe,useHref:e=>e});function re(){return m.useContext(me)}function Re(e,r){let a=e.getAttribute("target");return(!a||a==="_self")&&e.origin===location.origin&&!e.hasAttribute("download")&&!r.metaKey&&!r.ctrlKey&&!r.altKey&&!r.shiftKey}function _(e,r,a=!0){var o,f;let{metaKey:p,ctrlKey:v,altKey:u,shiftKey:P}=r;fe()&&(!((f=window.event)===null||f===void 0||(o=f.type)===null||o===void 0)&&o.startsWith("key"))&&e.target==="_blank"&&(z()?p=!0:v=!0);let T=ce()&&z()&&!de()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:p,ctrlKey:v,altKey:u,shiftKey:P}):new MouseEvent("click",{metaKey:p,ctrlKey:v,altKey:u,shiftKey:P,bubbles:!0,cancelable:!0});_.isOpening=a,Z(e),e.dispatchEvent(T),_.isOpening=!1}_.isOpening=!1;function Ee(e,r){if(e instanceof HTMLAnchorElement)r(e);else if(e.hasAttribute("data-href")){let a=document.createElement("a");a.href=e.getAttribute("data-href"),e.hasAttribute("data-target")&&(a.target=e.getAttribute("data-target")),e.hasAttribute("data-rel")&&(a.rel=e.getAttribute("data-rel")),e.hasAttribute("data-download")&&(a.download=e.getAttribute("data-download")),e.hasAttribute("data-ping")&&(a.ping=e.getAttribute("data-ping")),e.hasAttribute("data-referrer-policy")&&(a.referrerPolicy=e.getAttribute("data-referrer-policy")),e.appendChild(a),r(a),e.removeChild(a)}}function xe(e,r){Ee(e,a=>_(a,r))}function Fe(e){let r=re();var a;const o=r.useHref((a=e.href)!==null&&a!==void 0?a:"");return{"data-href":e.href?o:void 0,"data-target":e.target,"data-rel":e.rel,"data-download":e.download,"data-ping":e.ping,"data-referrer-policy":e.referrerPolicy}}function Xe(e){let r=re();var a;const o=r.useHref((a=e==null?void 0:e.href)!==null&&a!==void 0?a:"");return{href:e!=null&&e.href?o:void 0,target:e==null?void 0:e.target,rel:e==null?void 0:e.rel,download:e==null?void 0:e.download,ping:e==null?void 0:e.ping,referrerPolicy:e==null?void 0:e.referrerPolicy}}let K="default",G="",D=new WeakMap;function we(e){if(ee()){if(K==="default"){const r=O(e);G=r.documentElement.style.webkitUserSelect,r.documentElement.style.webkitUserSelect="none"}K="disabled"}else if(e instanceof HTMLElement||e instanceof SVGElement){let r="userSelect"in e.style?"userSelect":"webkitUserSelect";D.set(e,e.style[r]),e.style[r]="none"}}function j(e){if(ee()){if(K!=="disabled")return;K="restoring",setTimeout(()=>{ue(()=>{if(K==="restoring"){const r=O(e);r.documentElement.style.webkitUserSelect==="none"&&(r.documentElement.style.webkitUserSelect=G||""),G="",K="default"}})},300)}else if((e instanceof HTMLElement||e instanceof SVGElement)&&e&&D.has(e)){let r=D.get(e),a="userSelect"in e.style?"userSelect":"webkitUserSelect";e.style[a]==="none"&&(e.style[a]=r),e.getAttribute("style")===""&&e.removeAttribute("style"),D.delete(e)}}const ne=he.createContext({register:()=>{}});ne.displayName="PressResponderContext";function Se(e,r){return r.get?r.get.call(e):r.value}function ie(e,r,a){if(!r.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return r.get(e)}function ke(e,r){var a=ie(e,r,"get");return Se(e,a)}function Ke(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _e(e,r,a){Ke(e,r),r.set(e,a)}function Ae(e,r,a){if(r.set)r.set.call(e,a);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=a}}function q(e,r,a){var o=ie(e,r,"set");return Ae(e,o,a),a}function Ce(e){let r=m.useContext(ne);if(r){let{register:a,...o}=r;e=te(o,e),a()}return ye(r,e.ref),e}var U=new WeakMap;class H{continuePropagation(){q(this,U,!1)}get shouldStopPropagation(){return ke(this,U)}constructor(r,a,o,f){_e(this,U,{writable:!0,value:void 0}),q(this,U,!0);var p;let v=(p=f==null?void 0:f.target)!==null&&p!==void 0?p:o.currentTarget;const u=v==null?void 0:v.getBoundingClientRect();let P,T=0,A,g=null;o.clientX!=null&&o.clientY!=null&&(A=o.clientX,g=o.clientY),u&&(A!=null&&g!=null?(P=A-u.left,T=g-u.top):(P=u.width/2,T=u.height/2)),this.type=r,this.pointerType=a,this.target=o.currentTarget,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.x=P,this.y=T}}const J=Symbol("linkClicked");function Ye(e){let{onPress:r,onPressChange:a,onPressStart:o,onPressEnd:f,onPressUp:p,onClick:v,isDisabled:u,isPressed:P,preventFocusOnPress:T,shouldCancelOnPointerExit:A,allowTextSelectionOnPress:g,ref:I,...se}=Ce(e),[oe,V]=m.useState(!1),w=m.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,didFirePressStart:!1,isTriggeringEvent:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null,disposables:[]}),{addGlobalListener:C,removeAllGlobalListeners:F}=Te(),M=x((t,s)=>{let c=w.current;if(u||c.didFirePressStart)return!1;let n=!0;if(c.isTriggeringEvent=!0,o){let l=new H("pressstart",s,t);o(l),n=l.shouldStopPropagation}return a&&a(!0),c.isTriggeringEvent=!1,c.didFirePressStart=!0,V(!0),n}),S=x((t,s,c=!0)=>{let n=w.current;if(!n.didFirePressStart)return!1;n.didFirePressStart=!1,n.isTriggeringEvent=!0;let l=!0;if(f){let i=new H("pressend",s,t);f(i),l=i.shouldStopPropagation}if(a&&a(!1),V(!1),r&&c&&!u){let i=new H("press",s,t);r(i),l&&(l=i.shouldStopPropagation)}return n.isTriggeringEvent=!1,l}),L=x((t,s)=>{let c=w.current;if(u)return!1;if(p){c.isTriggeringEvent=!0;let n=new H("pressup",s,t);return p(n),c.isTriggeringEvent=!1,n.shouldStopPropagation}return!0}),E=x(t=>{let s=w.current;if(s.isPressed&&s.target){s.didFirePressStart&&s.pointerType!=null&&S(k(s.target,t),s.pointerType,!1),s.isPressed=!1,s.isOverTarget=!1,s.activePointerId=null,s.pointerType=null,F(),g||j(s.target);for(let c of s.disposables)c();s.disposables=[]}}),B=x(t=>{A&&E(t)}),X=x(t=>{v==null||v(t)}),W=x((t,s)=>{if(v){let c=new MouseEvent("click",t);pe(c,s),v(ve(c))}}),le=m.useMemo(()=>{let t=w.current,s={onKeyDown(n){if(Y(n.nativeEvent,n.currentTarget)&&y(n.currentTarget,b(n.nativeEvent))){var l;Q(b(n.nativeEvent),n.key)&&n.preventDefault();let i=!0;if(!t.isPressed&&!n.repeat){t.target=n.currentTarget,t.isPressed=!0,t.pointerType="keyboard",i=M(n,"keyboard");let d=n.currentTarget,$=h=>{Y(h,d)&&!h.repeat&&y(d,b(h))&&t.target&&L(k(t.target,h),"keyboard")};C(O(n.currentTarget),"keyup",Pe($,c),!0)}i&&n.stopPropagation(),n.metaKey&&z()&&((l=t.metaKeyEvents)===null||l===void 0||l.set(n.key,n.nativeEvent))}else n.key==="Meta"&&(t.metaKeyEvents=new Map)},onClick(n){if(!(n&&!y(n.currentTarget,b(n.nativeEvent)))&&n&&n.button===0&&!t.isTriggeringEvent&&!_.isOpening){let l=!0;if(u&&n.preventDefault(),!t.ignoreEmulatedMouseEvents&&!t.isPressed&&(t.pointerType==="virtual"||ge(n.nativeEvent))){let i=M(n,"virtual"),d=L(n,"virtual"),$=S(n,"virtual");X(n),l=i&&d&&$}else if(t.isPressed&&t.pointerType!=="keyboard"){let i=t.pointerType||n.nativeEvent.pointerType||"virtual";l=S(k(n.currentTarget,n),i,!0),t.isOverTarget=!1,X(n),E(n)}t.ignoreEmulatedMouseEvents=!1,l&&n.stopPropagation()}}},c=n=>{var l;if(t.isPressed&&t.target&&Y(n,t.target)){var i;Q(b(n),n.key)&&n.preventDefault();let $=b(n),h=y(t.target,b(n));S(k(t.target,n),"keyboard",h),h&&W(n,t.target),F(),n.key!=="Enter"&&N(t.target)&&y(t.target,$)&&!n[J]&&(n[J]=!0,_(t.target,n,!1)),t.isPressed=!1,(i=t.metaKeyEvents)===null||i===void 0||i.delete(n.key)}else if(n.key==="Meta"&&(!((l=t.metaKeyEvents)===null||l===void 0)&&l.size)){var d;let $=t.metaKeyEvents;t.metaKeyEvents=void 0;for(let h of $.values())(d=t.target)===null||d===void 0||d.dispatchEvent(new KeyboardEvent("keyup",h))}};if(typeof PointerEvent<"u"){s.onPointerDown=i=>{if(i.button!==0||!y(i.currentTarget,b(i.nativeEvent)))return;if(be(i.nativeEvent)){t.pointerType="virtual";return}t.pointerType=i.pointerType;let d=!0;if(!t.isPressed){t.isPressed=!0,t.isOverTarget=!0,t.activePointerId=i.pointerId,t.target=i.currentTarget,g||we(t.target),d=M(i,t.pointerType);let $=b(i.nativeEvent);"releasePointerCapture"in $&&$.releasePointerCapture(i.pointerId),C(O(i.currentTarget),"pointerup",n,!1),C(O(i.currentTarget),"pointercancel",l,!1)}d&&i.stopPropagation()},s.onMouseDown=i=>{if(y(i.currentTarget,b(i.nativeEvent))&&i.button===0){if(T){let d=$e(i.target);d&&t.disposables.push(d)}i.stopPropagation()}},s.onPointerUp=i=>{!y(i.currentTarget,b(i.nativeEvent))||t.pointerType==="virtual"||i.button===0&&L(i,t.pointerType||i.pointerType)},s.onPointerEnter=i=>{i.pointerId===t.activePointerId&&t.target&&!t.isOverTarget&&t.pointerType!=null&&(t.isOverTarget=!0,M(k(t.target,i),t.pointerType))},s.onPointerLeave=i=>{i.pointerId===t.activePointerId&&t.target&&t.isOverTarget&&t.pointerType!=null&&(t.isOverTarget=!1,S(k(t.target,i),t.pointerType,!1),B(i))};let n=i=>{if(i.pointerId===t.activePointerId&&t.isPressed&&i.button===0&&t.target){if(y(t.target,b(i))&&t.pointerType!=null){let d=!1,$=setTimeout(()=>{t.isPressed&&t.target instanceof HTMLElement&&(d?E(i):(Z(t.target),t.target.click()))},80);C(i.currentTarget,"click",()=>d=!0,!0),t.disposables.push(()=>clearTimeout($))}else E(i);t.isOverTarget=!1}},l=i=>{E(i)};s.onDragStart=i=>{y(i.currentTarget,b(i.nativeEvent))&&E(i)}}return s},[C,u,T,F,g,E,B,S,M,L,X,W]);return m.useEffect(()=>{let t=I==null?void 0:I.current;t&&t instanceof R(t).Element&&R(t).getComputedStyle(t).touchAction==="auto"&&(t.style.touchAction="pan-x pan-y pinch-zoom")},[I]),m.useEffect(()=>{let t=w.current;return()=>{var s;g||j((s=t.target)!==null&&s!==void 0?s:void 0);for(let c of t.disposables)c();t.disposables=[]}},[g]),{isPressed:P||oe,pressProps:te(se,le)}}function N(e){return e.tagName==="A"&&e.hasAttribute("href")}function Y(e,r){const{key:a,code:o}=e,f=r,p=f.getAttribute("role");return(a==="Enter"||a===" "||a==="Spacebar"||o==="Space")&&!(f instanceof R(f).HTMLInputElement&&!ae(f,a)||f instanceof R(f).HTMLTextAreaElement||f.isContentEditable)&&!((p==="link"||!p&&N(f))&&a!=="Enter")}function k(e,r){let a=r.clientX,o=r.clientY;return{currentTarget:e,shiftKey:r.shiftKey,ctrlKey:r.ctrlKey,metaKey:r.metaKey,altKey:r.altKey,clientX:a,clientY:o}}function Me(e){return e instanceof HTMLInputElement?!1:e instanceof HTMLButtonElement?e.type!=="submit"&&e.type!=="reset":!N(e)}function Q(e,r){return e instanceof HTMLInputElement?!ae(e,r):Me(e)}const Oe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function ae(e,r){return e.type==="checkbox"||e.type==="radio"?r===" ":Oe.has(e.type)}export{Ye as $,_e as _,Xe as a,re as b,Re as c,j as d,we as e,_ as f,ne as g,Fe as h};
