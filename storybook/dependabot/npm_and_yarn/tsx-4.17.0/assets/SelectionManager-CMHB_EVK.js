import{$ as ae}from"./useLocalizedStringFormatter-J1nK3MOF.js";import{r as p,R as Q}from"./index-Cs7sjTYM.js";import{r as he}from"./index-BU4L-DQy.js";import{$ as ye}from"./FocusScope-BciiliGi.js";import{w as pe,h as ge,f as G,k as N,m as _}from"./useFocusable-BkYgQ3nW.js";import{d as be,b as Z}from"./index-C8LjR2Bd.js";import{d as Ke,$ as ue,a as fe,g as ve}from"./usePress-e9a-mRh7.js";import{$ as ee}from"./useEvent-Be9f7BQw.js";import{$ as X}from"./getScrollParent-CcmJp979.js";import{$ as me}from"./useControlledState-B7K2eYzO.js";function $e(i,e){const t=[];for(;i&&i!==document.documentElement;)X(i,e)&&t.push(i),i=i.parentElement;return t}let Se=0;const H=new Map;function we(i){let[e,t]=p.useState();return be(()=>{if(!i)return;let l=H.get(i);if(l)t(l.element.id);else{let s=`react-aria-description-${Se++}`;t(s);let r=document.createElement("div");r.id=s,r.style.display="none",r.textContent=i,document.body.appendChild(r),l={refCount:0,element:r},H.set(i,l)}return l.refCount++,()=>{l&&--l.refCount===0&&(l.element.remove(),H.delete(i))}},[i]),{"aria-describedby":i?e:void 0}}function de(i,e){let t=te(i,e,"left"),l=te(i,e,"top"),s=e.offsetWidth,r=e.offsetHeight,c=i.scrollLeft,f=i.scrollTop,{borderTopWidth:a,borderLeftWidth:y}=getComputedStyle(i),g=i.scrollLeft+parseInt(y,10),K=i.scrollTop+parseInt(a,10),d=g+i.clientWidth,h=K+i.clientHeight;t<=c?c=t-parseInt(y,10):t+s>d&&(c+=t+s-d),l<=K?f=l-parseInt(a,10):l+r>h&&(f+=l+r-h),i.scrollLeft=c,i.scrollTop=f}function te(i,e,t){const l=t==="left"?"offsetLeft":"offsetTop";let s=0;for(;e.offsetParent&&(s+=e[l],e.offsetParent!==i);){if(e.offsetParent.contains(i)){s-=i[l];break}e=e.offsetParent}return s}function le(i,e){if(document.contains(i)){let c=document.scrollingElement||document.documentElement;if(window.getComputedStyle(c).overflow==="hidden"){let a=$e(i);for(let y of a)de(y,i)}else{var t;let{left:a,top:y}=i.getBoundingClientRect();i==null||(t=i.scrollIntoView)===null||t===void 0||t.call(i,{block:"nearest"});let{left:g,top:K}=i.getBoundingClientRect();if(Math.abs(a-g)>1||Math.abs(y-K)>1){var l,s,r;e==null||(s=e.containingElement)===null||s===void 0||(l=s.scrollIntoView)===null||l===void 0||l.call(s,{block:"center",inline:"center"}),(r=i.scrollIntoView)===null||r===void 0||r.call(i,{block:"nearest"})}}}}const xe=500;function Pe(i){let{isDisabled:e,onLongPressStart:t,onLongPressEnd:l,onLongPress:s,threshold:r=xe,accessibilityDescription:c}=i;const f=p.useRef(void 0);let{addGlobalListener:a,removeGlobalListener:y}=Ke(),{pressProps:g}=ue({isDisabled:e,onPressStart(d){if(d.continuePropagation(),(d.pointerType==="mouse"||d.pointerType==="touch")&&(t&&t({...d,type:"longpressstart"}),f.current=setTimeout(()=>{d.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),s&&s({...d,type:"longpress"}),f.current=void 0},r),d.pointerType==="touch")){let h=D=>{D.preventDefault()};a(d.target,"contextmenu",h,{once:!0}),a(window,"pointerup",()=>{setTimeout(()=>{y(d.target,"contextmenu",h)},30)},{once:!0})}},onPressEnd(d){f.current&&clearTimeout(f.current),l&&(d.pointerType==="mouse"||d.pointerType==="touch")&&l({...d,type:"longpressend"})}}),K=we(s&&!e?c:void 0);return{longPressProps:Z(g,K)}}let j=new Map;function Ye(i){let{locale:e}=ae(),t=e+(i?Object.entries(i).sort((s,r)=>s[0]<r[0]?-1:1).join():"");if(j.has(t))return j.get(t);let l=new Intl.Collator(e,i);return j.set(t,l),l}function V(i){return pe()?i.altKey:i.ctrlKey}function z(i){return ge()?i.metaKey:i.ctrlKey}const De=1e3;function Fe(i){let{keyboardDelegate:e,selectionManager:t,onTypeSelect:l}=i,s=p.useRef({search:"",timeout:null}).current,r=c=>{let f=Ie(c.key);if(!f||c.ctrlKey||c.metaKey||!c.currentTarget.contains(c.target))return;f===" "&&s.search.trim().length>0&&(c.preventDefault(),"continuePropagation"in c||c.stopPropagation()),s.search+=f;let a=e.getKeyForSearch(s.search,t.focusedKey);a==null&&(a=e.getKeyForSearch(s.search)),a!=null&&(t.setFocusedKey(a),l&&l(a)),clearTimeout(s.timeout),s.timeout=setTimeout(()=>{s.search=""},De)};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?r:null}}}function Ie(i){return i.length===1||!/^[A-Z]/i.test(i)?i:""}function Ge(i){let{selectionManager:e,keyboardDelegate:t,ref:l,autoFocus:s=!1,shouldFocusWrap:r=!1,disallowEmptySelection:c=!1,disallowSelectAll:f=!1,selectOnFocus:a=e.selectionBehavior==="replace",disallowTypeAhead:y=!1,shouldUseVirtualFocus:g,allowsTabNavigation:K=!1,isVirtualized:d,scrollRef:h=l,linkBehavior:D="action"}=i,{direction:w}=ae(),b=fe(),F=o=>{if(o.altKey&&o.key==="Tab"&&o.preventDefault(),!l.current.contains(o.target))return;const v=(u,E)=>{if(u!=null){if(e.isLink(u)&&D==="selection"&&a&&!V(o)){he.flushSync(()=>{e.setFocusedKey(u,E)});let O=h.current.querySelector(`[data-key="${CSS.escape(u.toString())}"]`),J=e.getItemProps(u);b.open(O,o,J.href,J.routerOptions);return}if(e.setFocusedKey(u,E),e.isLink(u)&&D==="override")return;o.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(u):a&&!V(o)&&e.replaceSelection(u)}};switch(o.key){case"ArrowDown":if(t.getKeyBelow){var x,S;o.preventDefault();let u=e.focusedKey!=null?t.getKeyBelow(e.focusedKey):(x=t.getFirstKey)===null||x===void 0?void 0:x.call(t);u==null&&r&&(u=(S=t.getFirstKey)===null||S===void 0?void 0:S.call(t,e.focusedKey)),v(u)}break;case"ArrowUp":if(t.getKeyAbove){var C,A;o.preventDefault();let u=e.focusedKey!=null?t.getKeyAbove(e.focusedKey):(C=t.getLastKey)===null||C===void 0?void 0:C.call(t);u==null&&r&&(u=(A=t.getLastKey)===null||A===void 0?void 0:A.call(t,e.focusedKey)),v(u)}break;case"ArrowLeft":if(t.getKeyLeftOf){var U,n;o.preventDefault();let u=t.getKeyLeftOf(e.focusedKey);u==null&&r&&(u=w==="rtl"?(U=t.getFirstKey)===null||U===void 0?void 0:U.call(t,e.focusedKey):(n=t.getLastKey)===null||n===void 0?void 0:n.call(t,e.focusedKey)),v(u,w==="rtl"?"first":"last")}break;case"ArrowRight":if(t.getKeyRightOf){var R,k;o.preventDefault();let u=t.getKeyRightOf(e.focusedKey);u==null&&r&&(u=w==="rtl"?(R=t.getLastKey)===null||R===void 0?void 0:R.call(t,e.focusedKey):(k=t.getFirstKey)===null||k===void 0?void 0:k.call(t,e.focusedKey)),v(u,w==="rtl"?"last":"first")}break;case"Home":if(t.getFirstKey){o.preventDefault();let u=t.getFirstKey(e.focusedKey,z(o));e.setFocusedKey(u),z(o)&&o.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(u):a&&e.replaceSelection(u)}break;case"End":if(t.getLastKey){o.preventDefault();let u=t.getLastKey(e.focusedKey,z(o));e.setFocusedKey(u),z(o)&&o.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(u):a&&e.replaceSelection(u)}break;case"PageDown":if(t.getKeyPageBelow){o.preventDefault();let u=t.getKeyPageBelow(e.focusedKey);v(u)}break;case"PageUp":if(t.getKeyPageAbove){o.preventDefault();let u=t.getKeyPageAbove(e.focusedKey);v(u)}break;case"a":z(o)&&e.selectionMode==="multiple"&&f!==!0&&(o.preventDefault(),e.selectAll());break;case"Escape":!c&&e.selectedKeys.size!==0&&(o.stopPropagation(),o.preventDefault(),e.clearSelection());break;case"Tab":if(!K){if(o.shiftKey)l.current.focus();else{let u=ye(l.current,{tabbable:!0}),E,O;do O=u.lastChild(),O&&(E=O);while(O);E&&!E.contains(document.activeElement)&&_(E)}break}}},m=p.useRef({top:0,left:0});ee(h,"scroll",d?null:()=>{m.current={top:h.current.scrollTop,left:h.current.scrollLeft}});let $=o=>{if(e.isFocused){o.currentTarget.contains(o.target)||e.setFocused(!1);return}if(o.currentTarget.contains(o.target)){if(e.setFocused(!0),e.focusedKey==null){let S=A=>{A!=null&&(e.setFocusedKey(A),a&&e.replaceSelection(A))},C=o.relatedTarget;var v,x;C&&o.currentTarget.compareDocumentPosition(C)&Node.DOCUMENT_POSITION_FOLLOWING?S((v=e.lastSelectedKey)!==null&&v!==void 0?v:t.getLastKey()):S((x=e.firstSelectedKey)!==null&&x!==void 0?x:t.getFirstKey())}else d||(h.current.scrollTop=m.current.top,h.current.scrollLeft=m.current.left);if(e.focusedKey!=null){let S=h.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);S&&(S.contains(document.activeElement)||_(S),N()==="keyboard"&&le(S,{containingElement:l.current}))}}},I=o=>{o.currentTarget.contains(o.relatedTarget)||e.setFocused(!1)};const T=p.useRef(s);p.useEffect(()=>{if(T.current){let o=null;s==="first"&&(o=t.getFirstKey()),s==="last"&&(o=t.getLastKey());let v=e.selectedKeys;if(v.size){for(let x of v)if(e.canSelectItem(x)){o=x;break}}e.setFocused(!0),e.setFocusedKey(o),o==null&&!g&&G(l.current)}},[]);let B=p.useRef(e.focusedKey);p.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==B.current||T.current)&&(h!=null&&h.current)){let o=N(),v=l.current.querySelector(`[data-key="${CSS.escape(e.focusedKey.toString())}"]`);if(!v)return;(o==="keyboard"||T.current)&&(de(h.current,v),o!=="virtual"&&le(v,{containingElement:l.current}))}e.isFocused&&e.focusedKey==null&&B.current!=null&&G(l.current),B.current=e.focusedKey,T.current=!1}),ee(l,"react-aria-focus-scope-restore",o=>{o.preventDefault(),e.setFocused(!0)});let M={onKeyDown:F,onFocus:$,onBlur:I,onMouseDown(o){h.current===o.target&&o.preventDefault()}},{typeSelectProps:W}=Fe({keyboardDelegate:t,selectionManager:e});y||(M=Z(W,M));let L;return g||(L=e.focusedKey==null?0:-1),{collectionProps:{...M,tabIndex:L}}}function Xe(i){let{selectionManager:e,key:t,ref:l,shouldSelectOnPressUp:s,shouldUseVirtualFocus:r,focus:c,isDisabled:f,onAction:a,allowsDifferentPressOrigin:y,linkBehavior:g="action"}=i,K=fe(),d=n=>{if(n.pointerType==="keyboard"&&V(n))e.toggleSelection(t);else{if(e.selectionMode==="none")return;if(e.isLink(t)){if(g==="selection"){let R=e.getItemProps(t);K.open(l.current,n,R.href,R.routerOptions),e.setSelectedKeys(e.selectedKeys);return}else if(g==="override"||g==="none")return}e.selectionMode==="single"?e.isSelected(t)&&!e.disallowEmptySelection?e.toggleSelection(t):e.replaceSelection(t):n&&n.shiftKey?e.extendSelection(t):e.selectionBehavior==="toggle"||n&&(z(n)||n.pointerType==="touch"||n.pointerType==="virtual")?e.toggleSelection(t):e.replaceSelection(t)}};p.useEffect(()=>{t===e.focusedKey&&e.isFocused&&!r&&(c?c():document.activeElement!==l.current&&G(l.current))},[l,t,e.focusedKey,e.childFocusStrategy,e.isFocused,r]),f=f||e.isDisabled(t);let h={};!r&&!f?h={tabIndex:t===e.focusedKey?0:-1,onFocus(n){n.target===l.current&&e.setFocusedKey(t)}}:f&&(h.onMouseDown=n=>{n.preventDefault()});let D=e.isLink(t)&&g==="override",w=e.isLink(t)&&g!=="selection"&&g!=="none",b=!f&&e.canSelectItem(t)&&!D,F=(a||w)&&!f,m=F&&(e.selectionBehavior==="replace"?!b:!b||e.isEmpty),$=F&&b&&e.selectionBehavior==="replace",I=m||$,T=p.useRef(null),B=I&&b,M=p.useRef(!1),W=p.useRef(!1),L=n=>{if(a&&a(),w){let R=e.getItemProps(t);K.open(l.current,n,R.href,R.routerOptions)}},o={};s?(o.onPressStart=n=>{T.current=n.pointerType,M.current=B,n.pointerType==="keyboard"&&(!I||se())&&d(n)},y?(o.onPressUp=m?null:n=>{n.pointerType!=="keyboard"&&b&&d(n)},o.onPress=m?L:null):o.onPress=n=>{if(m||$&&n.pointerType!=="mouse"){if(n.pointerType==="keyboard"&&!ie())return;L(n)}else n.pointerType!=="keyboard"&&b&&d(n)}):(o.onPressStart=n=>{T.current=n.pointerType,M.current=B,W.current=m,b&&(n.pointerType==="mouse"&&!m||n.pointerType==="keyboard"&&(!F||se()))&&d(n)},o.onPress=n=>{(n.pointerType==="touch"||n.pointerType==="pen"||n.pointerType==="virtual"||n.pointerType==="keyboard"&&I&&ie()||n.pointerType==="mouse"&&W.current)&&(I?L(n):b&&d(n))}),h["data-key"]=t,o.preventFocusOnPress=r;let{pressProps:v,isPressed:x}=ue(o),S=$?n=>{T.current==="mouse"&&(n.stopPropagation(),n.preventDefault(),L(n))}:void 0,{longPressProps:C}=Pe({isDisabled:!B,onLongPress(n){n.pointerType==="touch"&&(d(n),e.setSelectionBehavior("toggle"))}}),A=n=>{T.current==="touch"&&M.current&&n.preventDefault()},U=e.isLink(t)?n=>{ve.isOpening||n.preventDefault()}:void 0;return{itemProps:Z(h,b||m?v:{},B?C:{},{onDoubleClick:S,onDragStartCapture:A,onClick:U}),isPressed:x,isSelected:e.isSelected(t),isFocused:e.isFocused&&e.focusedKey===t,isDisabled:f,allowsSelection:b,hasAction:I}}function ie(){let i=window.event;return(i==null?void 0:i.key)==="Enter"}function se(){let i=window.event;return(i==null?void 0:i.key)===" "||(i==null?void 0:i.code)==="Space"}class re{getItemRect(e){let t=this.ref.current,l=e!=null?t.querySelector(`[data-key="${CSS.escape(e.toString())}"]`):null;if(!l)return null;let s=t.getBoundingClientRect(),r=l.getBoundingClientRect();return{x:r.left-s.left+t.scrollLeft,y:r.top-s.top+t.scrollTop,width:r.width,height:r.height}}getContentSize(){let e=this.ref.current;return{width:e.scrollWidth,height:e.scrollHeight}}getVisibleRect(){let e=this.ref.current;return{x:e.scrollLeft,y:e.scrollTop,width:e.offsetWidth,height:e.offsetHeight}}constructor(e){this.ref=e}}class Ve{isDisabled(e){var t;return this.disabledBehavior==="all"&&(((t=e.props)===null||t===void 0?void 0:t.isDisabled)||this.disabledKeys.has(e.key))}getNextKey(e){for(e=this.collection.getKeyAfter(e);e!=null;){let t=this.collection.getItem(e);if(t.type==="item"&&!this.isDisabled(t))return e;e=this.collection.getKeyAfter(e)}return null}getPreviousKey(e){for(e=this.collection.getKeyBefore(e);e!=null;){let t=this.collection.getItem(e);if(t.type==="item"&&!this.isDisabled(t))return e;e=this.collection.getKeyBefore(e)}return null}findKey(e,t,l){let s=this.layoutDelegate.getItemRect(e);if(!s)return null;let r=s;do e=t(e),s=this.layoutDelegate.getItemRect(e);while(s&&l(r,s));return e}isSameRow(e,t){return e.y===t.y||e.x!==t.x}isSameColumn(e,t){return e.x===t.x||e.y!==t.y}getKeyBelow(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getNextKey(t),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout==="grid"&&this.orientation==="vertical"?this.findKey(e,t=>this.getPreviousKey(t),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,t){return t?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){return this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="rtl"):this.findKey(e,t=>this.getNextColumn(t,this.direction==="rtl"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="rtl"):null}getKeyLeftOf(e){return this.layout==="grid"?this.orientation==="vertical"?this.getNextColumn(e,this.direction==="ltr"):this.findKey(e,t=>this.getNextColumn(t,this.direction==="ltr"),this.isSameColumn):this.orientation==="horizontal"?this.getNextColumn(e,this.direction==="ltr"):null}getFirstKey(){let e=this.collection.getFirstKey();for(;e!=null;){let t=this.collection.getItem(e);if((t==null?void 0:t.type)==="item"&&!this.isDisabled(t))return e;e=this.collection.getKeyAfter(e)}return null}getLastKey(){let e=this.collection.getLastKey();for(;e!=null;){let t=this.collection.getItem(e);if(t.type==="item"&&!this.isDisabled(t))return e;e=this.collection.getKeyBefore(e)}return null}getKeyPageAbove(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(!X(t))return this.getFirstKey();if(this.orientation==="horizontal"){let s=Math.max(0,l.x+l.width-this.layoutDelegate.getVisibleRect().width);for(;l&&l.x>s;)e=this.getKeyAbove(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}else{let s=Math.max(0,l.y+l.height-this.layoutDelegate.getVisibleRect().height);for(;l&&l.y>s;)e=this.getKeyAbove(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}return e??this.getFirstKey()}getKeyPageBelow(e){let t=this.ref.current,l=this.layoutDelegate.getItemRect(e);if(!l)return null;if(!X(t))return this.getLastKey();if(this.orientation==="horizontal"){let s=Math.min(this.layoutDelegate.getContentSize().width,l.y-l.width+this.layoutDelegate.getVisibleRect().width);for(;l&&l.x<s;)e=this.getKeyBelow(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}else{let s=Math.min(this.layoutDelegate.getContentSize().height,l.y-l.height+this.layoutDelegate.getVisibleRect().height);for(;l&&l.y<s;)e=this.getKeyBelow(e),l=e==null?null:this.layoutDelegate.getItemRect(e)}return e??this.getLastKey()}getKeyForSearch(e,t){if(!this.collator)return null;let l=this.collection,s=t||this.getFirstKey();for(;s!=null;){let r=l.getItem(s),c=r.textValue.slice(0,e.length);if(r.textValue&&this.collator.compare(c,e)===0)return s;s=this.getKeyBelow(s)}return null}constructor(...e){if(e.length===1){let t=e[0];this.collection=t.collection,this.ref=t.ref,this.collator=t.collator,this.disabledKeys=t.disabledKeys||new Set,this.disabledBehavior=t.disabledBehavior||"all",this.orientation=t.orientation||"vertical",this.direction=t.direction,this.layout=t.layout||"stack",this.layoutDelegate=t.layoutDelegate||new re(t.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout="stack",this.orientation="vertical",this.disabledBehavior="all",this.layoutDelegate=new re(this.ref);this.layout==="stack"&&this.orientation==="vertical"&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}}class Te{build(e,t){return this.context=t,oe(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:l}=e;if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");for(let s of e.items)yield*this.getFullNode({value:s},{renderer:t})}else{let s=[];Q.Children.forEach(t,c=>{s.push(c)});let r=0;for(let c of s){let f=this.getFullNode({element:c,index:r},{});for(let a of f)r++,yield a}}}getKey(e,t,l,s){if(e.key!=null)return e.key;if(t.type==="cell"&&t.key!=null)return`${s}${t.key}`;let r=t.value;if(r!=null){var c;let f=(c=r.key)!==null&&c!==void 0?c:r.id;if(f==null)throw new Error("No key found for item");return f}return s?`${s}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,l,s){let r=e.element;if(!r&&e.value&&t&&t.renderer){let a=this.cache.get(e.value);if(a&&(!a.shouldInvalidate||!a.shouldInvalidate(this.context))){a.index=e.index,a.parentKey=s?s.key:null,yield a;return}r=t.renderer(e.value)}if(Q.isValidElement(r)){let a=r.type;if(typeof a!="function"&&typeof a.getCollectionNode!="function"){let d=typeof r.type=="function"?r.type.name:r.type;throw new Error(`Unknown element <${d}> in collection.`)}let y=a.getCollectionNode(r.props,this.context),g=e.index,K=y.next();for(;!K.done&&K.value;){let d=K.value;e.index=g;let h=d.key;h||(h=d.element?null:this.getKey(r,e,t,l));let w=[...this.getFullNode({...d,key:h,index:g,wrapper:Ce(e.wrapper,d.wrapper)},this.getChildState(t,d),l?`${l}${r.key}`:r.key,s)];for(let b of w){if(b.value=d.value||e.value,b.value&&this.cache.set(b.value,b),e.type&&b.type!==e.type)throw new Error(`Unsupported type <${q(b.type)}> in <${q(s.type)}>. Only <${q(e.type)}> is supported.`);g++,yield b}K=y.next(w)}return}if(e.key==null)return;let c=this,f={type:e.type,props:e.props,key:e.key,parentKey:s?s.key:null,value:e.value,level:s?s.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:oe(function*(){if(!e.hasChildNodes)return;let a=0;for(let y of e.childNodes()){y.key!=null&&(y.key=`${f.key}${y.key}`),y.index=a;let g=c.getFullNode(y,c.getChildState(t,y),f.key,f);for(let K of g)a++,yield K}})};yield f}constructor(){this.cache=new WeakMap}}function oe(i){let e=[],t=null;return{*[Symbol.iterator](){for(let l of e)yield l;t||(t=i());for(let l of t)e.push(l),yield l}}}function Ce(i,e){if(i&&e)return t=>i(e(t));if(i)return i;if(e)return e}function q(i){return i[0].toUpperCase()+i.slice(1)}function Ze(i,e,t){let l=p.useMemo(()=>new Te,[]),{children:s,items:r,collection:c}=i;return p.useMemo(()=>{if(c)return c;let a=l.build({children:s,items:r},t);return e(a)},[l,s,r,c,t,e])}function Ae(i,e){return typeof e.getChildren=="function"?e.getChildren(i.key):i.childNodes}function Re(i){return Be(i,0)}function Be(i,e){if(e<0)return;let t=0;for(let l of i){if(t===e)return l;t++}}function Je(i){let e;for(let t of i)e=t;return e}function Y(i,e,t){if(e.parentKey===t.parentKey)return e.index-t.index;let l=[...ne(i,e),e],s=[...ne(i,t),t],r=l.slice(0,s.length).findIndex((c,f)=>c!==s[f]);return r!==-1?(e=l[r],t=s[r],e.index-t.index):l.findIndex(c=>c===t)>=0?1:(s.findIndex(c=>c===e)>=0,-1)}function ne(i,e){let t=[];for(;(e==null?void 0:e.parentKey)!=null;)e=i.getItem(e.parentKey),t.unshift(e);return t}class P extends Set{constructor(e,t,l){super(e),e instanceof P?(this.anchorKey=t||e.anchorKey,this.currentKey=l||e.currentKey):(this.anchorKey=t,this.currentKey=l)}}function Me(i,e){if(i.size!==e.size)return!1;for(let t of i)if(!e.has(t))return!1;return!0}function Qe(i){let{selectionMode:e="none",disallowEmptySelection:t,allowDuplicateSelectionEvents:l,selectionBehavior:s="toggle",disabledBehavior:r="all"}=i,c=p.useRef(!1),[,f]=p.useState(!1),a=p.useRef(null),y=p.useRef(null),[,g]=p.useState(null),K=p.useMemo(()=>ce(i.selectedKeys),[i.selectedKeys]),d=p.useMemo(()=>ce(i.defaultSelectedKeys,new P),[i.defaultSelectedKeys]),[h,D]=me(K,d,i.onSelectionChange),w=p.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),[b,F]=p.useState(s);s==="replace"&&b==="toggle"&&typeof h=="object"&&h.size===0&&F("replace");let m=p.useRef(s);return p.useEffect(()=>{s!==m.current&&(F(s),m.current=s)},[s]),{selectionMode:e,disallowEmptySelection:t,selectionBehavior:b,setSelectionBehavior:F,get isFocused(){return c.current},setFocused($){c.current=$,f($)},get focusedKey(){return a.current},get childFocusStrategy(){return y.current},setFocusedKey($,I="first"){a.current=$,y.current=I,g($)},selectedKeys:h,setSelectedKeys($){(l||!Me($,h))&&D($)},disabledKeys:w,disabledBehavior:r}}function ce(i,e){return i?i==="all"?"all":new P(i):e}class Ne{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){return this.state.selectionMode==="none"?!1:(e=this.getKey(e),this.state.selectedKeys==="all"?this.canSelectItem(e):this.state.selectedKeys.has(e))}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(l=>t.has(l)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!e||l&&Y(this.collection,l,e)<0)&&(e=l)}return e==null?void 0:e.key}get lastSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let l=this.collection.getItem(t);(!e||l&&Y(this.collection,l,e)>0)&&(e=l)}return e==null?void 0:e.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}e=this.getKey(e);let t;if(this.state.selectedKeys==="all")t=new P([e],e,e);else{let l=this.state.selectedKeys,s=l.anchorKey||e;t=new P(l,s,e);for(let r of this.getKeyRange(s,l.currentKey||e))t.delete(r);for(let r of this.getKeyRange(e,s))this.canSelectItem(r)&&t.add(r)}this.state.setSelectedKeys(t)}getKeyRange(e,t){let l=this.collection.getItem(e),s=this.collection.getItem(t);return l&&s?Y(this.collection,l,s)<=0?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){let l=[],s=e;for(;s;){let r=this.collection.getItem(s);if((r&&r.type==="item"||r.type==="cell"&&this.allowsCellSelection)&&l.push(s),s===t)return l;s=this.collection.getKeyAfter(s)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||t.type==="cell"&&this.allowsCellSelection)return e;for(;t.type!=="item"&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!=="item"?null:t.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}if(e=this.getKey(e),e==null)return;let t=new P(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);t.has(e)?t.delete(e):this.canSelectItem(e)&&(t.add(e),t.anchorKey=e,t.currentKey=e),!(this.disallowEmptySelection&&t.size===0)&&this.state.setSelectedKeys(t)}replaceSelection(e){if(this.selectionMode==="none"||(e=this.getKey(e),e==null))return;let t=this.canSelectItem(e)?new P([e],e,e):new P;this.state.setSelectedKeys(t)}setSelectedKeys(e){if(this.selectionMode==="none")return;let t=new P;for(let l of e)if(l=this.getKey(l),l!=null&&(t.add(l),this.selectionMode==="single"))break;this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=l=>{for(;l!=null;){if(this.canSelectItem(l)){let s=this.collection.getItem(l);s.type==="item"&&e.push(l),s.hasChildNodes&&(this.allowsCellSelection||s.type!=="item")&&t(Re(Ae(s,this.collection)).key)}l=this.collection.getKeyAfter(l)}};return t(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new P)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||t&&(t.pointerType==="touch"||t.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let l of e)if(!t.has(l))return!1;for(let l of t)if(!e.has(l))return!1;return!0}canSelectItem(e){var t;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let l=this.collection.getItem(e);return!(!l||!(l==null||(t=l.props)===null||t===void 0)&&t.isDisabled||l.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var t,l;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.isDisabled))}isLink(e){var t,l;return!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.href)}getItemProps(e){var t;return(t=this.collection.getItem(e))===null||t===void 0?void 0:t.props}constructor(e,t,l){this.collection=e,this.state=t;var s;this.allowsCellSelection=(s=l==null?void 0:l.allowsCellSelection)!==null&&s!==void 0?s:!1,this._isSelectAll=null}}export{Qe as $,Ze as a,Ne as b,Xe as c,Ye as d,Ve as e,Ge as f,Ae as g,Pe as h,we as i,Fe as j,Be as k,Je as l,Re as m,re as n,le as o};
