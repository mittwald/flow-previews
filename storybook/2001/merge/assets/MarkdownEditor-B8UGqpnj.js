import{j as r,r as _}from"./iframe-DyMBbPqz.js";import{M as q}from"./Markdown-VA3pTxbp.js";import{T as C}from"./TextArea-CpcQbjTY.js";import{O as T,K as v,P as D,Q as F,R as O}from"./IconWarning-ZZpE0RLv.js";import{B as E}from"./Button-BlPqNUGj.js";import{$ as I}from"./useLocalizedStringFormatter-Bkn65txD.js";import{c as R}from"./clsx-B-dksMZM.js";import{f as A}from"./PropsContextProvider-D5JFbFDv.js";import{b as z}from"./utils-CVBG1xQY.js";import{u as U}from"./useManagedValue-lO00UGLb.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],Q=T("outline","bold","Bold",K);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],H=T("outline","italic","Italic",V);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],Z=T("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],J=T("outline","strikethrough","Strikethrough",G);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Y=T("filled","quote-filled","QuoteFilled",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",oe="flow--markdown-editor--toolbar-buttons",se="flow--markdown-editor--mode-button",ne="flow--markdown-editor--markdown",j={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:oe,modeButton:se,markdown:ne},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},k=(e,a)=>{const d=e.lastIndexOf(`
`,a-1);return d===-1?0:d+1},B=(e,a)=>{const d=e.indexOf(`
`,a);return d===-1?e.length:d},ie=(e,a,d,n)=>{const b=d.current;if(!b)return;const{before:l,after:p="",toggleable:M=!1}=re[n],t=b.selectionStart,c=b.selectionEnd,i=e.substring(t,c),m=i.split(`
`);let u=e,s=t,h=c;if(n==="code"&&i.includes(`
`))u=e.substring(0,t)+"```\n"+i+"\n```\n"+e.substring(c),s=t+4,h=s+i.length;else if(n==="orderedList")if(i){const o=m.map((g,f)=>`${f+1}. ${g}`).join(`
`);u=e.substring(0,t)+o+e.substring(c),s=t,h=t+o.length}else{const o=k(e,t),g=B(e,t),f=`1. ${e.substring(o,g)}`;u=e.substring(0,o)+l+e.substring(o),s=o+f.length,h=s}else if(n==="unorderedList")if(i){const o=m.map(g=>`${l}${g}`).join(`
`);u=e.substring(0,t)+o+e.substring(c),s=t,h=t+o.length}else{const o=k(e,t),g=B(e,t),f=`- ${e.substring(o,g)}`;u=e.substring(0,o)+l+e.substring(o),s=o+f.length,h=s}else if(n==="quote")if(i){const o=m.map(g=>`${l}${g}`).join(`
`);u=e.substring(0,t)+o+e.substring(c),s=t,h=t+o.length}else{const o=`
${l} `;u=e.substring(0,t)+o+e.substring(c),s=t+o.length,h=s}else if(M){const o=e.substring(t-l.length,t),g=e.substring(c,c+p.length),f=o===l&&g===p,y=i.startsWith(l)&&i.endsWith(p);if(f)u=e.substring(0,t-l.length)+i+e.substring(c+p.length),s=t-l.length,h=s+i.length;else if(y){const $=i.slice(l.length,i.length-p.length);u=e.substring(0,t)+$+e.substring(c),s=t,h=t+$.length}else u=e.substring(0,t)+l+i+p+e.substring(c),i.length===0?(s=t+l.length,h=s):(s=t+l.length,h=s+i.length)}else if(n==="link"){let o="",g="",f="",y=0;i?(P=>{try{return new URL(P),!0}catch{return!1}})(i)?(g=i,f=`[](${g})`,y=t+1):(o=i,f=`[${o}]()`,y=t+f.indexOf("](")+2):(f="[](https://)",y=t+1),u=e.substring(0,t)+f+e.substring(c),s=h=y}else u=e.substring(0,t)+l+i+p+e.substring(c),i.length===0?(s=t+l.length,h=s):(s=t+l.length,h=s+i.length);a(u),requestAnimationFrame(()=>{b.setSelectionRange(s,h),b.focus()})},w={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},x=e=>{const{children:a,type:d,onPress:n,...b}=e,l=I(w);return r.jsx(E,{...b,"aria-label":l.format(`toolbar.${d}`),size:"s",variant:"plain",color:"dark",onPress:()=>n==null?void 0:n(d),children:a})};x.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onPress:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const S=e=>{const{currentMode:a,onChange:d,...n}=e,b=I(w),l=a==="editor"?"preview":"editor";return r.jsx(E,{className:j.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{d==null||d(l)},...n,children:b.format(`mode.${l}`)})};S.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const N=e=>{const a={onPress:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return r.jsxs("header",{className:j.toolbar,role:"toolbar",children:[r.jsxs("div",{className:j.toolbarButtons,children:[r.jsx(x,{...a,type:"bold",children:r.jsx(v,{children:r.jsx(Q,{})})}),r.jsx(x,{...a,type:"italic",children:r.jsx(v,{children:r.jsx(H,{})})}),r.jsx(x,{...a,type:"strikeThrough",children:r.jsx(v,{children:r.jsx(J,{})})}),r.jsx(x,{...a,type:"quote",children:r.jsx(v,{children:r.jsx(Y,{})})}),r.jsx(x,{...a,type:"code",children:r.jsx(D,{})}),r.jsx(x,{...a,type:"link",children:r.jsx(F,{})}),r.jsx(x,{...a,type:"unorderedList",children:r.jsx(v,{children:r.jsx(O,{})})}),r.jsx(x,{...a,type:"orderedList",children:r.jsx(v,{children:r.jsx(Z,{})})})]}),r.jsx(S,{onChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};N.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{currentMode:{required:!0,tsType:{name:'ModeButtonProps["currentMode"]',raw:'ModeButtonProps["currentMode"]'},description:""},onModeChange:{required:!0,tsType:{name:'ModeButtonProps["onChange"]',raw:'ModeButtonProps["onChange"]'},description:""},onToolPressed:{required:!0,tsType:{name:'ToolBarButtonProps["onPress"]',raw:'ToolBarButtonProps["onPress"]'},description:""}},composes:["Pick"]};const L=e=>{const{selectionStart:a}=e,d=parseInt(getComputedStyle(e).lineHeight||"20",10),n=e.value.slice(0,a).split(`
`).length;e.scrollTop=(n-1)*d},le=(e,a,d)=>{if(e.key!=="Enter")return;const n=a.current;if(!n)return;const b=n.selectionStart,l=n.selectionEnd,p=n.value,M=p.slice(0,b),t=p.slice(l),c=M.lastIndexOf(`
`)+1,i=M.slice(c),m=i.match(/^(\s*)(\d+)\.\s+/),u=i.match(/^(\s*)([-*+])\s+/);if((m||u)&&i.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const s=p.slice(0,c)+`
`+t;d(s),requestAnimationFrame(()=>{n.selectionStart=n.selectionEnd=c+1,L(n)});return}if(m){e.preventDefault();const s=m[1],h=parseInt(m[2]??"",10)+1,o=`
${s}${h}. `,g=M+o+t;d(g),requestAnimationFrame(()=>{n.selectionStart=n.selectionEnd=b+o.length,L(n)})}else if(u){e.preventDefault();const s=u[1],h=u[2],o=`
${s}${h} `,g=M+o+t;d(g),requestAnimationFrame(()=>{n.selectionStart=n.selectionEnd=b+o.length,L(n)})}},ae=A("MarkdownEditor",e=>{const{isDisabled:a,children:d,className:n,rows:b,autoResizeMaxRows:l,headingOffset:p,ref:M,...t}=e,[c,i]=_.useState("editor"),{value:m,handleOnChange:u}=U(e),s=z(M),h=R(j.markdownEditor,n,j[`mode-${c}`]);return r.jsxs(C,{...t,isDisabled:a||c==="preview",className:h,ref:s,value:m,rows:b,autoResizeMaxRows:l,onChange:o=>{u(o)},onKeyDown:o=>le(o,s,u),children:[r.jsx(N,{currentMode:c,isDisabled:a,onModeChange:o=>i(o),onToolPressed:o=>{ie(m,u,s,o)}}),r.jsx(q,{headingOffset:p,className:j.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${l??b} + (var(--form-control--padding-y) * 2))`},children:m}),d]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
