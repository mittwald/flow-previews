import{j as r,r as q}from"./iframe-Mcl-fp9_.js";import{M as C}from"./Markdown-BOCSQWn5.js";import{T as D}from"./TextArea-D35xkhI7.js";import{O as $,K as M,P,Q as F,R as O}from"./IconWarning-Lyb53OnO.js";import{B as I}from"./Button-DAKl4AvN.js";import{$ as S}from"./useLocalizedStringFormatter-T_IfcqNQ.js";import{c as R}from"./clsx-B-dksMZM.js";import{f as A}from"./PropsContextProvider-D0Qkc9VN.js";import{b as z}from"./utils-n1fDyKZ3.js";import{u as U}from"./useManagedValue-eGKcA8x5.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],Q=$("outline","bold","Bold",K);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],H=$("outline","italic","Italic",V);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],Z=$("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],J=$("outline","strikethrough","Strikethrough",G);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Y=$("filled","quote-filled","QuoteFilled",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",oe="flow--markdown-editor--toolbar-buttons",se="flow--markdown-editor--mode-button",ne="flow--markdown-editor--markdown",j={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:oe,modeButton:se,markdown:ne},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},k=(e,a)=>{const c=e.lastIndexOf(`
`,a-1);return c===-1?0:c+1},E=(e,a)=>{const c=e.indexOf(`
`,a);return c===-1?e.length:c},ie=(e,a,c,n)=>{const b=c.current;if(!b)return;const{before:l,after:f="",toggleable:v=!1}=re[n],t=b.selectionStart,d=b.selectionEnd,i=e.substring(t,d),m=i.split(`
`);let u=e,s=t,h=d;if(n==="code"&&i.includes(`
`))u=e.substring(0,t)+"```\n"+i+"\n```\n"+e.substring(d),s=t+4,h=s+i.length;else if(n==="orderedList")if(i){const o=m.map((g,p)=>`${p+1}. ${g}`).join(`
`);u=e.substring(0,t)+o+e.substring(d),s=t,h=t+o.length}else{const o=k(e,t),g=E(e,t),p=`1. ${e.substring(o,g)}`;u=e.substring(0,o)+l+e.substring(o),s=o+p.length,h=s}else if(n==="unorderedList")if(i){const o=m.map(g=>`${l}${g}`).join(`
`);u=e.substring(0,t)+o+e.substring(d),s=t,h=t+o.length}else{const o=k(e,t),g=E(e,t),p=`- ${e.substring(o,g)}`;u=e.substring(0,o)+l+e.substring(o),s=o+p.length,h=s}else if(n==="quote")if(i){const o=m.map(g=>`${l}${g}`).join(`
`);u=e.substring(0,t)+o+e.substring(d),s=t,h=t+o.length}else{const o=`
${l} `;u=e.substring(0,t)+o+e.substring(d),s=t+o.length,h=s}else if(v){const o=e.substring(t-l.length,t),g=e.substring(d,d+f.length),p=o===l&&g===f,y=i.startsWith(l)&&i.endsWith(f);if(p)u=e.substring(0,t-l.length)+i+e.substring(d+f.length),s=t-l.length,h=s+i.length;else if(y){const T=i.slice(l.length,i.length-f.length);u=e.substring(0,t)+T+e.substring(d),s=t,h=t+T.length}else u=e.substring(0,t)+l+i+f+e.substring(d),i.length===0?(s=t+l.length,h=s):(s=t+l.length,h=s+i.length)}else if(n==="link"){let o="",g="",p="",y=0;i?(B=>{try{return new URL(B),!0}catch{return!1}})(i)?(g=i,p=`[](${g})`,y=t+1):(o=i,p=`[${o}]()`,y=t+p.indexOf("](")+2):(p="[](https://)",y=t+1),u=e.substring(0,t)+p+e.substring(d),s=h=y}else u=e.substring(0,t)+l+i+f+e.substring(d),i.length===0?(s=t+l.length,h=s):(s=t+l.length,h=s+i.length);a(u),requestAnimationFrame(()=>{b.setSelectionRange(s,h),b.focus()})},N={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},x=e=>{const{children:a,type:c,onToolPressed:n,...b}=e,l=S(N);return r.jsx(I,{...b,"aria-label":l.format(`toolbar.${c}`),size:"s",variant:"plain",color:"dark",onPress:()=>n==null?void 0:n(c),children:a})};x.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onToolPressed:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const _=e=>{const{currentMode:a,onModeChange:c,...n}=e,b=S(N),l=a==="editor"?"preview":"editor";return r.jsx(I,{className:j.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{c==null||c(l)},...n,children:b.format(`mode.${l}`)})};_.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onModeChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const w=e=>{const a={onToolPressed:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return r.jsxs("header",{className:j.toolbar,role:"toolbar",children:[r.jsxs("div",{className:j.toolbarButtons,children:[r.jsx(x,{...a,type:"bold",children:r.jsx(M,{children:r.jsx(Q,{})})}),r.jsx(x,{...a,type:"italic",children:r.jsx(M,{children:r.jsx(H,{})})}),r.jsx(x,{...a,type:"strikeThrough",children:r.jsx(M,{children:r.jsx(J,{})})}),r.jsx(x,{...a,type:"quote",children:r.jsx(M,{children:r.jsx(Y,{})})}),r.jsx(x,{...a,type:"code",children:r.jsx(P,{})}),r.jsx(x,{...a,type:"link",children:r.jsx(F,{})}),r.jsx(x,{...a,type:"unorderedList",children:r.jsx(M,{children:r.jsx(O,{})})}),r.jsx(x,{...a,type:"orderedList",children:r.jsx(M,{children:r.jsx(Z,{})})})]}),r.jsx(_,{onModeChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};w.__docgenInfo={description:"",methods:[],displayName:"Toolbar",composes:["ModeButtonProps","Pick"]};const L=e=>{const{selectionStart:a}=e,c=parseInt(getComputedStyle(e).lineHeight||"20",10),n=e.value.slice(0,a).split(`
`).length;e.scrollTop=(n-1)*c},le=(e,a,c)=>{if(e.key!=="Enter")return;const n=a.current;if(!n)return;const b=n.selectionStart,l=n.selectionEnd,f=n.value,v=f.slice(0,b),t=f.slice(l),d=v.lastIndexOf(`
`)+1,i=v.slice(d),m=i.match(/^(\s*)(\d+)\.\s+/),u=i.match(/^(\s*)([-*+])\s+/);if((m||u)&&i.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const s=f.slice(0,d)+`
`+t;c(s),requestAnimationFrame(()=>{n.selectionStart=n.selectionEnd=d+1,L(n)});return}if(m){e.preventDefault();const s=m[1],h=parseInt(m[2]??"",10)+1,o=`
${s}${h}. `,g=v+o+t;c(g),requestAnimationFrame(()=>{n.selectionStart=n.selectionEnd=b+o.length,L(n)})}else if(u){e.preventDefault();const s=u[1],h=u[2],o=`
${s}${h} `,g=v+o+t;c(g),requestAnimationFrame(()=>{n.selectionStart=n.selectionEnd=b+o.length,L(n)})}},ae=A("MarkdownEditor",e=>{const{isDisabled:a,children:c,className:n,rows:b,autoResizeMaxRows:l,headingOffset:f,ref:v,...t}=e,[d,i]=q.useState("editor"),{value:m,handleOnChange:u}=U(e),s=z(v),h=R(j.markdownEditor,n,j[`mode-${d}`]);return r.jsxs(D,{...t,isDisabled:a||d==="preview",className:h,ref:s,value:m,rows:b,autoResizeMaxRows:l,onChange:o=>{u(o)},onKeyDown:o=>le(o,s,u),children:[r.jsx(w,{currentMode:d,isDisabled:a,onModeChange:o=>i(o),onToolPressed:o=>{ie(m,u,s,o)}}),r.jsx(C,{headingOffset:f,className:j.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${l??b} + (var(--form-control--padding-y) * 2))`},children:m}),c]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
