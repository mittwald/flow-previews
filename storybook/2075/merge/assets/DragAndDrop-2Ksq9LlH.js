import{$ as x}from"./useCollator-DJ52WOHW.js";import{d as y,b as m}from"./index-PmbawSGG.js";import{r as o,R as b}from"./iframe-C3YinX3s.js";function I(i,e){let{collection:l,onLoadMore:r,scrollOffset:c=1}=i,u=o.useRef(null),n=y(a=>{for(let f of a)f.isIntersecting&&r&&r()});m(()=>(e.current&&(u.current=new IntersectionObserver(n,{root:x(e?.current),rootMargin:`0px ${100*c}% ${100*c}% ${100*c}%`}),u.current.observe(e.current)),()=>{u.current&&u.current.disconnect()}),[l,n,e,c])}const L=o.createContext({}),K=o.createContext(null),M=o.forwardRef(function(e,l){let{render:r}=o.useContext(K);return b.createElement(b.Fragment,null,r(e,l))});function O(i,e){var l;let r=i?.renderDropIndicator,c=i==null||(l=i.isVirtualDragging)===null||l===void 0?void 0:l.call(i),u=o.useCallback(n=>{if(c||e?.isDropTarget(n))return r?r(n):b.createElement(M,{target:n})},[e?.target,c,r]);return i?.useDropIndicator?u:void 0}function R(i,e,l){var r,c;let u=i.focusedKey,n=null;if(!(e==null||(r=e.isVirtualDragging)===null||r===void 0)&&r.call(e)&&(l==null||(c=l.target)===null||c===void 0?void 0:c.type)==="item"&&(n=l.target.key,l.target.dropPosition==="after")){let t=l.collection.getKeyAfter(n),d=null;if(t!=null){var a,f;let g=(f=(a=l.collection.getItem(n))===null||a===void 0?void 0:a.level)!==null&&f!==void 0?f:0;for(;t;){let $=l.collection.getItem(t);if(!$)break;if($.type!=="item"){t=l.collection.getKeyAfter(t);continue}var v;if(((v=$.level)!==null&&v!==void 0?v:0)<=g)break;d=t,t=l.collection.getKeyAfter(t)}}var s;n=(s=t??d)!==null&&s!==void 0?s:n}return o.useMemo(()=>new Set([u,n].filter(t=>t!=null)),[u,n])}export{L as $,K as a,O as b,R as c,I as d};
