import{r as d}from"./iframe-fd4MG1i8.js";import{F as B}from"./useFocus-BWTUKGe5.js";import{b as T,d as I}from"./index-CeLeQ-qQ.js";const S={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},C={...S,customError:!0,valid:!1},$={isInvalid:!1,validationDetails:S,validationErrors:[]},U=d.createContext({}),D="__formValidationState"+Date.now();function H(a){if(a[D]){let{realtimeValidation:e,displayValidation:t,updateValidation:r,resetValidation:v,commitValidation:l}=a[D];return{realtimeValidation:e,displayValidation:t,updateValidation:r,resetValidation:v,commitValidation:l}}return F(a)}function F(a){let{isInvalid:e,validationState:t,name:r,value:v,builtinValidation:l,validate:u,validationBehavior:s="aria"}=a;t&&(e||(e=t==="invalid"));let f=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:C}:null,n=d.useMemo(()=>{if(!u||v==null)return null;let o=j(u,v);return L(o)},[u,v]);l?.validationDetails.valid&&(l=void 0);let i=d.useContext(U),c=d.useMemo(()=>r?Array.isArray(r)?r.flatMap(o=>M(i[o])):M(i[r]):[],[i,r]),[m,A]=d.useState(i),[x,b]=d.useState(!1);i!==m&&(A(i),b(!1));let p=d.useMemo(()=>L(x?[]:c),[x,c]),w=d.useRef($),[E,g]=d.useState($),V=d.useRef($),R=()=>{if(!O)return;y(!1);let o=n||l||w.current;h(o,V.current)||(V.current=o,g(o))},[O,y]=d.useState(!1);return d.useEffect(R),{realtimeValidation:f||p||n||l||$,displayValidation:s==="native"?f||p||E:f||p||n||l||E,updateValidation(o){s==="aria"&&!h(E,o)?g(o):w.current=o},resetValidation(){let o=$;h(o,V.current)||(V.current=o,g(o)),s==="native"&&y(!1),b(!0)},commitValidation(){s==="native"&&y(!0),b(!0)}}}function M(a){return a?Array.isArray(a)?a:[a]:[]}function j(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return M(t)}return[]}function L(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:C}:null}function h(a,e){return a===e?!0:!!a&&!!e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,r)=>t===e.validationErrors[r])&&Object.entries(a.validationDetails).every(([t,r])=>e.validationDetails[t]===r)}function J(...a){let e=new Set,t=!1,r={...S};for(let u of a){var v,l;for(let s of u.validationErrors)e.add(s);t||(t=u.isInvalid);for(let s in r)(v=r)[l=s]||(v[l]=u.validationDetails[s])}return r.valid=!t,{isInvalid:t,validationErrors:[...e],validationDetails:r}}function K(a,e,t){let{validationBehavior:r,focus:v}=a;T(()=>{if(r==="native"&&t?.current&&!t.current.disabled){let n=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(n),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(Q(t.current))}});let l=d.useRef(!1),u=I(()=>{l.current||e.resetValidation()}),s=I(n=>{var i;e.displayValidation.isInvalid||e.commitValidation();let c=t==null||(i=t.current)===null||i===void 0?void 0:i.form;if(!n.defaultPrevented&&t&&c&&k(c)===t.current){var m;v?v():(m=t.current)===null||m===void 0||m.focus(),B("keyboard")}n.preventDefault()}),f=I(()=>{e.commitValidation()});d.useEffect(()=>{let n=t?.current;if(!n)return;let i=n.form,c=i?.reset;return i&&(i.reset=()=>{l.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,c?.call(i),l.current=!1}),n.addEventListener("invalid",s),n.addEventListener("change",f),i?.addEventListener("reset",u),()=>{n.removeEventListener("invalid",s),n.removeEventListener("change",f),i?.removeEventListener("reset",u),i&&(i.reset=c)}},[t,s,f,u,r])}function P(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function Q(a){return{isInvalid:!a.validity.valid,validationDetails:P(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function k(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}export{H as $,K as a,D as b,$ as c,J as d,S as e};
