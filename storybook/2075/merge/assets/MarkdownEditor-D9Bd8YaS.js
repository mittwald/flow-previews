import{j as r,r as P}from"./iframe-fd4MG1i8.js";import{M as _}from"./Markdown-fkuMvBNf.js";import{T as C}from"./TextArea-CM4b1Wby.js";import{K as T,s as v,L as D,M as R,N as O}from"./IconWarning-9sqw3U7E.js";import{B as w}from"./Button-VeSKQaWX.js";import{$ as E}from"./useLocalizedStringFormatter-CKY9Jmr8.js";import{c as z}from"./clsx-B-dksMZM.js";import{f as A}from"./flowComponent-CuscKuFt.js";import{b as F}from"./utils-Cwcb_ph1.js";import{u as U}from"./useManagedValue-DC34vg_T.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M6 15h15",key:"svg-0"}],["path",{d:"M21 19h-15",key:"svg-1"}],["path",{d:"M15 11h6",key:"svg-2"}],["path",{d:"M21 7h-6",key:"svg-3"}],["path",{d:"M9 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-4"}],["path",{d:"M3 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-5"}]],K=T("outline","blockquote","Blockquote",V);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],W=T("outline","bold","Bold",H);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],Z=T("outline","italic","Italic",Q);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],J=T("outline","list-numbers","ListNumbers",G);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],Y=T("outline","strikethrough","Strikethrough",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",oe="flow--markdown-editor--toolbar-buttons",se="flow--markdown-editor--mode-button",ne="flow--markdown-editor--markdown",j={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:oe,modeButton:se,markdown:ne},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},L=(e,a)=>{const h=e.lastIndexOf(`
`,a-1);return h===-1?0:h+1},B=(e,a)=>{const h=e.indexOf(`
`,a);return h===-1?e.length:h},ie=(e,a,h,i)=>{const p=h.current;if(!p)return;const{before:l,after:f="",toggleable:M=!1}=re[i],t=p.selectionStart,g=p.selectionEnd,n=e.substring(t,g),m=n.split(`
`);let c=e,o=t,d=g;if(i==="code"&&n.includes(`
`))c=e.substring(0,t)+"```\n"+n+"\n```\n"+e.substring(g),o=t+4,d=o+n.length;else if(i==="orderedList")if(n){const s=m.map((b,u)=>`${u+1}. ${b}`).join(`
`);c=e.substring(0,t)+s+e.substring(g),o=t,d=t+s.length}else{const s=L(e,t),b=B(e,t),u=`1. ${e.substring(s,b)}`;c=e.substring(0,s)+l+e.substring(s),o=s+u.length,d=o}else if(i==="unorderedList")if(n){const s=m.map(b=>`${l}${b}`).join(`
`);c=e.substring(0,t)+s+e.substring(g),o=t,d=t+s.length}else{const s=L(e,t),b=B(e,t),u=`- ${e.substring(s,b)}`;c=e.substring(0,s)+l+e.substring(s),o=s+u.length,d=o}else if(i==="quote")if(n){const s=m.map(b=>`${l}${b}`).join(`
`);c=e.substring(0,t)+s+e.substring(g),o=t,d=t+s.length}else{const s=`
${l} `;c=e.substring(0,t)+s+e.substring(g),o=t+s.length,d=o}else if(M){const s=e.substring(t-l.length,t),b=e.substring(g,g+f.length),u=s===l&&b===f,x=n.startsWith(l)&&n.endsWith(f);if(u)c=e.substring(0,t-l.length)+n+e.substring(g+f.length),o=t-l.length,d=o+n.length;else if(x){const k=n.slice(l.length,n.length-f.length);c=e.substring(0,t)+k+e.substring(g),o=t,d=t+k.length}else c=e.substring(0,t)+l+n+f+e.substring(g),n.length===0?(o=t+l.length,d=o):(o=t+l.length,d=o+n.length)}else if(i==="link"){let s="",b="",u="",x=0;n?(q=>{try{return new URL(q),!0}catch{return!1}})(n)?(b=n,u=`[](${b})`,x=t+1):(s=n,u=`[${s}]()`,x=t+u.indexOf("](")+2):(u="[](https://)",x=t+1),c=e.substring(0,t)+u+e.substring(g),o=d=x}else c=e.substring(0,t)+l+n+f+e.substring(g),n.length===0?(o=t+l.length,d=o):(o=t+l.length,d=o+n.length);a(c),requestAnimationFrame(()=>{p.setSelectionRange(o,d),p.focus()})},I={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},y=e=>{const{children:a,type:h,onPress:i,...p}=e,l=E(I);return r.jsx(w,{...p,"aria-label":l.format(`toolbar.${h}`),size:"s",variant:"plain",color:"dark",onPress:()=>i?.(h),children:a})};y.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onPress:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const N=e=>{const{currentMode:a,onChange:h,...i}=e,p=E(I),l=a==="editor"?"preview":"editor";return r.jsx(w,{className:j.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{h?.(l)},...i,children:p.format(`mode.${l}`)})};N.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const S=e=>{const a={onPress:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return r.jsxs("header",{className:j.toolbar,role:"toolbar",children:[r.jsxs("div",{className:j.toolbarButtons,children:[r.jsx(y,{...a,type:"bold",children:r.jsx(v,{children:r.jsx(W,{})})}),r.jsx(y,{...a,type:"italic",children:r.jsx(v,{children:r.jsx(Z,{})})}),r.jsx(y,{...a,type:"strikeThrough",children:r.jsx(v,{children:r.jsx(Y,{})})}),r.jsx(y,{...a,type:"quote",children:r.jsx(v,{children:r.jsx(K,{})})}),r.jsx(y,{...a,type:"code",children:r.jsx(D,{})}),r.jsx(y,{...a,type:"link",children:r.jsx(R,{})}),r.jsx(y,{...a,type:"unorderedList",children:r.jsx(v,{children:r.jsx(O,{})})}),r.jsx(y,{...a,type:"orderedList",children:r.jsx(v,{children:r.jsx(J,{})})})]}),r.jsx(N,{onChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};S.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{currentMode:{required:!0,tsType:{name:'ModeButtonProps["currentMode"]',raw:'ModeButtonProps["currentMode"]'},description:""},onModeChange:{required:!0,tsType:{name:'ModeButtonProps["onChange"]',raw:'ModeButtonProps["onChange"]'},description:""},onToolPressed:{required:!0,tsType:{name:'ToolBarButtonProps["onPress"]',raw:'ToolBarButtonProps["onPress"]'},description:""}},composes:["Pick"]};const $=e=>{const{selectionStart:a}=e,h=parseInt(getComputedStyle(e).lineHeight||"20",10),i=e.value.slice(0,a).split(`
`).length;e.scrollTop=(i-1)*h},le=(e,a,h)=>{if(e.key!=="Enter")return;const i=a.current;if(!i)return;const p=i.selectionStart,l=i.selectionEnd,f=i.value,M=f.slice(0,p),t=f.slice(l),g=M.lastIndexOf(`
`)+1,n=M.slice(g),m=n.match(/^(\s*)(\d+)\.\s+/),c=n.match(/^(\s*)([-*+])\s+/);if((m||c)&&n.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const o=f.slice(0,g)+`
`+t;h(o),requestAnimationFrame(()=>{i.selectionStart=i.selectionEnd=g+1,$(i)});return}if(m){e.preventDefault();const o=m[1],d=parseInt(m[2]??"",10)+1,s=`
${o}${d}. `,b=M+s+t;h(b),requestAnimationFrame(()=>{i.selectionStart=i.selectionEnd=p+s.length,$(i)})}else if(c){e.preventDefault();const o=c[1],d=c[2],s=`
${o}${d} `,b=M+s+t;h(b),requestAnimationFrame(()=>{i.selectionStart=i.selectionEnd=p+s.length,$(i)})}},ae=A("MarkdownEditor",e=>{const{isDisabled:a,isReadOnly:h,children:i,className:p,rows:l=5,autoResizeMaxRows:f,headingOffset:M,ref:t,...g}=e,[n,m]=P.useState("editor"),{value:c,handleOnChange:o}=U(e),d=F(t),s=z(j.markdownEditor,p,j[`mode-${n}`]),b=e.allowResize||e.allowVerticalResize;return r.jsxs(C,{...g,isReadOnly:h||n==="preview",isDisabled:a,className:s,ref:d,value:c,rows:l,autoResizeMaxRows:f,onChange:u=>{o(u)},onKeyDown:u=>le(u,d,o),children:[r.jsx(S,{currentMode:n,isDisabled:a,onModeChange:u=>m(u),onToolPressed:u=>{ie(c,o,d,u)}}),r.jsx(_,{headingOffset:M,className:j.markdown,style:{maxHeight:b?void 0:`calc(var(--line-height--m) * ${f??l} + (var(--form-control--padding-y) * 2))`},children:c}),i]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
