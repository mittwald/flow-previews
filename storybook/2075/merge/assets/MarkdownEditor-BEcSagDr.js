import{j as i,r as P}from"./iframe-D3XbVUAE.js";import{M as _}from"./Markdown-F3cnFOlL.js";import{T as C}from"./TextArea-BmEWbLk8.js";import{O as T,K as v,P as R,Q as D,R as O}from"./IconWarning-DpoKEiS2.js";import{B as w}from"./Button-DI43yX0M.js";import{$ as E}from"./useLocalizedStringFormatter-CjS_r_W_.js";import{c as z}from"./clsx-B-dksMZM.js";import{f as A}from"./flowComponent-EDib50S8.js";import{b as F}from"./utils-BWY6h_sn.js";import{u as U}from"./useManagedValue-aUKzl9Jg.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M6 15h15",key:"svg-0"}],["path",{d:"M21 19h-15",key:"svg-1"}],["path",{d:"M15 11h6",key:"svg-2"}],["path",{d:"M21 7h-6",key:"svg-3"}],["path",{d:"M9 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-4"}],["path",{d:"M3 9h1a1 1 0 1 1 -1 1v-2.5a2 2 0 0 1 2 -2",key:"svg-5"}]],K=T("outline","blockquote","Blockquote",V);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],W=T("outline","bold","Bold",H);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],Z=T("outline","italic","Italic",Q);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],J=T("outline","list-numbers","ListNumbers",G);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],Y=T("outline","strikethrough","Strikethrough",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",oe="flow--markdown-editor--toolbar-buttons",se="flow--markdown-editor--mode-button",ne="flow--markdown-editor--markdown",j={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:oe,modeButton:se,markdown:ne},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},L=(e,a)=>{const c=e.lastIndexOf(`
`,a-1);return c===-1?0:c+1},B=(e,a)=>{const c=e.indexOf(`
`,a);return c===-1?e.length:c},ie=(e,a,c,r)=>{const p=c.current;if(!p)return;const{before:l,after:f="",toggleable:x=!1}=re[r],t=p.selectionStart,g=p.selectionEnd,n=e.substring(t,g),m=n.split(`
`);let u=e,o=t,d=g;if(r==="code"&&n.includes(`
`))u=e.substring(0,t)+"```\n"+n+"\n```\n"+e.substring(g),o=t+4,d=o+n.length;else if(r==="orderedList")if(n){const s=m.map((b,h)=>`${h+1}. ${b}`).join(`
`);u=e.substring(0,t)+s+e.substring(g),o=t,d=t+s.length}else{const s=L(e,t),b=B(e,t),h=`1. ${e.substring(s,b)}`;u=e.substring(0,s)+l+e.substring(s),o=s+h.length,d=o}else if(r==="unorderedList")if(n){const s=m.map(b=>`${l}${b}`).join(`
`);u=e.substring(0,t)+s+e.substring(g),o=t,d=t+s.length}else{const s=L(e,t),b=B(e,t),h=`- ${e.substring(s,b)}`;u=e.substring(0,s)+l+e.substring(s),o=s+h.length,d=o}else if(r==="quote")if(n){const s=m.map(b=>`${l}${b}`).join(`
`);u=e.substring(0,t)+s+e.substring(g),o=t,d=t+s.length}else{const s=`
${l} `;u=e.substring(0,t)+s+e.substring(g),o=t+s.length,d=o}else if(x){const s=e.substring(t-l.length,t),b=e.substring(g,g+f.length),h=s===l&&b===f,M=n.startsWith(l)&&n.endsWith(f);if(h)u=e.substring(0,t-l.length)+n+e.substring(g+f.length),o=t-l.length,d=o+n.length;else if(M){const k=n.slice(l.length,n.length-f.length);u=e.substring(0,t)+k+e.substring(g),o=t,d=t+k.length}else u=e.substring(0,t)+l+n+f+e.substring(g),n.length===0?(o=t+l.length,d=o):(o=t+l.length,d=o+n.length)}else if(r==="link"){let s="",b="",h="",M=0;n?(N=>{try{return new URL(N),!0}catch{return!1}})(n)?(b=n,h=`[](${b})`,M=t+1):(s=n,h=`[${s}]()`,M=t+h.indexOf("](")+2):(h="[](https://)",M=t+1),u=e.substring(0,t)+h+e.substring(g),o=d=M}else u=e.substring(0,t)+l+n+f+e.substring(g),n.length===0?(o=t+l.length,d=o):(o=t+l.length,d=o+n.length);a(u),requestAnimationFrame(()=>{p.setSelectionRange(o,d),p.focus()})},I={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},y=e=>{const{children:a,type:c,onPress:r,...p}=e,l=E(I);return i.jsx(w,{...p,"aria-label":l.format(`toolbar.${c}`),size:"s",variant:"plain",color:"dark",onPress:()=>r==null?void 0:r(c),children:a})};y.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onPress:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const S=e=>{const{currentMode:a,onChange:c,...r}=e,p=E(I),l=a==="editor"?"preview":"editor";return i.jsx(w,{className:j.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{c==null||c(l)},...r,children:p.format(`mode.${l}`)})};S.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const q=e=>{const a={onPress:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return i.jsxs("header",{className:j.toolbar,role:"toolbar",children:[i.jsxs("div",{className:j.toolbarButtons,children:[i.jsx(y,{...a,type:"bold",children:i.jsx(v,{children:i.jsx(W,{})})}),i.jsx(y,{...a,type:"italic",children:i.jsx(v,{children:i.jsx(Z,{})})}),i.jsx(y,{...a,type:"strikeThrough",children:i.jsx(v,{children:i.jsx(Y,{})})}),i.jsx(y,{...a,type:"quote",children:i.jsx(v,{children:i.jsx(K,{})})}),i.jsx(y,{...a,type:"code",children:i.jsx(R,{})}),i.jsx(y,{...a,type:"link",children:i.jsx(D,{})}),i.jsx(y,{...a,type:"unorderedList",children:i.jsx(v,{children:i.jsx(O,{})})}),i.jsx(y,{...a,type:"orderedList",children:i.jsx(v,{children:i.jsx(J,{})})})]}),i.jsx(S,{onChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};q.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{currentMode:{required:!0,tsType:{name:'ModeButtonProps["currentMode"]',raw:'ModeButtonProps["currentMode"]'},description:""},onModeChange:{required:!0,tsType:{name:'ModeButtonProps["onChange"]',raw:'ModeButtonProps["onChange"]'},description:""},onToolPressed:{required:!0,tsType:{name:'ToolBarButtonProps["onPress"]',raw:'ToolBarButtonProps["onPress"]'},description:""}},composes:["Pick"]};const $=e=>{const{selectionStart:a}=e,c=parseInt(getComputedStyle(e).lineHeight||"20",10),r=e.value.slice(0,a).split(`
`).length;e.scrollTop=(r-1)*c},le=(e,a,c)=>{if(e.key!=="Enter")return;const r=a.current;if(!r)return;const p=r.selectionStart,l=r.selectionEnd,f=r.value,x=f.slice(0,p),t=f.slice(l),g=x.lastIndexOf(`
`)+1,n=x.slice(g),m=n.match(/^(\s*)(\d+)\.\s+/),u=n.match(/^(\s*)([-*+])\s+/);if((m||u)&&n.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const o=f.slice(0,g)+`
`+t;c(o),requestAnimationFrame(()=>{r.selectionStart=r.selectionEnd=g+1,$(r)});return}if(m){e.preventDefault();const o=m[1],d=parseInt(m[2]??"",10)+1,s=`
${o}${d}. `,b=x+s+t;c(b),requestAnimationFrame(()=>{r.selectionStart=r.selectionEnd=p+s.length,$(r)})}else if(u){e.preventDefault();const o=u[1],d=u[2],s=`
${o}${d} `,b=x+s+t;c(b),requestAnimationFrame(()=>{r.selectionStart=r.selectionEnd=p+s.length,$(r)})}},ae=A("MarkdownEditor",e=>{const{isDisabled:a,isReadOnly:c,children:r,className:p,rows:l=5,autoResizeMaxRows:f,headingOffset:x,ref:t,...g}=e,[n,m]=P.useState("editor"),{value:u,handleOnChange:o}=U(e),d=F(t),s=z(j.markdownEditor,p,j[`mode-${n}`]),b=e.allowResize||e.allowVerticalResize;return i.jsxs(C,{...g,isReadOnly:c||n==="preview",isDisabled:a,className:s,ref:d,value:u,rows:l,autoResizeMaxRows:f,onChange:h=>{o(h)},onKeyDown:h=>le(h,d,o),children:[i.jsx(q,{currentMode:n,isDisabled:a,onModeChange:h=>m(h),onToolPressed:h=>{ie(u,o,d,h)}}),i.jsx(_,{headingOffset:x,className:j.markdown,style:{maxHeight:b?void 0:`calc(var(--line-height--m) * ${f??l} + (var(--form-control--padding-y) * 2))`},children:u}),r]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
