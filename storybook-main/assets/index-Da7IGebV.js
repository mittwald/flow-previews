import{r as i,R as u}from"./index-uCp2LrAq.js";import{f as oe,C as Te,P as X}from"./flowComponent-BPbRU2D0.js";import{c as we,d as Ie,e as Re,$ as Oe,a as De,b as Fe,f as _e,g as Ae}from"./index-DxHWpCWl.js";import{P as Ne}from"./Popover-DBFx0NG8.js";import{a as Be,c as Y,b as He}from"./Collection-DUP4IVi4.js";import{f as H,a as Le,d as Ue,h as Ve,g as se,b as ae,c as We}from"./utils-CHnd_qWz.js";import{f as le,j as F,k as ze,l as Xe}from"./Dialog-CmqFKjmg.js";import{$ as je,a as Ye}from"./Separator-BEXQHetg.js";import{a as ie}from"./Text-QhWkLhD7.js";import{a as L,e as z,$ as j,c as te,d as qe}from"./index-7Bm5Bt6L.js";import{$ as U}from"./filterDOMProps-CeZl_uWj.js";import{d as ce,$ as Ge}from"./OverlayArrow-DMphC9df.js";import{c as q,j as Je,u as Qe,v as Ze,w as et,b as ue}from"./useFocusable-BGYghl-O.js";import{a as tt,$ as nt,b as rt}from"./usePress-C4eoOWOJ.js";import{$ as ot}from"./useLocalizedStringFormatter-Cwaj61aR.js";import{$ as st}from"./useControlledState-B8AA3oOY.js";import{a as at}from"./FocusScope-BAgquhRo.js";import{c as de}from"./clsx-B-dksMZM.js";import"./IconApp-BRYLaoUD.js";import{B as lt,C as it,y as ct,A as ut}from"./IconWarning-CdY7x1SP.js";import"./index-CaYXpo-E.js";import{d as dt}from"./deepFindOfType-riA8XRsE.js";import{W as ft}from"./Wrap-DQq6jo70.js";import{T as ne}from"./Text-CXPWODI3.js";const fe=new WeakMap;function pt(t,e,n){let{shouldFocusWrap:s=!0,onKeyDown:r,onKeyUp:l,...o}=t;!t["aria-label"]&&!t["aria-labelledby"]&&console.warn("An aria-label or aria-labelledby prop is required for accessibility.");let a=U(t,{labelable:!0}),{listProps:c}=we({...o,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys,shouldFocusWrap:s,linkBehavior:"override"});return fe.set(e,{onClose:t.onClose,onAction:t.onAction}),{menuProps:L(a,{onKeyDown:r,onKeyUp:l},{role:"menu",...c,onKeyDown:p=>{p.key!=="Escape"&&c.onKeyDown(p)}})}}function pe(t,e,n){let{key:s,closeOnSelect:r,isVirtualized:l,"aria-haspopup":o,onPressStart:a,onPressUp:c,onPress:p,onPressChange:b,onPressEnd:d,onHoverStart:$,onHoverChange:y,onHoverEnd:g,onKeyDown:m,onKeyUp:k,onFocus:S,onFocusChange:E,onBlur:K}=t,P=!!o;var C;let v=(C=t.isDisabled)!==null&&C!==void 0?C:e.selectionManager.isDisabled(s);var x;let f=(x=t.isSelected)!==null&&x!==void 0?x:e.selectionManager.isSelected(s),w=fe.get(e),M=e.collection.getItem(s),T=t.onClose||w.onClose,V=tt(),O=h=>{var W;P||(!(M==null||(W=M.props)===null||W===void 0)&&W.onAction&&M.props.onAction(),t.onAction?t.onAction(s):w.onAction&&w.onAction(s),h.target instanceof HTMLAnchorElement&&V.open(h.target,h,M.props.href,M.props.routerOptions))},I="menuitem";P||(e.selectionManager.selectionMode==="single"?I="menuitemradio":e.selectionManager.selectionMode==="multiple"&&(I="menuitemcheckbox"));let R=z(),Q=z(),Z=z(),A={"aria-disabled":v||void 0,role:I,"aria-label":t["aria-label"],"aria-labelledby":R,"aria-describedby":[Q,Z].filter(Boolean).join(" ")||void 0,"aria-controls":t["aria-controls"],"aria-haspopup":o,"aria-expanded":t["aria-expanded"]};e.selectionManager.selectionMode!=="none"&&!P&&(A["aria-checked"]=f),l&&(A["aria-posinset"]=M==null?void 0:M.index,A["aria-setsize"]=Ie(e.collection));let he=h=>{h.pointerType==="keyboard"&&O(h),a==null||a(h)},Pe=h=>{h.pointerType!=="keyboard"&&(O(h),!P&&T&&(r??(e.selectionManager.selectionMode!=="multiple"||e.selectionManager.isLink(s)))&&T()),c==null||c(h)},{itemProps:N,isFocused:xe}=Re({selectionManager:e.selectionManager,key:s,ref:n,shouldSelectOnPressUp:!0,allowsDifferentPressOrigin:!0,linkBehavior:"none"}),{pressProps:Me,isPressed:Se}=nt({onPressStart:he,onPress:p,onPressUp:Pe,onPressChange:b,onPressEnd:d,isDisabled:v}),{hoverProps:Ee}=q({isDisabled:v,onHoverStart(h){Je()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(s)),$==null||$(h)},onHoverChange:y,onHoverEnd:g}),{keyboardProps:Ce}=Qe({onKeyDown:h=>{if(h.repeat){h.continuePropagation();return}switch(h.key){case" ":!v&&e.selectionManager.selectionMode==="none"&&!P&&r!==!1&&T&&T();break;case"Enter":!v&&r!==!1&&!P&&T&&T();break;default:P||h.continuePropagation(),m==null||m(h);break}},onKeyUp:k}),{focusProps:ke}=Ze({onBlur:K,onFocus:S,onFocusChange:E}),ee=U(M.props);delete ee.id;let Ke=rt(M.props);return{menuItemProps:{...A,...L(ee,Ke,P?{onFocus:N.onFocus,"data-key":N["data-key"]}:N,Me,Ee,Ce,ke),tabIndex:N.tabIndex!=null?-1:void 0},labelProps:{id:R},descriptionProps:{id:Q},keyboardShortcutProps:{id:Z},isFocused:xe,isSelected:f,isPressed:Se,isDisabled:v}}function bt(t){let{heading:e,"aria-label":n}=t,s=j();return{itemProps:{role:"presentation"},headingProps:e?{id:s,role:"presentation"}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?s:void 0}}}const B=2,mt=50,$t=1e3,re=Math.PI/12;function gt(t){let{menuRef:e,submenuRef:n,isOpen:s,isDisabled:r}=t,l=i.useRef(),o=i.useRef(),a=i.useRef(0),c=i.useRef(),p=i.useRef(),b=i.useRef(),d=i.useRef(2),[$,y]=i.useState(!1);ce({ref:n,onResize:()=>{n.current&&(o.current=n.current.getBoundingClientRect(),b.current=void 0)}});let m=()=>{y(!1),d.current=B,l.current=void 0},k=et();i.useEffect(()=>{$&&e.current?e.current.style.pointerEvents="none":e.current.style.pointerEvents=""},[e,$]),i.useEffect(()=>{let S=n.current,E=e.current;if(r||!S||!s||k!=="pointer"){m();return}o.current=S.getBoundingClientRect();let K=P=>{if(P.pointerType==="touch"||P.pointerType==="pen")return;let C=Date.now();if(C-a.current<mt)return;clearTimeout(c.current),clearTimeout(p.current);let{clientX:v,clientY:x}=P;if(!l.current){l.current={x:v,y:x};return}if(!o.current)return;if(b.current||(b.current=v>o.current.right?"left":"right"),v<E.getBoundingClientRect().left||v>E.getBoundingClientRect().right||x<E.getBoundingClientRect().top||x>E.getBoundingClientRect().bottom){m();return}let f=l.current.x,w=l.current.y,M=b.current==="right"?o.current.left-f:f-o.current.right,T=Math.atan2(w-o.current.top,M)+re,V=Math.atan2(w-o.current.bottom,M)-re,O=Math.atan2(w-x,b.current==="left"?-(v-f):v-f),I=O<T&&O>V;d.current=I?Math.min(d.current+1,B):Math.max(d.current-1,0),d.current>=B?y(!0):y(!1),a.current=C,l.current={x:v,y:x},I&&(c.current=setTimeout(()=>{m(),p.current=setTimeout(()=>{let R=document.elementFromPoint(v,x);R&&E.contains(R)&&R.dispatchEvent(new PointerEvent("pointerover",{bubbles:!0,cancelable:!0}))},100)},$t))};return window.addEventListener("pointermove",K),()=>{window.removeEventListener("pointermove",K),clearTimeout(c.current),clearTimeout(p.current),d.current=B}},[r,s,e,k,y,n])}function yt(t,e,n){let{parentMenuRef:s,submenuRef:r,type:l="menu",isDisabled:o,node:a,delay:c=200}=t,p=j(),b=j(),{direction:d}=ot(),$=i.useRef(),y=i.useCallback(()=>{$.current&&(clearTimeout($.current),$.current=void 0)},[$]),g=te(f=>{y(),e.open(f)}),m=te(()=>{y(),e.close()});qe(()=>()=>{y()},[y]);let k=f=>{switch(f.key){case"ArrowLeft":d==="ltr"&&f.currentTarget.contains(f.target)&&(f.stopPropagation(),m(),n.current.focus());break;case"ArrowRight":d==="rtl"&&f.currentTarget.contains(f.target)&&(f.stopPropagation(),m(),n.current.focus());break;case"Escape":f.stopPropagation(),e.closeAll();break}},S={id:b,"aria-label":a.textValue,submenuLevel:e.submenuLevel,...l==="menu"&&{onClose:e.closeAll,autoFocus:e.focusStrategy,onKeyDown:k}},E=f=>{switch(f.key){case"ArrowRight":o||(d==="ltr"?(e.isOpen||g("first"),l==="menu"&&(r!=null&&r.current)&&document.activeElement===(n==null?void 0:n.current)&&r.current.focus()):e.isOpen?m():f.continuePropagation());break;case"ArrowLeft":o||(d==="rtl"?(e.isOpen||g("first"),l==="menu"&&(r!=null&&r.current)&&document.activeElement===(n==null?void 0:n.current)&&r.current.focus()):e.isOpen?m():f.continuePropagation());break;case"Escape":e.closeAll();break;default:f.continuePropagation();break}},K=f=>{!o&&(f.pointerType==="virtual"||f.pointerType==="keyboard")&&g("first")},P=f=>{!o&&(f.pointerType==="touch"||f.pointerType==="mouse")&&g()},C=f=>{o||(f&&!e.isOpen?$.current||($.current=setTimeout(()=>{g()},c)):f||y())},v=f=>{e.isOpen&&s.current.contains(f.relatedTarget)&&m()},x=f=>f!==n.current;return gt({menuRef:s,submenuRef:r,isOpen:e.isOpen,isDisabled:o}),{submenuTriggerProps:{id:p,"aria-controls":e.isOpen?b:void 0,"aria-haspopup":o?void 0:l,"aria-expanded":e.isOpen?"true":"false",onPressStart:K,onPress:P,onHoverChange:C,onKeyDown:E,onBlur:v,isOpen:e.isOpen},submenuProps:S,popoverProps:{isNonModal:!0,disableFocusManagement:!0,shouldCloseOnInteractOutside:x}}}function vt(t){let e=Ge(t),[n,s]=i.useState(null),[r,l]=i.useState([]),o=()=>{l([]),e.close()};return{focusStrategy:n,...e,open(p=null){s(p),e.open()},toggle(p=null){s(p),e.toggle()},close(){o()},expandedKeysStack:r,openSubmenu:(p,b)=>{l(d=>b>d.length?d:[...d.slice(0,b),p])},closeSubmenu:(p,b)=>{l(d=>d[b]===p?d.slice(0,b):d)}}}function ht(t,e){let{triggerKey:n}=t,{expandedKeysStack:s,openSubmenu:r,closeSubmenu:l,close:o}=e,[a]=i.useState(s==null?void 0:s.length),c=i.useMemo(()=>s[a]===n,[s,n,a]),[p,b]=i.useState(null),d=i.useCallback((g=null)=>{b(g),r(n,a)},[r,a,n]),$=i.useCallback(()=>{b(null),l(n,a)},[l,a,n]),y=i.useCallback((g=null)=>{b(g),c?$():d(g)},[$,d,c]);return i.useMemo(()=>({focusStrategy:p,isOpen:c,open:d,close:$,closeAll:o,submenuLevel:a,setOpen:()=>{},toggle:y}),[c,d,$,o,p,y,a])}class Pt{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);return n?n.prevKey:null}getKeyAfter(e){let n=this.keyMap.get(e);return n?n.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}constructor(e,{expandedKeys:n}={}){this.keyMap=new Map,this.iterable=e,n=n||new Set;let s=o=>{if(this.keyMap.set(o.key,o),o.childNodes&&(o.type==="section"||n.has(o.key)))for(let a of o.childNodes)s(a)};for(let o of e)s(o);let r,l=0;for(let[o,a]of this.keyMap)r?(r.nextKey=o,a.prevKey=r.key):(this.firstKey=o,a.prevKey=void 0),a.type==="item"&&(a.index=l++),r=a,r.nextKey=void 0;this.lastKey=r==null?void 0:r.key}}function xt(t){let{onExpandedChange:e}=t,[n,s]=st(t.expandedKeys?new Set(t.expandedKeys):void 0,t.defaultExpandedKeys?new Set(t.defaultExpandedKeys):new Set,e),r=Oe(t),l=i.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),o=De(t,i.useCallback(c=>new Pt(c,{expandedKeys:n}),[n]),null);return i.useEffect(()=>{r.focusedKey!=null&&!o.getItem(r.focusedKey)&&r.setFocusedKey(null)},[o,r.focusedKey]),{collection:o,expandedKeys:n,disabledKeys:l,toggleKey:c=>{s(Mt(n,c))},setExpandedKeys:s,selectionManager:new Fe(o,r)}}function Mt(t,e){let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}const be=i.createContext({}),G=i.createContext(null),_=i.createContext(null),J=i.createContext(null);function cn(t){let e=vt(t),n=i.useRef(null),{menuTriggerProps:s,menuProps:r}=_e({...t,type:"menu"},e,n),[l,o]=i.useState(null),a=i.useCallback(()=>{n.current&&o(n.current.offsetWidth+"px")},[n]);return ce({ref:n,onResize:a}),u.createElement(H,{values:[[G,r],[le,e],[J,e],[F,{trigger:"MenuTrigger",triggerRef:n,placement:"bottom start",style:{"--trigger-width":l}}]]},u.createElement(ze,{...s,ref:n,isPressed:e.isOpen},t.children))}function me(t){let{item:e,parentMenuRef:n}=t,s=i.useContext(_);return Y({items:s.collection.getChildren(e.key),children:l=>{switch(l.type){case"item":return u.createElement(wt,{item:l,popover:e.rendered[1],parentMenuRef:n,delay:e.props.delay});default:throw new Error("Unsupported element type in SubmenuTrigger: "+e.type)}}})}function St(t,e){[t,e]=Le(t,e,G);let{portal:n,collection:s}=Be(t);return u.createElement(u.Fragment,null,s.size>0&&u.createElement(Et,{props:t,collection:s,menuRef:e}),n)}function Et({props:t,collection:e,menuRef:n}){let s=xt({...t,collection:e,children:void 0}),[r,l]=i.useState(null),{menuProps:o}=pt(t,s,n),a=i.useContext(J),c=i.useContext(F),p=Y({items:s.collection,children:m=>{switch(m.type){case"section":return u.createElement(kt,{section:m,parentMenuRef:n});case"separator":return u.createElement(je,m.props);case"item":return u.createElement($e,{item:m});case"submenutrigger":return u.createElement(me,{item:m,parentMenuRef:n});default:throw new Error("Unsupported node type in Menu: "+m.type)}}}),b=(c==null?void 0:c.trigger)==="SubmenuTrigger";Xe({ref:n,onInteractOutside:m=>{a&&!(r!=null&&r.contains(m.target))&&a.close()},isDisabled:b||(a==null?void 0:a.expandedKeysStack.length)===0});let d=i.useRef(null),[$,y]=i.useState({left:0});i.useEffect(()=>{if(r&&d.current!==r&&$.left===0){d.current=r;let{left:m}=r.getBoundingClientRect();y({left:-1*m})}},[$,r]);var g;return u.createElement(at,null,u.createElement("div",{...U(t),...o,ref:n,slot:t.slot||void 0,onScroll:t.onScroll,style:t.style,className:(g=t.className)!==null&&g!==void 0?g:"react-aria-Menu"},u.createElement(H,{values:[[_,s],[Ye,{elementType:"div"}],[F,{UNSTABLE_portalContainer:r||void 0}]]},p)),u.createElement("div",{ref:l,style:{width:"100vw",position:"absolute",top:0,...$}}))}const Ct=i.forwardRef(St);function kt({section:t,className:e,style:n,parentMenuRef:s,...r}){var l,o;let a=i.useContext(_),[c,p]=Ue();var b;let{headingProps:d,groupProps:$}=bt({heading:p,"aria-label":(b=t["aria-label"])!==null&&b!==void 0?b:void 0}),y=Y({items:a.collection.getChildren(t.key),children:g=>{switch(g.type){case"header":{let{ref:m,...k}=g.props;return u.createElement(Ae,{...d,...k,ref:Ve(c,m)},g.rendered)}case"item":return u.createElement($e,{item:g});case"submenutrigger":return u.createElement(me,{item:g,parentMenuRef:s});default:throw new Error("Unsupported element type in Section: "+g.type)}}});return u.createElement("section",{...U(r),...$,className:e||((l=t.props)===null||l===void 0?void 0:l.className)||"react-aria-Section",style:n||((o=t.props)===null||o===void 0?void 0:o.style),ref:t.props.ref},y)}function Kt(t,e){return He("item",t,e,t.children)}const Tt=i.forwardRef(Kt);function $e({item:t}){var e;let n=i.useContext(_),s=se(t.props.ref),{menuItemProps:r,labelProps:l,descriptionProps:o,keyboardShortcutProps:a,...c}=pe({key:t.key,"aria-label":(e=t.props)===null||e===void 0?void 0:e["aria-label"]},n,s),p=t.props,{isFocusVisible:b,focusProps:d}=ue(),{hoverProps:$,isHovered:y}=q({isDisabled:c.isDisabled,onHoverStart:t.props.onHoverStart,onHoverChange:t.props.onHoverChange,onHoverEnd:t.props.onHoverEnd}),g=ae({...p,id:void 0,children:t.rendered,defaultClassName:"react-aria-MenuItem",values:{...c,isHovered:y,isFocusVisible:b,selectionMode:n.selectionManager.selectionMode,selectionBehavior:n.selectionManager.selectionBehavior,hasSubmenu:!1,isOpen:!1}}),m=p.href?"a":"div";return u.createElement(m,{...L(r,d,$),...g,ref:s,"data-disabled":c.isDisabled||void 0,"data-hovered":y||void 0,"data-focused":c.isFocused||void 0,"data-focus-visible":b||void 0,"data-pressed":c.isPressed||void 0,"data-selected":c.isSelected||void 0,"data-selection-mode":n.selectionManager.selectionMode==="none"?void 0:n.selectionManager.selectionMode},u.createElement(H,{values:[[ie,{slots:{label:l,description:o}}],[be,a]]},g.children))}function wt({item:t,popover:e,parentMenuRef:n,delay:s}){let r=i.useContext(_),l=We(F),o=se(t.props.ref),a=i.useContext(J),c=ht({triggerKey:t.key},a),p=i.useRef(null),{submenuTriggerProps:b,submenuProps:d,popoverProps:$}=yt({node:t,parentMenuRef:n,submenuRef:p,delay:s},c,o),{menuItemProps:y,labelProps:g,descriptionProps:m,keyboardShortcutProps:k,...S}=pe({key:t.key,...b},r,o),E=t.props,{hoverProps:K,isHovered:P}=q({isDisabled:S.isDisabled}),{isFocusVisible:C,focusProps:v}=ue(),x=ae({...E,id:void 0,children:t.rendered,defaultClassName:"react-aria-MenuItem",values:{...S,isHovered:P,isFocusVisible:C,selectionMode:r.selectionManager.selectionMode,selectionBehavior:r.selectionManager.selectionBehavior,hasSubmenu:!0,isOpen:c.isOpen}});return u.createElement(H,{values:[[ie,{slots:{label:g,description:m}}],[be,k],[G,d],[le,c],[F,{ref:p,trigger:"SubmenuTrigger",triggerRef:o,placement:"end top",UNSTABLE_portalContainer:l.UNSTABLE_portalContainer||void 0,...$}]]},u.createElement("div",{...L(y,v,K),...x,ref:o,"data-disabled":S.isDisabled||void 0,"data-hovered":P||void 0,"data-focused":S.isFocused||void 0,"data-focus-visible":C||void 0,"data-pressed":S.isPressed||void 0,"data-selected":S.isSelected||void 0,"data-selection-mode":r.selectionManager.selectionMode==="none"?void 0:r.selectionManager.selectionMode,"data-has-submenu":!0,"data-open":c.isOpen||void 0},x.children),e)}const It="flow--context-menu",Rt={contextMenu:It},ge=oe("ContextMenu",t=>{const{children:e,onAction:n,selectionMode:s,selectedKeys:r,defaultSelectedKeys:l,disabledKeys:o,onSelectionChange:a,refProp:c,...p}=t,b=s==="navigation"?"single":s,d={MenuItem:{selectionVariant:s==="navigation"?"navigation":"control"}};return u.createElement(Te,null,u.createElement(Ne,{...p},u.createElement(Ct,{className:Rt.contextMenu,onAction:n,selectionMode:b,selectedKeys:r,defaultSelectedKeys:l,disabledKeys:o,onSelectionChange:a,ref:c},u.createElement(X,{props:d},e))))});ge.__docgenInfo={description:"",methods:[],displayName:"ContextMenu"};const Ot="flow--menu-item",Dt="flow--menu-item--icon",Ft="flow--menu-item--text",_t="flow--menu-item--control-icon",D={menuItem:Ot,icon:Dt,text:Ft,controlIcon:_t},At=(t,e)=>!!dt(t,e),ye=t=>{const{selectionMode:e,isSelected:n,selectionVariant:s="control",children:r}=t,l={Icon:{className:D.icon},Text:{className:D.text}},o={Icon:{className:de(D.controlIcon,D.icon)}},a=e==="none"||s==="navigation"?null:e==="single"&&n?u.createElement(lt,null):e==="single"&&!n?u.createElement(it,null):e==="multiple"&&n?u.createElement(ct,null):u.createElement(ut,null),c=At(r,ne);return u.createElement(u.Fragment,null,u.createElement(X,{props:o},a),u.createElement(X,{props:l},u.createElement(ft,{if:!c},u.createElement(ne,null,r))))};ye.__docgenInfo={description:"",methods:[],displayName:"MenuItemContent",props:{selectionVariant:{required:!1,tsType:{name:"union",raw:'"control" | "navigation"',elements:[{name:"literal",value:'"control"'},{name:"literal",value:'"navigation"'}]},description:""}},composes:["PropsWithChildren"]};const ve=oe("MenuItem",t=>{const{children:e,className:n,selectionVariant:s,refProp:r,...l}=t,o=de(D.menuItem,n);return u.createElement(Tt,{...l,className:o,ref:r},a=>u.createElement(ye,{...a,selectionVariant:s},e))});ve.__docgenInfo={description:"",methods:[],displayName:"MenuItem"};ve.__docgenInfo={description:"",methods:[],displayName:"MenuItem"};ge.__docgenInfo={description:"",methods:[],displayName:"ContextMenu"};export{cn as $,ge as C,ve as M};
