import{c as Y}from"./mergeRefs-B22Il0iz.js";import{r as ce}from"./index-_FZDHFZo.js";import{r as S}from"./index-CXcpQZ5J.js";import{t as se}from"./useFocus-Beyq6_MT.js";import{a as q}from"./ProgressBar-DfZ38-9l.js";import{a as fe}from"./useLocalizedStringFormatter-PBUSZsmh.js";import{$ as de}from"./useControlledState-CHe-wEx1.js";function ue(){return typeof window.ResizeObserver<"u"}function K(t){const{ref:e,box:o,onResize:n}=t;S.useEffect(()=>{let l=e==null?void 0:e.current;if(l)if(ue()){const r=new window.ResizeObserver(c=>{c.length&&n()});return r.observe(l,{box:o}),()=>{l&&r.unobserve(l)}}else return window.addEventListener("resize",n,!1),()=>{window.removeEventListener("resize",n,!1)}},[n,e,o])}function Ie(t,e=!0){let[o,n]=S.useState(!0),l=o&&e;return Y(()=>{if(l&&t.current&&"getAnimations"in t.current)for(let r of t.current.getAnimations())r instanceof CSSTransition&&r.cancel()},[t,l]),le(t,l,S.useCallback(()=>n(!1),[])),l}function Ae(t,e){let[o,n]=S.useState(e?"open":"closed");switch(o){case"open":e||n("exiting");break;case"closed":case"exiting":e&&n("open");break}let l=o==="exiting";return le(t,l,S.useCallback(()=>{n(r=>r==="exiting"?"closed":r)},[])),l}function le(t,e,o){Y(()=>{if(e&&t.current){if(!("getAnimations"in t.current)){o();return}let n=t.current.getAnimations();if(n.length===0){o();return}let l=!1;return Promise.all(n.map(r=>r.finished)).then(()=>{l||ce.flushSync(()=>{o()})}).catch(()=>{}),()=>{l=!0}}},[t,e,o])}const k={top:"top",bottom:"top",left:"left",right:"left"},Z={top:"bottom",bottom:"top",left:"right",right:"left"},pe={top:"left",left:"top"},J={top:"height",left:"width"},oe={width:"totalWidth",height:"totalHeight"},X={};let C=typeof document<"u"?window.visualViewport:null;function Q(t){let e=0,o=0,n=0,l=0,r=0,c=0,i={};var $;let f=(($=C==null?void 0:C.scale)!==null&&$!==void 0?$:1)>1;if(t.tagName==="BODY"){let d=document.documentElement;n=d.clientWidth,l=d.clientHeight;var u;e=(u=C==null?void 0:C.width)!==null&&u!==void 0?u:n;var g;o=(g=C==null?void 0:C.height)!==null&&g!==void 0?g:l,i.top=d.scrollTop||t.scrollTop,i.left=d.scrollLeft||t.scrollLeft,C&&(r=C.offsetTop,c=C.offsetLeft)}else({width:e,height:o,top:r,left:c}=B(t)),i.top=t.scrollTop,i.left=t.scrollLeft,n=e,l=o;if(se()&&(t.tagName==="BODY"||t.tagName==="HTML")&&f){i.top=0,i.left=0;var p;r=(p=C==null?void 0:C.pageTop)!==null&&p!==void 0?p:0;var a;c=(a=C==null?void 0:C.pageLeft)!==null&&a!==void 0?a:0}return{width:e,height:o,totalWidth:n,totalHeight:l,scroll:i,top:r,left:c}}function me(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function W(t,e,o,n,l,r,c){var i;let $=(i=l.scroll[t])!==null&&i!==void 0?i:0,f=n[J[t]],u=n.scroll[k[t]]+r,g=f+n.scroll[k[t]]-r,p=e-$+c[t]-n[k[t]],a=e-$+o+c[t]-n[k[t]];return p<u?u-p:a>g?Math.max(g-a,u-p):0}function ve(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function D(t){if(X[t])return X[t];let[e,o]=t.split(" "),n=k[e]||"right",l=pe[n];k[o]||(o="center");let r=J[n],c=J[l];return X[t]={placement:e,crossPlacement:o,axis:n,crossAxis:l,size:r,crossSize:c},X[t]}function G(t,e,o,n,l,r,c,i,$,f){let{placement:u,crossPlacement:g,axis:p,crossAxis:a,size:d,crossSize:h}=n,s={};var m;s[a]=(m=t[a])!==null&&m!==void 0?m:0;var v,E,R,P;g==="center"?s[a]+=(((v=t[h])!==null&&v!==void 0?v:0)-((E=o[h])!==null&&E!==void 0?E:0))/2:g!==a&&(s[a]+=((R=t[h])!==null&&R!==void 0?R:0)-((P=o[h])!==null&&P!==void 0?P:0)),s[a]+=r;const b=t[a]-o[h]+$+f,I=t[a]+t[h]-$-f;if(s[a]=q(s[a],b,I),u===p){const A=i?c[d]:e[oe[d]];s[Z[p]]=Math.floor(A-t[p]+l)}else s[p]=Math.floor(t[p]+t[d]+l);return s}function ge(t,e,o,n,l,r,c,i){const $=n?o.height:e[oe.height];var f;let u=t.top!=null?o.top+t.top:o.top+($-((f=t.bottom)!==null&&f!==void 0?f:0)-c);var g,p,a,d,h,s;let m=i!=="top"?Math.max(0,e.height+e.top+((g=e.scroll.top)!==null&&g!==void 0?g:0)-u-(((p=l.top)!==null&&p!==void 0?p:0)+((a=l.bottom)!==null&&a!==void 0?a:0)+r)):Math.max(0,u+c-(e.top+((d=e.scroll.top)!==null&&d!==void 0?d:0))-(((h=l.top)!==null&&h!==void 0?h:0)+((s=l.bottom)!==null&&s!==void 0?s:0)+r));return Math.min(e.height-r*2,m)}function V(t,e,o,n,l,r){let{placement:c,axis:i,size:$}=r;var f,u;if(c===i)return Math.max(0,o[i]-t[i]-((f=t.scroll[i])!==null&&f!==void 0?f:0)+e[i]-((u=n[i])!==null&&u!==void 0?u:0)-n[Z[i]]-l);var g;return Math.max(0,t[$]+t[i]+t.scroll[i]-e[i]-o[i]-o[$]-((g=n[i])!==null&&g!==void 0?g:0)-n[Z[i]]-l)}function $e(t,e,o,n,l,r,c,i,$,f,u,g,p,a,d,h){let s=D(t),{size:m,crossAxis:v,crossSize:E,placement:R,crossPlacement:P}=s,b=G(e,i,o,s,u,g,f,p,d,h),I=u,A=V(i,f,e,l,r+u,s);if(c&&n[m]>A){let j=D(`${Z[R]} ${P}`),ae=G(e,i,o,j,u,g,f,p,d,h);V(i,f,e,l,r+u,j)>A&&(s=j,b=ae,I=u)}let H="bottom";s.axis==="top"?s.placement==="top"?H="top":s.placement==="bottom"&&(H="bottom"):s.crossAxis==="top"&&(s.crossPlacement==="top"?H="bottom":s.crossPlacement==="bottom"&&(H="top"));let w=W(v,b[v],o[E],i,$,r,f);b[v]+=w;let T=ge(b,i,f,p,l,r,o.height,H);a&&a<T&&(T=a),o.height=Math.min(o.height,T),b=G(e,i,o,s,I,g,f,p,d,h),w=W(v,b[v],o[E],i,$,r,f),b[v]+=w;let z={},y=e[v]+.5*e[E]-b[v]-l[k[v]];const _=d/2+h;var O,N,M,L;const F=k[v]==="left"?((O=l.left)!==null&&O!==void 0?O:0)+((N=l.right)!==null&&N!==void 0?N:0):((M=l.top)!==null&&M!==void 0?M:0)+((L=l.bottom)!==null&&L!==void 0?L:0),U=o[E]-F-d/2-h,ne=e[v]+d/2-(b[v]+l[k[v]]),re=e[v]+e[E]-d/2-(b[v]+l[k[v]]),ie=q(y,ne,re);return z[v]=q(ie,_,U),{position:b,maxHeight:T,arrowOffsetLeft:z.left,arrowOffsetTop:z.top,placement:s.placement}}function he(t){let{placement:e,targetNode:o,overlayNode:n,scrollNode:l,padding:r,shouldFlip:c,boundaryElement:i,offset:$,crossOffset:f,maxHeight:u,arrowSize:g=0,arrowBoundaryOffset:p=0}=t,a=n instanceof HTMLElement?be(n):document.documentElement,d=a===document.documentElement;const h=window.getComputedStyle(a).position;let s=!!h&&h!=="static",m=d?B(o):ee(o,a);if(!d){let{marginTop:z,marginLeft:y}=window.getComputedStyle(o);m.top+=parseInt(z,10)||0,m.left+=parseInt(y,10)||0}let v=B(n),E=ve(n);var R,P;v.width+=((R=E.left)!==null&&R!==void 0?R:0)+((P=E.right)!==null&&P!==void 0?P:0);var b,I;v.height+=((b=E.top)!==null&&b!==void 0?b:0)+((I=E.bottom)!==null&&I!==void 0?I:0);let A=me(l),H=Q(i),w=Q(a),T=i.tagName==="BODY"?B(a):ee(a,i);return a.tagName==="HTML"&&i.tagName==="BODY"&&(w.scroll.top=0,w.scroll.left=0),$e(e,m,v,A,E,r,c,H,w,T,$,f,s,u,g,p)}function B(t){let{top:e,left:o,width:n,height:l}=t.getBoundingClientRect(),{scrollTop:r,scrollLeft:c,clientTop:i,clientLeft:$}=document.documentElement;return{top:e+r-i,left:o+c-$,width:n,height:l}}function ee(t,e){let o=window.getComputedStyle(t),n;if(o.position==="fixed"){let{top:l,left:r,width:c,height:i}=t.getBoundingClientRect();n={top:l,left:r,width:c,height:i}}else{n=B(t);let l=B(e),r=window.getComputedStyle(e);l.top+=(parseInt(r.borderTopWidth,10)||0)-e.scrollTop,l.left+=(parseInt(r.borderLeftWidth,10)||0)-e.scrollLeft,n.top-=l.top,n.left-=l.left}return n.top-=parseInt(o.marginTop,10)||0,n.left-=parseInt(o.marginLeft,10)||0,n}function be(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!te(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!te(e);)e=e.parentElement;return e||document.documentElement}function te(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const xe=new WeakMap;function we(t){let{triggerRef:e,isOpen:o,onClose:n}=t;S.useEffect(()=>{if(!o||n===null)return;let l=r=>{let c=r.target;if(!e.current||c instanceof Node&&!c.contains(e.current)||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement)return;let i=n||xe.get(e.current);i&&i()};return window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("scroll",l,!0)}},[o,n,e])}let x=typeof document<"u"?window.visualViewport:null;function Me(t){let{direction:e}=fe(),{arrowSize:o=0,targetRef:n,overlayRef:l,scrollRef:r=l,placement:c="bottom",containerPadding:i=12,shouldFlip:$=!0,boundaryElement:f=typeof document<"u"?document.body:null,offset:u=0,crossOffset:g=0,shouldUpdatePosition:p=!0,isOpen:a=!0,onClose:d,maxHeight:h,arrowBoundaryOffset:s=0}=t,[m,v]=S.useState(null),E=[p,c,l.current,n.current,r.current,i,$,f,u,g,a,e,h,s,o],R=S.useRef(x==null?void 0:x.scale);S.useEffect(()=>{a&&(R.current=x==null?void 0:x.scale)},[a]);let P=S.useCallback(()=>{if(p===!1||!a||!l.current||!n.current||!f||(x==null?void 0:x.scale)!==R.current)return;let w=null;if(r.current&&r.current.contains(document.activeElement)){var T;let L=(T=document.activeElement)===null||T===void 0?void 0:T.getBoundingClientRect(),F=r.current.getBoundingClientRect();var z;if(w={type:"top",offset:((z=L==null?void 0:L.top)!==null&&z!==void 0?z:0)-F.top},w.offset>F.height/2){w.type="bottom";var y;w.offset=((y=L==null?void 0:L.bottom)!==null&&y!==void 0?y:0)-F.bottom}}let _=l.current;if(!h&&l.current){var O;_.style.top="0px",_.style.bottom="";var N;_.style.maxHeight=((N=(O=window.visualViewport)===null||O===void 0?void 0:O.height)!==null&&N!==void 0?N:window.innerHeight)+"px"}let M=he({placement:Ce(c,e),overlayNode:l.current,targetNode:n.current,scrollNode:r.current||l.current,padding:i,shouldFlip:$,boundaryElement:f,offset:u,crossOffset:g,maxHeight:h,arrowSize:o,arrowBoundaryOffset:s});if(M.position){if(_.style.top="",_.style.bottom="",_.style.left="",_.style.right="",Object.keys(M.position).forEach(L=>_.style[L]=M.position[L]+"px"),_.style.maxHeight=M.maxHeight!=null?M.maxHeight+"px":"",w&&document.activeElement&&r.current){let L=document.activeElement.getBoundingClientRect(),F=r.current.getBoundingClientRect(),U=L[w.type]-F[w.type];r.current.scrollTop+=U-w.offset}v(M)}},E);Y(P,E),Ee(P),K({ref:l,onResize:P}),K({ref:n,onResize:P});let b=S.useRef(!1);Y(()=>{let w,T=()=>{b.current=!0,clearTimeout(w),w=setTimeout(()=>{b.current=!1},500),P()},z=()=>{b.current&&T()};return x==null||x.addEventListener("resize",T),x==null||x.addEventListener("scroll",z),()=>{x==null||x.removeEventListener("resize",T),x==null||x.removeEventListener("scroll",z)}},[P]);let I=S.useCallback(()=>{b.current||d==null||d()},[d,b]);we({triggerRef:n,isOpen:a,onClose:d&&I});var A,H;return{overlayProps:{style:{position:"absolute",zIndex:1e5,...m==null?void 0:m.position,maxHeight:(A=m==null?void 0:m.maxHeight)!==null&&A!==void 0?A:"100vh"}},placement:(H=m==null?void 0:m.placement)!==null&&H!==void 0?H:null,arrowProps:{"aria-hidden":"true",role:"presentation",style:{left:m==null?void 0:m.arrowOffsetLeft,top:m==null?void 0:m.arrowOffsetTop}},updatePosition:P}}function Ee(t){Y(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function Ce(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}function ke(t){let[e,o]=de(t.isOpen,t.defaultOpen||!1,t.onOpenChange);const n=S.useCallback(()=>{o(!0)},[o]),l=S.useCallback(()=>{o(!1)},[o]),r=S.useCallback(()=>{o(!e)},[o,e]);return{isOpen:e,setOpen:o,open:n,close:l,toggle:r}}export{ke as $,Ae as a,Ie as b,K as c,Me as d,xe as e};
