import{j as r,r as E}from"./iframe-DvGStSYQ.js";import{M as R}from"./Markdown-DqXHrP8l.js";import{T as B}from"./TextArea-BRMbRF0g.js";import{O as k,K as T,P as O,Q as C,R as F}from"./IconWarning-PCMncW0h.js";import{B as S}from"./Button-DjKTL3-y.js";import{$ as I}from"./useLocalizedStringFormatter-B959dniX.js";import{c as H}from"./clsx-B-dksMZM.js";import{f as z}from"./PropsContextProvider-CQyMUqli.js";import{a as P}from"./mergeRefs-D5I-7zq8.js";/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],K=k("outline","bold","Bold",U);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],W=k("outline","italic","Italic",Q);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],Z=k("outline","list-numbers","ListNumbers",V);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],J=k("outline","strikethrough","Strikethrough",G);/**
 * @license @tabler/icons-react v3.34.1 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Y=k("filled","quote-filled","QuoteFilled",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",ne="flow--markdown-editor--toolbar-buttons",oe="flow--markdown-editor--mode-button",se="flow--markdown-editor--markdown",w={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:ne,modeButton:oe,markdown:se},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},$=(e,h)=>{const i=e.lastIndexOf(`
`,h-1);return i===-1?0:i+1},q=(e,h)=>{const i=e.indexOf(`
`,h);return i===-1?e.length:i},ie=(e,h,i,m,d)=>{const p=i.current;if(!p)return;const{before:a,after:f="",toggleable:y=!1}=re[m],t=p.selectionStart,g=p.selectionEnd,s=e.substring(t,g),x=s.split(`
`);let c=e,o=t,u=g;if(m==="code"&&s.includes(`
`))c=e.substring(0,t)+"```\n"+s+"\n```\n"+e.substring(g),o=t+4,u=o+s.length;else if(m==="orderedList")if(s){const n=x.map((l,b)=>`${b+1}. ${l}`).join(`
`);c=e.substring(0,t)+n+e.substring(g),o=t,u=t+n.length}else{const n=$(e,t),l=q(e,t),b=`1. ${e.substring(n,l)}`;c=e.substring(0,n)+a+e.substring(n),o=n+b.length,u=o}else if(m==="unorderedList")if(s){const n=x.map(l=>`${a}${l}`).join(`
`);c=e.substring(0,t)+n+e.substring(g),o=t,u=t+n.length}else{const n=$(e,t),l=q(e,t),b=`- ${e.substring(n,l)}`;c=e.substring(0,n)+a+e.substring(n),o=n+b.length,u=o}else if(m==="quote")if(s){const n=x.map(l=>`${a}${l}`).join(`
`);c=e.substring(0,t)+n+e.substring(g),o=t,u=t+n.length}else{const n=`
${a} `;c=e.substring(0,t)+n+e.substring(g),o=t+n.length,u=o}else if(y){const n=e.substring(t-a.length,t),l=e.substring(g,g+f.length),b=n===a&&l===f,M=s.startsWith(a)&&s.endsWith(f);if(b)c=e.substring(0,t-a.length)+s+e.substring(g+f.length),o=t-a.length,u=o+s.length;else if(M){const j=s.slice(a.length,s.length-f.length);c=e.substring(0,t)+j+e.substring(g),o=t,u=t+j.length}else c=e.substring(0,t)+a+s+f+e.substring(g),s.length===0?(o=t+a.length,u=o):(o=t+a.length,u=o+s.length)}else if(m==="link"){let n="",l="",b="",M=0;s?(A=>{try{return new URL(A),!0}catch{return!1}})(s)?(l=s,b=`[](${l})`,M=t+1):(n=s,b=`[${n}]()`,M=t+b.indexOf("](")+2):(b="[](https://)",M=t+1),c=e.substring(0,t)+b+e.substring(g),o=u=M}else c=e.substring(0,t)+a+s+f+e.substring(g),s.length===0?(o=t+a.length,u=o):(o=t+a.length,u=o+s.length);h(c),d&&d(c),requestAnimationFrame(()=>{p.setSelectionRange(o,u),p.focus()})},N={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},v=e=>{const{markdown:h,setMarkdown:i,textAreaRef:m,children:d,isDisabled:p,type:a,onChange:f,mode:y}=e,t=I(N);return r.jsx(S,{isDisabled:p||y==="preview","aria-label":t.format(`toolbar.${a}`),size:"s",variant:"plain",color:"dark",onPress:()=>ie(h,i,m,a,f),children:d})};v.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},type:{required:!0,tsType:{name:"InsertType"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""}},composes:["PropsWithChildren"]};const _=e=>{const{setMode:h,mode:i,isDisabled:m}=e,d=I(N),p=i==="editor"?"preview":"editor";return r.jsx(S,{isDisabled:m,className:w.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>h(p),children:d.format(`mode.${p}`)})};_.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""}}};const D=e=>{const{setMode:h,...i}=e;return r.jsxs("header",{className:w.toolbar,role:"toolbar",children:[r.jsxs("div",{className:w.toolbarButtons,children:[r.jsx(v,{...i,type:"bold",children:r.jsx(T,{children:r.jsx(K,{})})}),r.jsx(v,{...i,type:"italic",children:r.jsx(T,{children:r.jsx(W,{})})}),r.jsx(v,{...i,type:"strikeThrough",children:r.jsx(T,{children:r.jsx(J,{})})}),r.jsx(v,{...i,type:"quote",children:r.jsx(T,{children:r.jsx(Y,{})})}),r.jsx(v,{...i,type:"code",children:r.jsx(O,{})}),r.jsx(v,{...i,type:"link",children:r.jsx(C,{})}),r.jsx(v,{...i,type:"unorderedList",children:r.jsx(T,{children:r.jsx(F,{})})}),r.jsx(v,{...i,type:"orderedList",children:r.jsx(T,{children:r.jsx(Z,{})})})]}),r.jsx(_,{setMode:h,mode:e.mode,isDisabled:e.isDisabled})]})};D.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{markdown:{required:!0,tsType:{name:"string"},description:""},setMarkdown:{required:!0,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""},textAreaRef:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLTextAreaElement | null",elements:[{name:"HTMLTextAreaElement"},{name:"null"}]}],raw:"RefObject<HTMLTextAreaElement | null>"},description:""},setMode:{required:!0,tsType:{name:"signature",type:"function",raw:"(mode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"mode"}],return:{name:"void"}}},description:""},mode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},isDisabled:{required:!1,tsType:{name:"boolean"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(markdown: string) => void",signature:{arguments:[{type:{name:"string"},name:"markdown"}],return:{name:"void"}}},description:""}}};const L=e=>{const{selectionStart:h}=e,i=parseInt(getComputedStyle(e).lineHeight||"20",10),m=e.value.slice(0,h).split(`
`).length;e.scrollTop=(m-1)*i},ae=(e,h,i,m)=>{if(e.key!=="Enter")return;const d=h.current;if(!d)return;const p=d.selectionStart,a=d.selectionEnd,f=d.value,y=f.slice(0,p),t=f.slice(a),g=y.lastIndexOf(`
`)+1,s=y.slice(g),x=s.match(/^(\s*)(\d+)\.\s+/),c=s.match(/^(\s*)([-*+])\s+/);if((x||c)&&s.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const o=f.slice(0,g)+`
`+t;i(o),m&&m(o),requestAnimationFrame(()=>{d.selectionStart=d.selectionEnd=g+1,L(d)});return}if(x){e.preventDefault();const o=x[1],u=parseInt(x[2]??"",10)+1,n=`
${o}${u}. `,l=y+n+t;i(l),m&&m(l),requestAnimationFrame(()=>{d.selectionStart=d.selectionEnd=p+n.length,L(d)})}else if(c){e.preventDefault();const o=c[1],u=c[2],n=`
${o}${u} `,l=y+n+t;i(l),m&&m(l),requestAnimationFrame(()=>{d.selectionStart=d.selectionEnd=p+n.length,L(d)})}},le=z("MarkdownEditor",e=>{const{isDisabled:h,children:i,className:m,value:d,onChange:p,rows:a,autoResizeMaxRows:f,headingOffset:y,ref:t,...g}=e,[s,x]=E.useState(d??""),[c,o]=E.useState("editor"),u=E.useRef(null),n=H(w.markdownEditor,m,w[`mode-${c}`]);return r.jsxs(B,{...g,isDisabled:h||c==="preview",className:n,ref:P(u,t),value:d!==void 0?d:s,rows:a,autoResizeMaxRows:f,onChange:l=>{p&&p(l),x(l)},onKeyDown:l=>ae(l,u,x,p),children:[r.jsx(D,{markdown:s,setMarkdown:x,textAreaRef:u,setMode:o,mode:c,isDisabled:h,onChange:p}),r.jsx(R,{headingOffset:y,className:w.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${f??a} + (var(--form-control--padding-y) * 2))`},children:s}),i]})});le.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{le as M};
