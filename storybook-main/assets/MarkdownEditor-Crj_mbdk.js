import{j as i,r as _}from"./iframe-FESji9AM.js";import{M as q}from"./Markdown-J8ygga57.js";import{T as C}from"./TextArea-DdPWGtsN.js";import{O as T,K as v,P as D,Q as O,R}from"./IconWarning-BN848dMt.js";import{B as E}from"./Button-BAxmgeRc.js";import{$ as I}from"./useLocalizedStringFormatter-CqB2I62z.js";import{c as F}from"./clsx-B-dksMZM.js";import{f as A}from"./flowComponent-DFQAJ_2B.js";import{b as z}from"./utils-C8mGBIgx.js";import{u as U}from"./useManagedValue-DIWxKMPy.js";/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M7 5h6a3.5 3.5 0 0 1 0 7h-6z",key:"svg-0"}],["path",{d:"M13 12h1a3.5 3.5 0 0 1 0 7h-7v-7",key:"svg-1"}]],Q=T("outline","bold","Bold",K);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M11 5l6 0",key:"svg-0"}],["path",{d:"M7 19l6 0",key:"svg-1"}],["path",{d:"M14 5l-4 14",key:"svg-2"}]],H=T("outline","italic","Italic",V);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11 6h9",key:"svg-0"}],["path",{d:"M11 12h9",key:"svg-1"}],["path",{d:"M12 18h8",key:"svg-2"}],["path",{d:"M4 16a2 2 0 1 1 4 0c0 .591 -.5 1 -1 1.5l-3 2.5h4",key:"svg-3"}],["path",{d:"M6 10v-6l-2 2",key:"svg-4"}]],Z=T("outline","list-numbers","ListNumbers",W);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M16 6.5a4 2 0 0 0 -4 -1.5h-1a3.5 3.5 0 0 0 0 7h2a3.5 3.5 0 0 1 0 7h-1.5a4 2 0 0 1 -4 -1.5",key:"svg-1"}]],J=T("outline","strikethrough","Strikethrough",G);/**
 * @license @tabler/icons-react v3.35.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M9 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-0"}],["path",{d:"M18 5a2 2 0 0 1 2 2v6c0 3.13 -1.65 5.193 -4.757 5.97a1 1 0 1 1 -.486 -1.94c2.227 -.557 3.243 -1.827 3.243 -4.03v-1h-3a2 2 0 0 1 -1.995 -1.85l-.005 -.15v-3a2 2 0 0 1 2 -2z",key:"svg-1"}]],Y=T("filled","quote-filled","QuoteFilled",X),ee="flow--markdown-editor",te="flow--markdown-editor--toolbar",oe="flow--markdown-editor--toolbar-buttons",se="flow--markdown-editor--mode-button",ne="flow--markdown-editor--markdown",j={markdownEditor:ee,"mode-editor":"flow--markdown-editor--mode-editor","mode-preview":"flow--markdown-editor--mode-preview",toolbar:te,toolbarButtons:oe,modeButton:se,markdown:ne},re={bold:{before:"**",after:"**",toggleable:!0},italic:{before:"_",after:"_",toggleable:!0},strikeThrough:{before:"~~",after:"~~",toggleable:!0},quote:{before:"> "},code:{before:"`",after:"`",toggleable:!0},link:{before:"[",after:"](https://)"},unorderedList:{before:"- "},orderedList:{before:"1. "}},k=(e,d)=>{const u=e.lastIndexOf(`
`,d-1);return u===-1?0:u+1},B=(e,d)=>{const u=e.indexOf(`
`,d);return u===-1?e.length:u},ie=(e,d,u,r)=>{const b=u.current;if(!b)return;const{before:l,after:p="",toggleable:y=!1}=re[r],t=b.selectionStart,g=b.selectionEnd,n=e.substring(t,g),m=n.split(`
`);let h=e,o=t,c=g;if(r==="code"&&n.includes(`
`))h=e.substring(0,t)+"```\n"+n+"\n```\n"+e.substring(g),o=t+4,c=o+n.length;else if(r==="orderedList")if(n){const s=m.map((a,f)=>`${f+1}. ${a}`).join(`
`);h=e.substring(0,t)+s+e.substring(g),o=t,c=t+s.length}else{const s=k(e,t),a=B(e,t),f=`1. ${e.substring(s,a)}`;h=e.substring(0,s)+l+e.substring(s),o=s+f.length,c=o}else if(r==="unorderedList")if(n){const s=m.map(a=>`${l}${a}`).join(`
`);h=e.substring(0,t)+s+e.substring(g),o=t,c=t+s.length}else{const s=k(e,t),a=B(e,t),f=`- ${e.substring(s,a)}`;h=e.substring(0,s)+l+e.substring(s),o=s+f.length,c=o}else if(r==="quote")if(n){const s=m.map(a=>`${l}${a}`).join(`
`);h=e.substring(0,t)+s+e.substring(g),o=t,c=t+s.length}else{const s=`
${l} `;h=e.substring(0,t)+s+e.substring(g),o=t+s.length,c=o}else if(y){const s=e.substring(t-l.length,t),a=e.substring(g,g+p.length),f=s===l&&a===p,M=n.startsWith(l)&&n.endsWith(p);if(f)h=e.substring(0,t-l.length)+n+e.substring(g+p.length),o=t-l.length,c=o+n.length;else if(M){const $=n.slice(l.length,n.length-p.length);h=e.substring(0,t)+$+e.substring(g),o=t,c=t+$.length}else h=e.substring(0,t)+l+n+p+e.substring(g),n.length===0?(o=t+l.length,c=o):(o=t+l.length,c=o+n.length)}else if(r==="link"){let s="",a="",f="",M=0;n?(P=>{try{return new URL(P),!0}catch{return!1}})(n)?(a=n,f=`[](${a})`,M=t+1):(s=n,f=`[${s}]()`,M=t+f.indexOf("](")+2):(f="[](https://)",M=t+1),h=e.substring(0,t)+f+e.substring(g),o=c=M}else h=e.substring(0,t)+l+n+p+e.substring(g),n.length===0?(o=t+l.length,c=o):(o=t+l.length,c=o+n.length);d(h),requestAnimationFrame(()=>{b.setSelectionRange(o,c),b.focus()})},w={"de-DE":{"mode.editor":"Editor","mode.preview":"Vorschau","toolbar.bold":"Fett","toolbar.code":"Code","toolbar.italic":"Kursiv","toolbar.link":"Link","toolbar.orderedList":"Sortierte Liste","toolbar.quote":"Zitat","toolbar.strikeThrough":"Durchgestrichen","toolbar.unorderedList":"Liste"},"en-US":{"mode.editor":"Editor","mode.preview":"Preview","toolbar.bold":"Bold","toolbar.code":"Code","toolbar.italic":"Italic","toolbar.link":"Link","toolbar.orderedList":"Ordered List","toolbar.quote":"Quote","toolbar.strikeThrough":"Strike through","toolbar.unorderedList":"List"}},x=e=>{const{children:d,type:u,onPress:r,...b}=e,l=I(w);return i.jsx(E,{...b,"aria-label":l.format(`toolbar.${u}`),size:"s",variant:"plain",color:"dark",onPress:()=>r==null?void 0:r(u),children:d})};x.__docgenInfo={description:"",methods:[],displayName:"ToolbarButton",props:{type:{required:!0,tsType:{name:"InsertType"},description:""},onPress:{required:!1,tsType:{name:"signature",type:"function",raw:"(type: InsertType) => void",signature:{arguments:[{type:{name:"InsertType"},name:"type"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const S=e=>{const{currentMode:d,onChange:u,...r}=e,b=I(w),l=d==="editor"?"preview":"editor";return i.jsx(E,{className:j.modeButton,size:"s",variant:"plain",color:"dark",onPress:()=>{u==null||u(l)},...r,children:b.format(`mode.${l}`)})};S.__docgenInfo={description:"",methods:[],displayName:"ModeButton",props:{currentMode:{required:!0,tsType:{name:"MarkdownEditorMode"},description:""},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMode: MarkdownEditorMode) => void",signature:{arguments:[{type:{name:"MarkdownEditorMode"},name:"newMode"}],return:{name:"void"}}},description:""}},composes:["Pick"]};const N=e=>{const d={onPress:e.onToolPressed,isDisabled:e.isDisabled||e.currentMode==="preview"};return i.jsxs("header",{className:j.toolbar,role:"toolbar",children:[i.jsxs("div",{className:j.toolbarButtons,children:[i.jsx(x,{...d,type:"bold",children:i.jsx(v,{children:i.jsx(Q,{})})}),i.jsx(x,{...d,type:"italic",children:i.jsx(v,{children:i.jsx(H,{})})}),i.jsx(x,{...d,type:"strikeThrough",children:i.jsx(v,{children:i.jsx(J,{})})}),i.jsx(x,{...d,type:"quote",children:i.jsx(v,{children:i.jsx(Y,{})})}),i.jsx(x,{...d,type:"code",children:i.jsx(D,{})}),i.jsx(x,{...d,type:"link",children:i.jsx(O,{})}),i.jsx(x,{...d,type:"unorderedList",children:i.jsx(v,{children:i.jsx(R,{})})}),i.jsx(x,{...d,type:"orderedList",children:i.jsx(v,{children:i.jsx(Z,{})})})]}),i.jsx(S,{onChange:e.onModeChange,currentMode:e.currentMode,isDisabled:e.isDisabled})]})};N.__docgenInfo={description:"",methods:[],displayName:"Toolbar",props:{currentMode:{required:!0,tsType:{name:'ModeButtonProps["currentMode"]',raw:'ModeButtonProps["currentMode"]'},description:""},onModeChange:{required:!0,tsType:{name:'ModeButtonProps["onChange"]',raw:'ModeButtonProps["onChange"]'},description:""},onToolPressed:{required:!0,tsType:{name:'ToolBarButtonProps["onPress"]',raw:'ToolBarButtonProps["onPress"]'},description:""}},composes:["Pick"]};const L=e=>{const{selectionStart:d}=e,u=parseInt(getComputedStyle(e).lineHeight||"20",10),r=e.value.slice(0,d).split(`
`).length;e.scrollTop=(r-1)*u},le=(e,d,u)=>{if(e.key!=="Enter")return;const r=d.current;if(!r)return;const b=r.selectionStart,l=r.selectionEnd,p=r.value,y=p.slice(0,b),t=p.slice(l),g=y.lastIndexOf(`
`)+1,n=y.slice(g),m=n.match(/^(\s*)(\d+)\.\s+/),h=n.match(/^(\s*)([-*+])\s+/);if((m||h)&&n.trim().match(/^([-*+]|\d+\.)$/)){e.preventDefault();const o=p.slice(0,g)+`
`+t;u(o),requestAnimationFrame(()=>{r.selectionStart=r.selectionEnd=g+1,L(r)});return}if(m){e.preventDefault();const o=m[1],c=parseInt(m[2]??"",10)+1,s=`
${o}${c}. `,a=y+s+t;u(a),requestAnimationFrame(()=>{r.selectionStart=r.selectionEnd=b+s.length,L(r)})}else if(h){e.preventDefault();const o=h[1],c=h[2],s=`
${o}${c} `,a=y+s+t;u(a),requestAnimationFrame(()=>{r.selectionStart=r.selectionEnd=b+s.length,L(r)})}},ae=A("MarkdownEditor",e=>{const{isDisabled:d,isReadOnly:u,children:r,className:b,rows:l,autoResizeMaxRows:p,headingOffset:y,ref:t,...g}=e,[n,m]=_.useState("editor"),{value:h,handleOnChange:o}=U(e),c=z(t),s=F(j.markdownEditor,b,j[`mode-${n}`]);return i.jsxs(C,{...g,isReadOnly:u||n==="preview",isDisabled:d,className:s,ref:c,value:h,rows:l,autoResizeMaxRows:p,onChange:a=>{o(a)},onKeyDown:a=>le(a,c,o),children:[i.jsx(N,{currentMode:n,isDisabled:d,onModeChange:a=>m(a),onToolPressed:a=>{ie(h,o,c,a)}}),i.jsx(q,{headingOffset:y,className:j.markdown,style:{maxHeight:`calc(var(--line-height--m) * ${p??l} + (var(--form-control--padding-y) * 2))`},children:h}),r]})});ae.__docgenInfo={description:"@flr-generate all",methods:[],displayName:"MarkdownEditor"};export{ae as M};
